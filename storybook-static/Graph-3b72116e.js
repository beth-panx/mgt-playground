import{i as e,p as t,r,t as s,m as n,T as o,a as i,b as a,c as d,d as l,A as c,P as h,h as u}from"./lit-html-c7682711.js";const p=133;function f(e,t){const{element:{content:r},parts:s}=e,n=document.createTreeWalker(r,p,null,!1);let o=v(s),i=s[o],a=-1,d=0;const l=[];let c=null;for(;n.nextNode();){a++;const e=n.currentNode;for(e.previousSibling===c&&(c=null),t.has(e)&&(l.push(e),null===c&&(c=e)),null!==c&&d++;void 0!==i&&i.index===a;)i.index=null!==c?-1:i.index-d,i=s[o=v(s,o)]}l.forEach(e=>e.parentNode.removeChild(e))}const m=e=>{let t=11===e.nodeType?0:1;const r=document.createTreeWalker(e,p,null,!1);for(;r.nextNode();)t++;return t},v=function(t){for(let r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)+1;r<t.length;r++){const s=t[r];if(e(s))return r}return-1};const y=(e,t)=>`${e}--${t}`;let g=!0;void 0===window.ShadyCSS?g=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),g=!1);const w=e=>t=>{const r=y(t.type,e);let i=s.get(r);void 0===i&&(i={stringsArray:new WeakMap,keyString:new Map},s.set(r,i));let a=i.stringsArray.get(t.strings);if(void 0!==a)return a;const d=t.strings.join(n);if(void 0===(a=i.keyString.get(d))){const r=t.getTemplateElement();g&&window.ShadyCSS.prepareTemplateDom(r,e),a=new o(t,r),i.keyString.set(d,a)}return i.stringsArray.set(t.strings,a),a},_=["html","svg"],E=new Set,b=(e,t,r)=>{E.add(e);const n=r?r.element:document.createElement("template"),o=t.querySelectorAll("style"),{length:i}=o;if(0===i)return void window.ShadyCSS.prepareTemplateStyles(n,e);const a=document.createElement("style");for(let e=0;e<i;e++){const t=o[e];t.parentNode.removeChild(t),a.textContent+=t.textContent}(e=>{_.forEach(t=>{const r=s.get(y(t,e));void 0!==r&&r.keyString.forEach(e=>{const{element:{content:t}}=e,r=new Set;Array.from(t.querySelectorAll("style")).forEach(e=>{r.add(e)}),f(e,r)})})})(e);const d=n.content;r?function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const{element:{content:s},parts:n}=e;if(null==r)return void s.appendChild(t);const o=document.createTreeWalker(s,p,null,!1);let i=v(n),a=0,d=-1;for(;o.nextNode();)for(d++,o.currentNode===r&&(a=m(t),r.parentNode.insertBefore(t,r));-1!==i&&n[i].index===d;){if(a>0){for(;-1!==i;)n[i].index+=a,i=v(n,i);return}i=v(n,i)}}(r,a,d.firstChild):d.insertBefore(a,d.firstChild),window.ShadyCSS.prepareTemplateStyles(n,e);const l=d.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==l)t.insertBefore(l.cloneNode(!0),t.firstChild);else if(r){d.insertBefore(a,d.firstChild);const e=new Set;e.add(a),f(r,e)}};window.JSCompiler_renameProperty=((e,t)=>e);const C={toAttribute(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},R=(e,t)=>t!==e&&(t==t||e==e),S={attribute:!0,type:String,converter:C,reflect:!1,hasChanged:R},T=Promise.resolve(!0),P=1,A=4,O=8,D=16,x=32,N="finalized";class I extends HTMLElement{constructor(){super(),this._updateState=0,this._instanceProperties=void 0,this._updatePromise=T,this._hasConnectedResolver=void 0,this._changedProperties=new Map,this._reflectingProperties=void 0,this.initialize()}static get observedAttributes(){this.finalize();const e=[];return this._classProperties.forEach((t,r)=>{const s=this._attributeNameForProperty(r,t);void 0!==s&&(this._attributeToPropertyMap.set(s,r),e.push(s))}),e}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const e=Object.getPrototypeOf(this)._classProperties;void 0!==e&&e.forEach((e,t)=>this._classProperties.set(t,e))}}static createProperty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S;if(this._ensureClassProperties(),this._classProperties.set(e,t),t.noAccessor||this.prototype.hasOwnProperty(e))return;const r="symbol"==typeof e?Symbol():`__${e}`;Object.defineProperty(this.prototype,e,{get(){return this[r]},set(t){const s=this[e];this[r]=t,this._requestUpdate(e,s)},configurable:!0,enumerable:!0})}static finalize(){const e=Object.getPrototypeOf(this);if(e.hasOwnProperty(N)||e.finalize(),this[N]=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const e=this.properties,t=[...Object.getOwnPropertyNames(e),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]];for(const r of t)this.createProperty(r,e[r])}}static _attributeNameForProperty(e,t){const r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}static _valueHasChanged(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:R)(e,t)}static _propertyValueFromAttribute(e,t){const r=t.type,s=t.converter||C,n="function"==typeof s?s:s.fromAttribute;return n?n(e,r):e}static _propertyValueToAttribute(e,t){if(void 0===t.reflect)return;const r=t.type,s=t.converter;return(s&&s.toAttribute||C.toAttribute)(e,r)}initialize(){this._saveInstanceProperties(),this._requestUpdate()}_saveInstanceProperties(){this.constructor._classProperties.forEach((e,t)=>{if(this.hasOwnProperty(t)){const e=this[t];delete this[t],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(t,e)}})}_applyInstanceProperties(){this._instanceProperties.forEach((e,t)=>this[t]=e),this._instanceProperties=void 0}connectedCallback(){this._updateState=this._updateState|x,this._hasConnectedResolver&&(this._hasConnectedResolver(),this._hasConnectedResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(e,t,r){t!==r&&this._attributeToProperty(e,r)}_propertyToAttribute(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S;const s=this.constructor,n=s._attributeNameForProperty(e,r);if(void 0!==n){const e=s._propertyValueToAttribute(t,r);if(void 0===e)return;this._updateState=this._updateState|O,null==e?this.removeAttribute(n):this.setAttribute(n,e),this._updateState=this._updateState&~O}}_attributeToProperty(e,t){if(this._updateState&O)return;const r=this.constructor,s=r._attributeToPropertyMap.get(e);if(void 0!==s){const e=r._classProperties.get(s)||S;this._updateState=this._updateState|D,this[s]=r._propertyValueFromAttribute(t,e),this._updateState=this._updateState&~D}}_requestUpdate(e,t){let r=!0;if(void 0!==e){const s=this.constructor,n=s._classProperties.get(e)||S;s._valueHasChanged(this[e],t,n.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==n.reflect||this._updateState&D||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,n))):r=!1}!this._hasRequestedUpdate&&r&&this._enqueueUpdate()}requestUpdate(e,t){return this._requestUpdate(e,t),this.updateComplete}async _enqueueUpdate(){let e,t;this._updateState=this._updateState|A;const r=this._updatePromise;this._updatePromise=new Promise((r,s)=>{e=r,t=s});try{await r}catch(e){}this._hasConnected||await new Promise(e=>this._hasConnectedResolver=e);try{const e=this.performUpdate();null!=e&&await e}catch(e){t(e)}e(!this._hasRequestedUpdate)}get _hasConnected(){return this._updateState&x}get _hasRequestedUpdate(){return this._updateState&A}get hasUpdated(){return this._updateState&P}performUpdate(){this._instanceProperties&&this._applyInstanceProperties();let e=!1;const t=this._changedProperties;try{(e=this.shouldUpdate(t))&&this.update(t)}catch(t){throw e=!1,t}finally{this._markUpdated()}e&&(this._updateState&P||(this._updateState=this._updateState|P,this.firstUpdated(t)),this.updated(t))}_markUpdated(){this._changedProperties=new Map,this._updateState=this._updateState&~A}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(e){return!0}update(e){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach((e,t)=>this._propertyToAttribute(t,this[t],e)),this._reflectingProperties=void 0)}updated(e){}firstUpdated(e){}}I[N]=!0;const M=e=>t=>"function"==typeof t?((e,t)=>(window.customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:r,elements:s}=t;return{kind:r,elements:s,finisher(t){window.customElements.define(e,t)}}})(e,t),U=(e,t)=>"method"!==t.kind||!t.descriptor||"value"in t.descriptor?{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(r){r.createProperty(t.key,e)}}:Object.assign({},t,{finisher(r){r.createProperty(t.key,e)}}),k=(e,t,r)=>{t.constructor.createProperty(r,e)};function L(e){return(t,r)=>void 0!==r?k(e,t,r):U(e,t)}const $="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,q=Symbol();class F{constructor(e,t){if(t!==q)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){return void 0===this._styleSheet&&($?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const H=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];const n=r.reduce((t,r,s)=>t+(e=>{if(e instanceof F)return e.cssText;if("number"==typeof e)return e;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${e}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(r)+e[s+1],e[0]);return new F(n,q)};(window.litElementVersions||(window.litElementVersions=[])).push("2.2.1");const j=e=>e.flat?e.flat(1/0):function e(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(let s=0,n=t.length;s<n;s++){const n=t[s];Array.isArray(n)?e(n,r):r.push(n)}return r}(e);class B extends I{static finalize(){super.finalize.call(this),this._styles=this.hasOwnProperty(JSCompiler_renameProperty("styles",this))?this._getUniqueStyles():this._styles||[]}static _getUniqueStyles(){const e=this.styles,t=[];if(Array.isArray(e)){j(e).reduceRight((e,t)=>(e.add(t),e),new Set).forEach(e=>t.unshift(e))}else e&&t.push(e);return t}initialize(){super.initialize(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?$?this.renderRoot.adoptedStyleSheets=e.map(e=>e.styleSheet):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(e=>e.cssText),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(e){super.update(e);const t=this.render();t instanceof d&&this.constructor.render(t,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(e=>{const t=document.createElement("style");t.textContent=e.cssText,this.renderRoot.appendChild(t)}))}render(){}}B.finalized=!0,B.render=((e,s,n)=>{if(!n||"object"!=typeof n||!n.scopeName)throw new Error("The `scopeName` option is required.");const o=n.scopeName,d=t.has(s),l=g&&11===s.nodeType&&!!s.host,c=l&&!E.has(o),h=c?document.createDocumentFragment():s;if(r(e,h,Object.assign({templateFactory:w(o)},n)),c){const e=t.get(h);t.delete(h);const r=e.value instanceof i?e.value.template:void 0;b(o,h,r),a(s,s.firstChild),s.appendChild(h),t.set(s,e)}!d&&l&&window.ShadyCSS.styleElement(s.host)});class z{constructor(){this.eventHandlers=[]}fire(e){for(const t of this.eventHandlers)t(e)}add(e){this.eventHandlers.push(e)}remove(e){for(let t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}class X{static get globalProvider(){return this._globalProvider}static set globalProvider(e){e!==this._globalProvider&&(this._globalProvider&&this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),e&&e.onStateChanged(this.handleProviderStateChanged),this._globalProvider=e,this._eventDispatcher.fire(Q.ProviderChanged))}static onProviderUpdated(e){this._eventDispatcher.add(e)}static removeProviderUpdatedListener(e){this._eventDispatcher.remove(e)}static handleProviderStateChanged(){X._eventDispatcher.fire(Q.ProviderStateChanged)}}var Q,W,G;X._eventDispatcher=new z,function(e){e[e.ProviderChanged=0]="ProviderChanged",e[e.ProviderStateChanged=1]="ProviderStateChanged"}(Q||(Q={}));class V{constructor(){this._loginChangedDispatcher=new z,this._state=G.Loading}get state(){return this._state}setState(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}onStateChanged(e){this._loginChangedDispatcher.add(e)}removeStateChangedHandler(e){this._loginChangedDispatcher.remove(e)}getAccessTokenForScopes(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.getAccessToken({scopes:t})}}!function(e){e[e.Popup=0]="Popup",e[e.Redirect=1]="Redirect"}(W||(W={})),function(e){e[e.Loading=0]="Loading",e[e.SignedOut=1]="SignedOut",e[e.SignedIn=2]="SignedIn"}(G||(G={}));const Y=document.createElement("style");Y.type="text/css",Y.appendChild(document.createTextNode("\n@font-face {\n    font-family: 'FabricMDL2Icons';\n    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format(\"woff\"),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format(\"truetype\");;\n}\n")),document.head.appendChild(Y);var J=function(e,t){return(J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function Z(e,t){function r(){this.constructor=e}J(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var K,ee=function(){return(ee=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function te(e,t,r,s){var n,o=arguments.length,i=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(i=(o<3?n(i):o>3?n(t,r,i):n(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i}function re(e,t,r,s){return new(r||(r=Promise))(function(n,o){function i(e){try{d(s.next(e))}catch(e){o(e)}}function a(e){try{d(s.throw(e))}catch(e){o(e)}}function d(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(i,a)}d((s=s.apply(e,t||[])).next())})}!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(K||(K={}));class se{constructor(e){if(this.requests=new Map,void 0!==e){const t=se.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let r=t.next();for(;!r.done;){const e=r.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;r=t.next()}return!0})(e)||(e=>{const t=e.entries();let r=t.next();const s=r.value[1];if(void 0!==s.dependsOn&&s.dependsOn.length>0)return!1;let n=r;for(r=t.next();!r.done;){const e=r.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==n.value[1].id)return!1;n=r,r=t.next()}return!0})(e)||(e=>{const t=e.entries();let r=t.next();const s=r.value[1];let n;if(void 0===s.dependsOn||0===s.dependsOn.length)n=s.id;else{if(1!==s.dependsOn.length)return!1;{const t=s.dependsOn[0];if(t===s.id||!e.has(t))return!1;n=t}}for(r=t.next();!r.done;){const e=r.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&n!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===n||e.dependsOn[0]!==n))return!1;if(e.dependsOn.length>1)return!1}r=t.next()}return!0})(e)}static getRequestData(e){return re(this,void 0,void 0,function*(){const t={url:""},r=new RegExp("^https?://");t.url=r.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const s={};return e.headers.forEach((e,t)=>{s[t]=e}),Object.keys(s).length&&(t.headers=s),e.method!==K.PATCH&&e.method!==K.POST&&e.method!==K.PUT||(t.body=yield se.getRequestBody(e)),t})}static getRequestBody(e){return re(this,void 0,void 0,function*(){let t,r=!1;try{const s=e.clone();t=yield s.json(),r=!0}catch(e){}if(!r)try{if("undefined"!=typeof Blob){const r=yield e.blob(),s=new FileReader;t=yield new Promise(e=>{s.addEventListener("load",()=>{const t=s.result,r=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(r[4])},!1),s.readAsDataURL(r)})}else if("undefined"!=typeof Buffer){t=(yield e.buffer()).toString("base64")}r=!0}catch(e){}return t})}addRequest(e){const t=se.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),r=this.requests.entries();let s=r.next();for(;!s.done;){const t=s.value[1].dependsOn;if(void 0!==t){const r=t.indexOf(e);-1!==r&&t.splice(r,1),0===t.length&&delete s.value[1].dependsOn}s=r.next()}return t}getContent(){return re(this,void 0,void 0,function*(){const e=[],t={requests:e},r=this.requests.entries();let s=r.next();if(s.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!se.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!s.done;){const t=s.value[1],n=yield se.getRequestData(t.request);if(void 0!==n.body&&(void 0===n.headers||void 0===n.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}n.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(n.dependsOn=t.dependsOn),e.push(n),s=r.next()}return t.requests=e,t})}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const r=this.requests.get(e);if(void 0===r.dependsOn&&(r.dependsOn=[]),-1!==r.dependsOn.indexOf(t)){const r=new Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}r.dependsOn.push(t)}else{const r=this.requests.entries();let s,n=r.next();for(;!n.done&&n.value[1].id!==e;)s=n,n=r.next();if(void 0===s){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=s.value[0];if(void 0===n.value[1].dependsOn&&(n.value[1].dependsOn=[]),-1!==n.value[1].dependsOn.indexOf(t)){const r=new Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}n.value[1].dependsOn.push(t)}}}removeDependency(e,t){const r=this.requests.get(e);if(void 0===r||void 0===r.dependsOn||0===r.dependsOn.length)return!1;if(void 0!==t){const e=r.dependsOn.indexOf(t);return-1!==e&&(r.dependsOn.splice(e,1),!0)}return delete r.dependsOn,!0}}se.requestLimit=20;class ne{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const oe=()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},ie=(e,t,r)=>{let s=null;if("undefined"!=typeof Request&&e instanceof Request)s=e.headers.get(r);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)s=t.headers.get(r);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,n=e.length;t<n;t++)if(e[t][0]===r){s=e[t][1];break}}else void 0!==t.headers[r]&&(s=t.headers[r]);return s},ae=(e,t,r,s)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(r,s);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[r]:s});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(r,s);else if(t.headers instanceof Array){let e=0;const n=t.headers.length;for(;e<n;e++){const n=t.headers[e];if(n[0]===r){n[1]=s;break}}e===n&&t.headers.push([r,s])}else Object.assign(t.headers,{[r]:s})},de=(e,t,r,s)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(r,s):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[r]:s}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(r,s):t.headers instanceof Array?t.headers.push([r,s]):void 0===t.headers?t.headers={[r]:s}:void 0===t.headers[r]?t.headers[r]=s:t.headers[r]+=`, ${s}`)},le=(e,t)=>re(void 0,void 0,void 0,function*(){const r=t.headers.get("Content-Type")?yield t.blob():yield Promise.resolve(void 0),{method:s,headers:n,referrer:o,referrerPolicy:i,mode:a,credentials:d,cache:l,redirect:c,integrity:h,keepalive:u,signal:p}=t;return new Request(e,{method:s,headers:n,body:r,referrer:o,referrerPolicy:i,mode:a,credentials:d,cache:l,redirect:c,integrity:h,keepalive:u,signal:p})});class ce{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var he;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(he||(he={}));class ue{constructor(){this.featureUsage=he.NONE}static updateFeatureUsageFlag(e,t){let r;e.middlewareControl instanceof ne?r=e.middlewareControl.getMiddlewareOptions(ue):e.middlewareControl=new ne,void 0===r&&(r=new ue,e.middlewareControl.setMiddlewareOptions(ue,r)),r.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class pe{constructor(e){this.authenticationProvider=e}execute(e){return re(this,void 0,void 0,function*(){try{let t,r,s;e.middlewareControl instanceof ne&&(t=e.middlewareControl.getMiddlewareOptions(ce)),void 0!==t&&(r=t.authenticationProvider,s=t.authenticationProviderOptions),void 0===r&&(r=this.authenticationProvider);const n=`Bearer ${yield r.getAccessToken(s)}`;return de(e.request,e.options,pe.AUTHORIZATION_HEADER,n),ue.updateFeatureUsageFlag(e,he.AUTHENTICATION_HANDLER_ENABLED),yield this.nextMiddleware.execute(e)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}pe.AUTHORIZATION_HEADER="Authorization";class fe{execute(e){return re(this,void 0,void 0,function*(){try{return void(e.response=yield fetch(e.request,e.options))}catch(e){throw e}})}}class me{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me.DEFAULT_DELAY,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:me.DEFAULT_MAX_RETRIES,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:me.DEFAULT_SHOULD_RETRY;if(e>me.MAX_DELAY&&t>me.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${me.MAX_DELAY} and ${me.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>me.MAX_DELAY){const e=new Error(`Delay should not be more than ${me.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>me.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${me.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,me.MAX_DELAY),this.maxRetries=Math.min(t,me.MAX_MAX_RETRIES),this.shouldRetry=r}getMaxDelay(){return me.MAX_DELAY}}me.DEFAULT_DELAY=3,me.DEFAULT_MAX_RETRIES=3,me.MAX_DELAY=180,me.MAX_MAX_RETRIES=10,me.DEFAULT_SHOULD_RETRY=(()=>!0);class ve{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new me;this.options=e}isRetry(e){return-1!==ve.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const r="string"==typeof e?t.method:e.method;if(r===K.PUT||r===K.PATCH||r===K.POST){if("application/octet-stream"===ie(e,t,"Content-Type"))return!1}return!0}getDelay(e,t,r){const s=()=>Number(Math.random().toFixed(3)),n=void 0!==e.headers?e.headers.get(ve.RETRY_AFTER_HEADER):null;let o;return o=null!==n?Number.isNaN(Number(n))?Math.round((new Date(n).getTime()-Date.now())/1e3):Number(n):t>=2?this.getExponentialBackOffTime(t)+r+s():r+s(),Math.min(o,this.options.getMaxDelay()+s())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return re(this,void 0,void 0,function*(){const t=1e3*e;return new Promise(e=>setTimeout(e,t))})}getOptions(e){let t;return e.middlewareControl instanceof ne&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new me,this.options)),t}executeWithRetry(e,t,r){return re(this,void 0,void 0,function*(){try{if(yield this.nextMiddleware.execute(e),t<r.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&r.shouldRetry(r.delay,t,e.request,e.options,e.response)){++t,ae(e.request,e.options,ve.RETRY_ATTEMPT_HEADER,t.toString());const s=this.getDelay(e.response,t,r.delay);return yield this.sleep(s),yield this.executeWithRetry(e,t,r)}return}catch(e){throw e}})}execute(e){return re(this,void 0,void 0,function*(){try{const t=0,r=this.getOptions(e);return ue.updateFeatureUsageFlag(e,he.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,t,r)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}ve.RETRY_STATUS_CODES=[429,503,504],ve.RETRY_ATTEMPT_HEADER="Retry-Attempt",ve.RETRY_AFTER_HEADER="Retry-After";class ye{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye.DEFAULT_MAX_REDIRECTS,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ye.DEFAULT_SHOULD_RETRY;if(e>ye.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${ye.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}ye.DEFAULT_MAX_REDIRECTS=5,ye.MAX_MAX_REDIRECTS=20,ye.DEFAULT_SHOULD_RETRY=(()=>!0);class ge{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ye;this.options=e}isRedirect(e){return-1!==ge.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(ge.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(ge.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const r=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,s=r.exec(e);let n,o;null!==s&&(n=s[0]);const i=r.exec(t);return null!==i&&(o=i[0]),void 0!==n&&void 0!==o&&n!==o}updateRequestUrl(e,t){return re(this,void 0,void 0,function*(){t.request="string"==typeof t.request?e:yield le(e,t.request)})}getOptions(e){let t;return e.middlewareControl instanceof ne&&(t=e.middlewareControl.getMiddlewareOptions(ye)),void 0===t&&(t=Object.assign(new ye,this.options)),t}executeWithRedirect(e,t,r){return re(this,void 0,void 0,function*(){try{yield this.nextMiddleware.execute(e);const s=e.response;if(!(t<r.maxRedirects&&this.isRedirect(s)&&this.hasLocationHeader(s)&&r.shouldRedirect(s)))return;if(++t,s.status===ge.STATUS_CODE_SEE_OTHER)e.options.method=K.GET,delete e.options.body;else{const t=this.getLocationHeader(s);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(s.url,t)&&ae(e.request,e.options,ge.AUTHORIZATION_HEADER,void 0),yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,r)}catch(e){throw e}})}execute(e){return re(this,void 0,void 0,function*(){try{const t=0,r=this.getOptions(e);return e.options.redirect=ge.MANUAL_REDIRECT,ue.updateFeatureUsageFlag(e,he.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,t,r)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}ge.REDIRECT_STATUS_CODES=[301,302,303,307,308],ge.STATUS_CODE_SEE_OTHER=303,ge.LOCATION_HEADER="Location",ge.AUTHORIZATION_HEADER="Authorization",ge.MANUAL_REDIRECT="manual";const we="2.0.0";class _e{execute(e){return re(this,void 0,void 0,function*(){try{let t=ie(e.request,e.options,_e.CLIENT_REQUEST_ID_HEADER);null===t&&(t=oe(),ae(e.request,e.options,_e.CLIENT_REQUEST_ID_HEADER,t));let r,s=`${_e.PRODUCT_NAME}/${we}`;if(e.middlewareControl instanceof ne&&(r=e.middlewareControl.getMiddlewareOptions(ue)),void 0!==r){const e=r.getFeatureUsage();s+=` (${_e.FEATURE_USAGE_STRING}=${e})`}return de(e.request,e.options,_e.SDK_VERSION_HEADER,s),yield this.nextMiddleware.execute(e)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}_e.CLIENT_REQUEST_ID_HEADER="client-request-id",_e.SDK_VERSION_HEADER="SdkVersion",_e.PRODUCT_NAME="graph-js",_e.FEATURE_USAGE_STRING="featureUsage";const Ee="v1.0",be="https://graph.microsoft.com/";class Ce{constructor(e){this.provider=e}getAccessToken(){return re(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((r,s)=>{s?e(s):t(r)})})})}}class Re{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this.statusCode=e,this.code=null,this.message=null,this.requestId=null,this.date=new Date,this.body=null}}class Se{static constructError(e,t){const r=new Re(t);return void 0!==e.name&&(r.code=e.name),r.body=e.toString(),r.message=e.message,r.date=new Date,r}static constructErrorFromResponse(e,t){e=e.error;const r=new Re(t);r.code=e.code,r.message=e.message,void 0!==e.innerError&&(r.requestId=e.innerError["request-id"],r.date=new Date(e.innerError.date));try{r.body=JSON.stringify(e)}catch(e){}return r}static getError(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0;return re(this,void 0,void 0,function*(){let s;if(s=e&&e.error?Se.constructErrorFromResponse(e,t):"undefined"!=typeof Error&&e instanceof Error?Se.constructError(e,t):new Re(t),"function"!=typeof r)return s;r(s,null)})}}const Te=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],Pe=e=>{const t=e=>e.replace(/\/+$/,""),r=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce((e,s)=>[t(e),r(s)].join("/"))},Ae=e=>{const t=e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e};var Oe,De,xe,Ne;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(Oe||(Oe={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(De||(De={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(xe||(xe={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(Ne||(Ne={}));class Ie{static parseDocumentResponse(e,t){try{return"undefined"!=typeof DOMParser?new Promise((r,s)=>{e.text().then(e=>{try{const n=(new DOMParser).parseFromString(e,t);r(n)}catch(e){s(e)}})}):Promise.resolve(e.body)}catch(e){throw e}}static convertResponse(e,t){return re(this,void 0,void 0,function*(){if(204===e.status)return Promise.resolve();let r;try{switch(t){case Oe.ARRAYBUFFER:r=yield e.arrayBuffer();break;case Oe.BLOB:r=yield e.blob();break;case Oe.DOCUMENT:r=yield Ie.parseDocumentResponse(e,De.TEXT_XML);break;case Oe.JSON:r=yield e.json();break;case Oe.STREAM:r=yield Promise.resolve(e.body);break;case Oe.TEXT:r=yield e.text();break;default:const s=e.headers.get("Content-type");if(null!==s){const t=s.split(";")[0];r=new RegExp(Ne.DOCUMENT).test(t)?yield Ie.parseDocumentResponse(e,t):new RegExp(Ne.IMAGE).test(t)?e.blob():t===xe.TEXT_PLAIN?yield e.text():t===xe.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else r=Promise.resolve(e.body)}}catch(e){throw e}return r})}static getResponse(e,t,r){return re(this,void 0,void 0,function*(){try{if(t===Oe.RAW)return Promise.resolve(e);{const s=yield Ie.convertResponse(e,t);if(!e.ok)throw s;if("function"!=typeof r)return s;r(null,s)}}catch(e){throw e}})}}class Me{constructor(e,t,r){this.parsePath=(e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const r=e.indexOf("/");-1!==r&&(this.urlComponents.version=e.substring(0,r),e=e.substring(r+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const r=e.substring(t+1,e.length).split("&");for(const e of r){const t=e.split("="),r=t[0],s=t[1];-1!==Te.indexOf(r)?this.urlComponents.oDataQueryParams[r]=s:this.urlComponents.otherURLQueryParams[r]=s}}}),this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{}},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}addCsvQueryParameter(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let s=[];r.length>1&&"string"==typeof t?s=Array.prototype.slice.call(r):"string"==typeof t?s.push(t):s=s.concat(t),this.urlComponents.oDataQueryParams[e]+=s.join(",")}buildFullUrl(){const e=Pe([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const r in e.oDataQueryParams)e.oDataQueryParams.hasOwnProperty(r)&&t.push(r+"="+e.oDataQueryParams[r]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const r in e.otherURLQueryParams)e.otherURLQueryParams.hasOwnProperty(r)&&t.push(r+"="+e.otherURLQueryParams[r]);return t.length>0?"?"+t.join("&"):""}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,r){return re(this,void 0,void 0,function*(){let s;const n=new ne(this._middlewareOptions);this.updateRequestOptions(t);try{return s=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:n})).response,yield Ie.getResponse(s,this._responseType,r)}catch(e){let t;throw void 0!==s&&(t=s.status),yield Se.getError(e,t,r)}})}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)e.hasOwnProperty(t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)e.hasOwnProperty(t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){const t=this.urlComponents.otherURLQueryParams;if("string"==typeof e){const r=e.split("="),s=r[0],n=r[1];t[s]=n}else for(const r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return this}get(e){return re(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:K.GET};try{return yield this.send(t,r,e)}catch(e){throw e}})}post(e,t){return re(this,void 0,void 0,function*(){const r=this.buildFullUrl(),s={method:K.POST,body:Ae(e),headers:"undefined"!=typeof FormData&&e instanceof FormData?{}:{"Content-Type":"application/json"}};try{return yield this.send(r,s,t)}catch(e){throw e}})}create(e,t){return re(this,void 0,void 0,function*(){try{return yield this.post(e,t)}catch(e){throw e}})}put(e,t){return re(this,void 0,void 0,function*(){const r=this.buildFullUrl(),s={method:K.PUT,body:Ae(e),headers:{"Content-Type":"application/json"}};try{return yield this.send(r,s,t)}catch(e){throw e}})}patch(e,t){return re(this,void 0,void 0,function*(){const r=this.buildFullUrl(),s={method:K.PATCH,body:Ae(e),headers:{"Content-Type":"application/json"}};try{return yield this.send(r,s,t)}catch(e){throw e}})}update(e,t){return re(this,void 0,void 0,function*(){try{return yield this.patch(e,t)}catch(e){throw e}})}delete(e){return re(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:K.DELETE};try{return yield this.send(t,r,e)}catch(e){throw e}})}del(e){return re(this,void 0,void 0,function*(){try{return yield this.delete(e)}catch(e){throw e}})}getStream(e){return re(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:K.GET};this.responseType(Oe.STREAM);try{return yield this.send(t,r,e)}catch(e){throw e}})}putStream(e,t){return re(this,void 0,void 0,function*(){const r=this.buildFullUrl(),s={method:K.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};try{return yield this.send(r,s,t)}catch(e){throw e}})}}class Ue{constructor(e){this.middleware=e}sendRequest(e){return re(this,void 0,void 0,function*(){try{if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}catch(e){throw e}})}}const ke=()=>new Function("try {return this === global;}catch(e){return false;}")();class Le{static createWithAuthenticationProvider(e){const t=new pe(e),r=new ve(new me),s=new _e,n=new fe;if(t.setNext(r),ke()){const e=new ge(new ye);r.setNext(e),e.setNext(s)}else r.setNext(s);return s.setNext(n),Le.createWithMiddleware(t)}static createWithMiddleware(e){return new Ue(e)}}const $e=()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}return!0};class qe{constructor(e){this.config={baseUrl:be,debugLogging:!1,defaultVersion:Ee};try{$e()}catch(e){throw e}for(const t in e)e.hasOwnProperty(t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=Le.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new Ue(e.middleware)}this.httpClient=t}static init(e){const t={};for(const r in e)e.hasOwnProperty(r)&&(t[r]="authProvider"===r?new Ce(e[r]):e[r]);return qe.initWithMiddleware(t)}static initWithMiddleware(e){try{return new qe(e)}catch(e){throw e}}api(e){return new Me(this.httpClient,this.config,e)}}function Fe(e){const t=e,r=e,s=e;return r.mail?r.mail:t.scoredEmailAddresses&&t.scoredEmailAddresses.length?t.scoredEmailAddresses[0].address:s.emailAddresses&&s.emailAddresses.length?s.emailAddresses[0].address:null}function He(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return[new ce(void 0,{scopes:t})]}function je(e){const t=e.getMonth(),r=e.getDate();return`${Be(t)} ${r}`}function Be(e){switch(e){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}}function ze(e){switch(e){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";default:return"Day"}}function Xe(e,t){let r;return function(){clearTimeout(r),r=setTimeout(()=>e.apply(this,arguments),t)}}function Qe(e,t){return function e(t,r,s){const n=Object.prototype.toString.call(t);const o=Object.prototype.toString.call(r);if(n===o&&"[object Object]"===n&&!s.has(t)){s.add(t);for(const n in t)if(!e(t[n],r[n],s))return!1;for(const e in r)if(!t.hasOwnProperty(e))return!1;return!0}if(n===o&&"[object Array]"===n&&!s.has(t)){if(s.add(t),t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n],s))return!1;return!0}return t===r}(e,t,new Set)}const We=new WeakMap,Ge=l(e=>t=>{if(!(t instanceof c)||t instanceof h||"class"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:r}=t,{element:s}=r;We.has(t)||(s.className=r.strings.join(" "));const{classList:n}=s,o=We.get(t);for(const t in o)t in e||n.remove(t);for(const t in e){const r=e[t];if(!o||r!==o[t]){n[r?"add":"remove"](t)}}We.set(t,e)});class Ve extends B{constructor(){super(),this.isShadowRootDisabled()&&(this._needsShimAdoptedStyleSheets=!0)}static get useShadowRoot(){return this._useShadowRoot}static set useShadowRoot(e){this._useShadowRoot=e}isShadowRootDisabled(){return!Ve._useShadowRoot||!this.constructor._useShadowRoot}fireCustomEvent(e,t){const r=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:t});return this.dispatchEvent(r)}createRenderRoot(){return this.isShadowRootDisabled()?this:super.createRenderRoot()}}Ve._useShadowRoot=!0;class Ye{static renderTemplate(e,t,r){if(e.$parentTemplateContext&&(t=Object.assign(Object.assign({},t),{$parent:e.$parentTemplateContext})),e.content&&e.content.childNodes.length){const s=e.content.cloneNode(!0);return this.renderNode(s,t,r)}if(e.childNodes.length){const s=document.createElement("div");for(let t=0;t<e.childNodes.length;t++)s.appendChild(e.childNodes[t].cloneNode(!0));return this.renderNode(s,t,r)}}static getValueFromObject(e,t){if("this"===(t=t.trim()))return e;const r=t.split(".");let s=e;for(let e=0;e<r.length;e++){if(!(s=s[r[e]]))return null}return s}static replaceExpression(e,t,r){return e.replace(this._converterExpression,e=>r?this.evalInContext(e.substring(3,e.length-3).trim(),Object.assign(Object.assign({},r),t)):"").replace(this._expression,e=>{const r=e.substring(2,e.length-2),s=this.getValueFromObject(t,r);return s?"object"==typeof s?JSON.stringify(s):s.toString():""})}static renderNode(e,t,r){if("#text"===e.nodeName)return e.textContent=this.replaceExpression(e.textContent,t,r),e;if("TEMPLATE"===e.nodeName)return e.$parentTemplateContext=t,e;let s=e;if(s.attributes)for(let e=0;e<s.attributes.length;e++){const n=s.attributes[e];s.setAttribute(n.name,this.replaceExpression(n.value,t,r))}const n=[],o=[];let i=!1;for(let s=0;s<e.childNodes.length;s++){const a=e.childNodes[s],d=a;let l=!1;if(d.dataset){let e=!1;if(d.dataset.if){const r=d.dataset.if;this.evalBoolInContext(r,t)?(d.removeAttribute("data-if"),i=!0,l=!0):(o.push(d),e=!0)}else void 0!==d.dataset.else&&(i?(o.push(d),e=!0):d.removeAttribute("data-else"));d.dataset.for&&!e?n.push(d):e||this.renderNode(a,t,r)}else this.renderNode(a,t,r);l||"#text"===a.nodeName||(i=!1)}for(const e of o)s.removeChild(e);for(let e=0;e<n.length;e++){const o=n[e],i=o.dataset.for.split(" ");if(i.length>1){const e=i[0],n=i[i.length-1],a=this.getValueFromObject(t,n);if(Array.isArray(a)){o.removeAttribute("data-for");for(let n=0;n<a.length;n++){const i=Object.assign({$index:n},t);i[e]=a[n];const d=o.cloneNode(!0);this.renderNode(d,i,r),s.insertBefore(d,o)}s.removeChild(o)}}}return e}static evalBoolInContext(e,t){return new Function("with(this) { return !!("+e+")}").call(t)}static evalInContext(e,t){const r=new Function("with(this) { return "+e+";}");let s;try{s=r.call(t)}catch(e){}return s}}Ye._expression=/{{\s*([$\w]+)(\.[$\w]+)*\s*}}/g,Ye._converterExpression=/{{{\s*[$\w\.()]+\s*}}}/g;class Je extends Ve{constructor(){super(),this.templateConverters={},this.templates={},this._renderedSlots=!1,this._renderedTemplates={},this._slotNamesAddedDuringRender=[],this.templateConverters.lower=(e=>e.toLowerCase()),this.templateConverters.upper=(e=>e.toUpperCase())}update(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],super.update(e)}updated(e){super.updated(e),this.removeUnusedSlottedElements()}renderTemplate(e,t,r){if(!this.templates[e])return null;r=r||e,this._slotNamesAddedDuringRender.push(r),this._renderedSlots=!0;const s=u` <slot name="${r}"></slot> `;if(this._renderedTemplates.hasOwnProperty(r)){const{context:e,slot:n}=this._renderedTemplates[r];if(Qe(e,t))return s;this.removeChild(n)}const n=Ye.renderTemplate(this.templates[e],t,this.templateConverters),o=document.createElement("div");return o.slot=r,o.dataset.generated="template",n&&o.appendChild(n),this.appendChild(o),this._renderedTemplates[r]={context:t,slot:o},this.fireCustomEvent("templateRendered",{templateType:e,context:t,element:o}),s}getTemplates(){const e={};for(let t=0;t<this.children.length;t++){const r=this.children[t];if("TEMPLATE"===r.nodeName){const t=r;t.dataset.type?e[t.dataset.type]=t:e.default=t}}return e}removeUnusedSlottedElements(){if(this._renderedSlots){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.dataset&&t.dataset.generated&&!this._slotNamesAddedDuringRender.includes(t.slot)&&(this.removeChild(t),delete this._renderedTemplates[t.slot],e--)}this._renderedSlots=!1}}}var Ze;!function(e){e[e.none=0]="none",e[e.hover=1]="hover",e[e.click=2]="click"}(Ze||(Ze={}));const Ke=[H`:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\E70E"}.ms-Icon--Contact::before{content:"\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\EB6D"}:host{display:inherit}:host .root{display:inline-block;color:var(--color,#201f1e);position:relative;vertical-align:top}:host svg,mgt-person svg{width:var(--avatar-size-s,24px);height:var(--avatar-size-s,24px)}:host img,mgt-person img{border:var(--avatar-border);border-radius:50%}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;font-family:var(--default-font-family, "Segoe UI")}:host .Details,mgt-person .Details{flex:1 1 auto;display:flex;flex-direction:column;margin-left:12px}:host .Details.small,mgt-person .Details.small{margin-left:6px}:host .user-avatar,mgt-person .user-avatar{width:var(--avatar-size,48px);height:var(--avatar-size,48px);display:flex;justify-content:center;align-items:center}:host .user-avatar.initials,mgt-person .user-avatar.initials{color:var(--initials-color,#fff);background-color:var(--initials-background-color,#b4009e);border-radius:50%;font-weight:400;font-size:60%}:host .user-avatar.small,mgt-person .user-avatar.small{width:var(--avatar-size-s,24px);height:var(--avatar-size-s,24px)}:host .user-avatar.row-span-2,mgt-person .user-avatar.row-span-2{width:var(--avatar-size,48px);height:var(--avatar-size,48px)}:host .user-avatar img,mgt-person .user-avatar img{height:100%}:host .avatar-icon,mgt-person .avatar-icon{flex:1 1 auto;line-height:1;margin:0;font-size:var(--avatar-size,48px)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,24px)}:host .avatar-icon.row-span-2,mgt-person .avatar-icon.row-span-2{grid-row:1/3;-ms-grid-row:1;-ms-grid-row-span:2}:host .avatar-icon.row-span-3,mgt-person .avatar-icon.row-span-3{grid-row:1/4;-ms-grid-row:1;-ms-grid-row-span:3}:host .user-name,mgt-person .user-name{font-size:var(--font-size,14px);font-weight:var(--font-weight,600);white-space:nowrap;grid-column:2;-ms-grid-column:2}:host .user-email,mgt-person .user-email{color:var(--email-color,#323130);font-size:var(--email-font-size,12px);white-space:nowrap;grid-column:2;-ms-grid-column:2;grid-row:2;-ms-grid-row:2}.root .flyout{display:none;position:absolute;z-index:1;opacity:0;transition-property:opacity;transition-duration:.1s;padding:8px}.root .flyout.visible{display:inline-block;opacity:1}.root .flyout.visible.openLeft{right:0}`];var et=function(e,t,r,s){var n,o=arguments.length,i=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,s);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(i=(o<3?n(i):o>3?n(t,r,i):n(t,r))||i);return o>3&&i&&Object.defineProperty(t,r,i),i},tt=function(e,t,r,s){return new(r||(r=Promise))(function(n,o){function i(e){try{d(s.next(e))}catch(e){o(e)}}function a(e){try{d(s.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,a)}d((s=s.apply(e,t||[])).next())})};let rt=class extends Je{constructor(){super(...arguments),this.personCardInteraction=Ze.none,this._isPersonCardVisible=!1,this._personCardShouldRender=!1,this._openLeft=!1,this._openUp=!1}static get styles(){return Ke}attributeChangedCallback(e,t,r){super.attributeChangedCallback(e,t,r),"person-query"!==e&&"user-id"!==e||t===r||(this.personDetails=null,this.loadData())}firstUpdated(){X.onProviderUpdated(()=>this.loadData()),this.loadData()}render(){const e=this.renderTemplate("default",{person:this.personDetails,personImage:this.getImage()})||u` <div class="person-root"> ${this.renderImage()} ${this.renderDetails()} </div> `;return u` <div class="root" @mouseenter="${this._handleMouseEnter}" @mouseleave="${this._handleMouseLeave}" @click="${this._handleMouseClick}"> ${e} ${this.renderPersonCard()} </div> `}updated(e){super.updated(e);const t=this.renderRoot.querySelector(".initials-text");if(t&&t.parentNode&&t.parentNode.getBoundingClientRect){const e=t.parentNode.getBoundingClientRect().height;t.style.fontSize=`${.5*e}px`}}loadData(){return tt(this,void 0,void 0,function*(){const e=X.globalProvider;if(e&&e.state!==G.Loading)if(e.state!==G.SignedOut){if(this.personDetails)this.personImage&&"@"===this.personImage&&!this.personDetails.personImage&&this.loadImage();else if(this.userId||this.personQuery&&"me"===this.personQuery){const t=e.graph.createBatch();this.userId?(t.get("user",`/users/${this.userId}`,["user.readbasic.all"]),t.get("photo",`users/${this.userId}/photo/$value`,["user.readbasic.all"])):(t.get("user","me",["user.read"]),t.get("photo","me/photo/$value",["user.read"]));const r=yield t.execute();this.personDetails=r.user,this.personDetails.personImage=r.photo}else if(!this.personDetails&&this.personQuery){const t=yield e.graph.findPerson(this.personQuery);if(t&&t.length>0){const e=t[0];this.personDetails=e,this.loadImage()}}}else this.personDetails=null})}loadImage(){return tt(this,void 0,void 0,function*(){const e=X.globalProvider,t=this.personDetails;let r;if(t.userPrincipalName){const s=t.userPrincipalName;r=yield e.graph.getUserPhoto(s)}else{const s=Fe(t);if(s){const t=yield e.graph.findUserByEmail(s);if(t&&t.length)if(t[0].personType&&"OrganizationUser"===t[0].personType.subclass)r=yield e.graph.getUserPhoto(t[0].scoredEmailAddresses[0].address);else{const s=t[0].id;r=yield e.graph.getContactPhoto(s)}}}r&&(this.personDetails.personImage=r),this.requestUpdate()})}_handleMouseClick(){this.personCardInteraction!==Ze.click||this._isPersonCardVisible?this._hidePersonCard():this._showPersonCard()}_handleMouseEnter(e){this.personCardInteraction===Ze.hover&&(clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseEnterTimeout=setTimeout(this._showPersonCard.bind(this),500))}_handleMouseLeave(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=setTimeout(this._hidePersonCard.bind(this),500)}_showPersonCard(){this._personCardShouldRender||(this._personCardShouldRender=!0),this._isPersonCardVisible=!0}_hidePersonCard(){this._isPersonCardVisible=!1;const e=this.querySelector("mgt-person-card");e&&(e.isExpanded=!1)}getImage(){return this.personImage&&"@"!==this.personImage?this.personImage:this.personDetails&&this.personDetails.personImage?this.personDetails.personImage:null}renderPersonCard(){if(this.personCardInteraction===Ze.none||!this._personCardShouldRender)return;const e=this.renderRoot.querySelector(".root").getBoundingClientRect(),t=e.left,r=(window.innerWidth||document.documentElement.clientWidth)-e.right;this._openLeft=r<t;const s=(window.innerHeight||document.documentElement.clientHeight)-e.bottom;this._openUp=s<175;let n=null;if(this._openUp){n=`bottom: ${(this.getBoundingClientRect().bottom-this.getBoundingClientRect().top)/2+8}px`}const o={flyout:!0,openLeft:this._openLeft,openUp:this._openUp,visible:this._isPersonCardVisible};if(this._isPersonCardVisible){const e=this.getImage();return u` <div style="${n}" class="${Ge(o)}"> ${this.renderTemplate("person-card",{person:this.personDetails,personImage:e})||u` <mgt-person-card .personDetails="${this.personDetails}" .personImage="${e}"> </mgt-person-card> `} </div> `}}renderDetails(){if(this.showEmail||this.showName){const e=this.showEmail&&this.showName;return u` <span class="${Ge({Details:!0,small:!e})}"> ${this.renderNameAndEmail()} </span> `}return null}renderImage(){if(this.personDetails){const e=this.personCardInteraction===Ze.none?this.personDetails.displayName:"",t=this.getImage(),r=this.showEmail&&this.showName,s={initials:!t,"row-span-2":r,small:!r,"user-avatar":!0};let n;if(t)n=u` <img alt="${e}" src="${t}"> `;else{const e=this.getInitials();n=u` <span class="initials-text" aria-label="${e}"> ${e} </span> `}return u` <div class="${Ge(s)}" title="${e}" aria-label="${e}"> ${n} </div> `}return this.renderEmptyImage()}renderEmptyImage(){const e=this.showEmail&&this.showName;return u` <i class="${Ge({"avatar-icon":!0,"ms-Icon":!0,"ms-Icon--Contact":!0,"row-span-2":e,small:!e})}"></i> `}renderNameAndEmail(){if(!this.personDetails||!this.showEmail&&!this.showName)return;const e=this.showName?u` <div class="user-name" aria-label="${this.personDetails.displayName}">${this.personDetails.displayName}</div> `:null;let t;if(this.showEmail){const e=Fe(this.personDetails);t=u` <div class="user-email" aria-label="${e}">${e}</div> `}return u` ${e} ${t} `}getInitials(){if(!this.personDetails)return"";let e="";if(this.personDetails.givenName&&(e+=this.personDetails.givenName[0].toUpperCase()),this.personDetails.surname&&(e+=this.personDetails.surname[0].toUpperCase()),!e&&this.personDetails.displayName){const t=this.personDetails.displayName.split(" ");for(let r=0;r<2&&r<t.length;r++)t[r][0].match(/[a-z]/i)&&(e+=t[r][0].toUpperCase())}return e}};et([L({attribute:"person-query"})],rt.prototype,"personQuery",void 0),et([L({attribute:"user-id"})],rt.prototype,"userId",void 0),et([L({attribute:"show-name",type:Boolean})],rt.prototype,"showName",void 0),et([L({attribute:"show-email",type:Boolean})],rt.prototype,"showEmail",void 0),et([L({attribute:"person-details",type:Object})],rt.prototype,"personDetails",void 0),et([L({attribute:"person-image",type:String})],rt.prototype,"personImage",void 0),et([L({attribute:"person-card",converter:(e,t)=>(e=e.toLowerCase(),void 0===Ze[e]?Ze.none:Ze[e])})],rt.prototype,"personCardInteraction",void 0),et([L({attribute:!1})],rt.prototype,"_isPersonCardVisible",void 0),et([L({attribute:!1})],rt.prototype,"_personCardShouldRender",void 0),rt=et([M("mgt-person")],rt);class st{constructor(e,t){"/"!==e.charAt(0)&&(e="/"+e),this.resource=e,this.method=t}}var nt=function(e,t,r,s){return new(r||(r=Promise))(function(n,o){function i(e){try{d(s.next(e))}catch(e){o(e)}}function a(e){try{d(s.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,a)}d((s=s.apply(e,t||[])).next())})};class ot{constructor(e){this.requests=new Map,this.scopes=[],this.client=e}get(e,t,r){const s=new st(t,"GET");this.requests.set(e,s),r&&(this.scopes=this.scopes.concat(r))}execute(){return nt(this,void 0,void 0,function*(){const e={};if(!this.requests.size)return e;const t=new se;for(const e of this.requests)t.addRequest({id:e[0],request:new Request(ot.baseUrl+e[1].resource,{method:e[1].method})});let r=this.client.api("$batch").version("beta");this.scopes.length&&(r=r.middlewareOptions(He(...this.scopes)));const s=yield r.post(yield t.getContent());for(const t of s.responses)200!==t.status?t[t.id]=null:t.headers["Content-Type"].includes("image/jpeg")?e[t.id]="data:image/jpeg;base64,"+t.body:e[t.id]=t.body;return e})}}ot.baseUrl="https://graph.microsoft.com";const it="1.1.0-preview.2";var at=function(e,t,r,s){return new(r||(r=Promise))(function(n,o){function i(e){try{d(s.next(e))}catch(e){o(e)}}function a(e){try{d(s.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,a)}d((s=s.apply(e,t||[])).next())})};class dt{execute(e){return at(this,void 0,void 0,function*(){try{let t=`mgt/${it}`;return t+=", "+ie(e.request,e.options,"SdkVersion"),ae(e.request,e.options,"SdkVersion",t),yield this.nextMiddleware.execute(e)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}var lt=function(e,t,r,s){return new(r||(r=Promise))(function(n,o){function i(e){try{d(s.next(e))}catch(e){o(e)}}function a(e){try{d(s.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,a)}d((s=s.apply(e,t||[])).next())})};class ct{constructor(e){if(e){const t=new pe(e),r=new ve(new me),s=new _e,n=new dt,o=new fe;t.setNext(r),r.setNext(s),s.setNext(n),n.setNext(o),this.client=qe.initWithMiddleware({middleware:t})}}createBatch(){return new ot(this.client)}getMe(){return lt(this,void 0,void 0,function*(){return this.client.api("me").middlewareOptions(He("user.read")).get()})}getUser(e){return lt(this,void 0,void 0,function*(){return this.client.api(`/users/${e}`).middlewareOptions(He("user.readbasic.all")).get()})}findPerson(e){return lt(this,void 0,void 0,function*(){const t=yield this.client.api("/me/people").search('"'+e+'"').middlewareOptions(He("people.read")).get();return t?t.value:null})}findContactByEmail(e){return lt(this,void 0,void 0,function*(){const t=yield this.client.api("/me/contacts").filter(`emailAddresses/any(a:a/address eq '${e}')`).middlewareOptions(He("contacts.read")).get();return t?t.value:null})}findUserByEmail(e){return lt(this,void 0,void 0,function*(){return Promise.all([this.findPerson(e),this.findContactByEmail(e)]).then(e=>{let[t,r]=e;return(t||[]).concat(r||[])})})}myPhoto(){return lt(this,void 0,void 0,function*(){return this.getPhotoForResource("me",["user.read"])})}getUserPhoto(e){return lt(this,void 0,void 0,function*(){return this.getPhotoForResource(`users/${e}`,["user.readbasic.all"])})}getContactPhoto(e){return lt(this,void 0,void 0,function*(){return this.getPhotoForResource(`me/contacts/${e}`,["contacts.read"])})}getEvents(e,t,r){return lt(this,void 0,void 0,function*(){const s=`startdatetime=${e.toISOString()}`,n=`enddatetime=${t.toISOString()}`;let o;o=r?`groups/${r}/calendar`:"me",o+=`/calendarview?${s}&${n}`;const i=yield this.client.api(o).middlewareOptions(He("calendars.read")).orderby("start/dateTime").get();return i?i.value:null})}getPeople(){return lt(this,void 0,void 0,function*(){const e=yield this.client.api("/me/people").middlewareOptions(He("people.read")).filter("personType/class eq 'Person'").get();return e?e.value:null})}getPeopleFromGroup(e){return lt(this,void 0,void 0,function*(){const t=`/groups/${e}/members`,r=yield this.client.api(t).middlewareOptions(He("people.read")).get();return r?r.value:null})}getPlansForGroup(e){return lt(this,void 0,void 0,function*(){const t=`/groups/${e}/planner/plans`,r=yield this.client.api(t).header("Cache-Control","no-store").middlewareOptions(He("Group.Read.All")).get();return r?r.value:null})}planner_getAllMyPlans(){return lt(this,void 0,void 0,function*(){const e=yield this.client.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions(He("Group.Read.All")).get();return e&&e.value})}planner_getSinglePlan(e){return lt(this,void 0,void 0,function*(){return yield this.client.api(`/planner/plans/${e}`).header("Cache-Control","no-store").middlewareOptions(He("Group.Read.All")).get()})}planner_getBucketsForPlan(e){return lt(this,void 0,void 0,function*(){const t=yield this.client.api(`/planner/plans/${e}/buckets`).header("Cache-Control","no-store").middlewareOptions(He("Group.Read.All")).get();return t&&t.value})}planner_getTasksForBucket(e){return lt(this,void 0,void 0,function*(){const t=yield this.client.api(`/planner/buckets/${e}/tasks`).header("Cache-Control","no-store").middlewareOptions(He("Group.Read.All")).get();return t&&t.value})}planner_setTaskDetails(e,t,r){return lt(this,void 0,void 0,function*(){return yield this.client.api(`/planner/tasks/${e}`).header("Cache-Control","no-store").middlewareOptions(He("Group.ReadWrite.All")).header("If-Match",r).patch(JSON.stringify(t))})}planner_setTaskComplete(e,t){return lt(this,void 0,void 0,function*(){return this.planner_setTaskDetails(e,{percentComplete:100},t)})}planner_setTaskIncomplete(e,t){return lt(this,void 0,void 0,function*(){return this.planner_setTaskDetails(e,{percentComplete:0},t)})}planner_assignPeopleToTask(e,t,r){return lt(this,void 0,void 0,function*(){return this.planner_setTaskDetails(e,{assignments:t},r)})}planner_addTask(e){return lt(this,void 0,void 0,function*(){return this.client.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions(He("Group.ReadWrite.All")).post(e)})}planner_removeTask(e,t){return lt(this,void 0,void 0,function*(){return this.client.api(`/planner/tasks/${e}`).header("Cache-Control","no-store").header("If-Match",t).middlewareOptions(He("Group.ReadWrite.All")).delete()})}todo_getAllMyGroups(){return lt(this,void 0,void 0,function*(){const e=yield this.client.api("/me/outlook/taskGroups").header("Cache-Control","no-store").version("beta").middlewareOptions(He("Tasks.Read")).get();return e&&e.value})}todo_getSingleGroup(e){return lt(this,void 0,void 0,function*(){return yield this.client.api(`/me/outlook/taskGroups/${e}`).header("Cache-Control","no-store").version("beta").middlewareOptions(He("Tasks.Read")).get()})}todo_getFoldersForGroup(e){return lt(this,void 0,void 0,function*(){const t=yield this.client.api(`/me/outlook/taskGroups/${e}/taskFolders`).header("Cache-Control","no-store").version("beta").middlewareOptions(He("Tasks.Read")).get();return t&&t.value})}todo_getAllTasksForFolder(e){return lt(this,void 0,void 0,function*(){const t=yield this.client.api(`/me/outlook/taskFolders/${e}/tasks`).header("Cache-Control","no-store").version("beta").middlewareOptions(He("Tasks.Read")).get();return t&&t.value})}todo_setTaskDetails(e,t,r){return lt(this,void 0,void 0,function*(){return yield this.client.api(`/me/outlook/tasks/${e}`).header("Cache-Control","no-store").version("beta").header("If-Match",r).middlewareOptions(He("Tasks.ReadWrite")).patch(t)})}todo_setTaskComplete(e,t){return lt(this,void 0,void 0,function*(){return yield this.todo_setTaskDetails(e,{isReminderOn:!1,status:"completed"},t)})}todo_setTaskIncomplete(e,t){return lt(this,void 0,void 0,function*(){return yield this.todo_setTaskDetails(e,{isReminderOn:!0,status:"notStarted"},t)})}todo_addTask(e){return lt(this,void 0,void 0,function*(){const{parentFolderId:t=null}=e;return t?yield this.client.api(`/me/outlook/taskFolders/${t}/tasks`).header("Cache-Control","no-store").version("beta").middlewareOptions(He("Tasks.ReadWrite")).post(e):yield this.client.api("/me/outlook/tasks").header("Cache-Control","no-store").version("beta").middlewareOptions(He("Tasks.ReadWrite")).post(e)})}todo_removeTask(e,t){return lt(this,void 0,void 0,function*(){return yield this.client.api(`/me/outlook/tasks/${e}`).header("Cache-Control","no-store").version("beta").header("If-Match",t).middlewareOptions(He("Tasks.ReadWrite")).delete()})}blobToBase64(e){return new Promise((t,r)=>{const s=new FileReader;s.onerror=r,s.onload=(e=>{t(s.result)}),s.readAsDataURL(e)})}getPhotoForResource(e,t){return lt(this,void 0,void 0,function*(){try{const r=yield this.client.api(`${e}/photo/$value`).version("beta").responseType(Oe.BLOB).middlewareOptions(He(...t)).get();return yield this.blobToBase64(r)}catch(e){return null}})}}export{qe as C,ct as G,V as I,B as L,Je as M,X as P,Z as _,M as a,G as b,H as c,He as d,Be as e,Ve as f,ze as g,Ze as h,Xe as i,Fe as j,Ge as k,je as l,ee as m,te as n,W as o,L as p};
//# sourceMappingURL=Graph-3b72116e.js.map
