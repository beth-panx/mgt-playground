import{e,f as t}from"./index-3a445c6b.js";import{h as n}from"./lit-html-c7682711.js";import{c as a,p as i,a as o,M as r,P as s,b as d,d as l,g,e as v}from"./Graph-3b72116e.js";import"./mgt-mock-provider-3678bf7a.js";const c=[a`:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\E70E"}.ms-Icon--Contact::before{content:"\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\EB6D"}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,40px 10px 14px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);color:var(--agenda-header-color,#333)}:host .agenda > .group:first-child > .header,mgt-agenda .agenda > .group:first-child > .header{margin-top:0}:host .agenda-list,mgt-agenda .agenda-list{list-style-type:none;padding:0;margin:0;font-family:var(--default-font-family);font-style:normal;font-weight:400}:host .event,mgt-agenda .event{background:var(--event-background,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--event-box-shadow,0 2px 8px rgba(0,0,0,.092));margin:var(--event-margin,0 10px 14px 10px);padding:var(--event-padding,0);display:flex}:host .narrow .event,mgt-agenda .narrow .event{flex-direction:column}:host .event-time-container,mgt-agenda .event-time-container{display:flex;flex-direction:column;margin:18px 38px 18px 18px;width:120px}:host .narrow .event-time-container,mgt-agenda .narrow .event-time-container{margin:14px 18px 8px 18px}:host .event-time,mgt-agenda .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,#000);font-weight:600}:host .event-duration,mgt-agenda .event-duration{color:rgba(16,16,16,.3)}:host .event-details-container,mgt-agenda .event-details-container{margin:14px 18px 14px 0}:host .narrow .event-details-container,mgt-agenda .narrow .event-details-container{margin:0 18px 14px 18px}:host .event-subject,mgt-agenda .event-subject{margin:0 18px 0 0;font-size:var(--event-subject-font-size,19px);color:var(--event-subject-color,#333)}:host .event-location-container,mgt-agenda .event-location-container{display:flex;margin:8px 18px 0 0}:host .event-location,mgt-agenda .event-location{font-size:var(--event-location-font-size,12px);color:var(--event-location-color,#000);margin:0 0 0 4px}:host .event-attendees,mgt-agenda .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}:host .event-other-container,mgt-agenda .event-other-container{margin:2px 16px 4px 16px;margin-left:auto}:host .loading-element,mgt-agenda .loading-element{background:#f2f2f2;border-radius:1px}:host .event-time-loading,mgt-agenda .event-time-loading{width:100px;height:10px}:host .event-subject-loading,mgt-agenda .event-subject-loading{width:263px;height:16px}:host .event-location-icon-loading,mgt-agenda .event-location-icon-loading{width:14px;height:14px}:host .event-location-loading,mgt-agenda .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .event-attendee-loading,mgt-agenda .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}`];var m=function(e,t,n,a){var i,o=arguments.length,r=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},p=function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function r(e){try{d(a.next(e))}catch(e){o(e)}}function s(e){try{d(a.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,s)}d((a=a.apply(e,t||[])).next())})};let h=class extends r{constructor(){super(),this.groupByDay=!1,this.days=3,this._firstUpdated=!1,this._loading=!0,this.onResize=this.onResize.bind(this)}static get styles(){return c}firstUpdated(){this._firstUpdated=!0,s.onProviderUpdated(()=>this.loadData()),this.loadData()}connectedCallback(){this._isNarrow=this.offsetWidth<600,super.connectedCallback(),window.addEventListener("resize",this.onResize)}disconnectedCallback(){window.removeEventListener("resize",this.onResize),super.disconnectedCallback()}attributeChangedCallback(e,t,n){t===n||"date"!==e&&"days"!==e&&"group-id"!==e||(this.events=null,this.loadData()),super.attributeChangedCallback(e,t,n)}render(){return this._isNarrow=this.offsetWidth<600,n` <div class="agenda ${this._isNarrow?"narrow":""}"> ${this.renderAgenda()} </div> `}onResize(){this._isNarrow=this.offsetWidth<600}loadData(){return p(this,void 0,void 0,function*(){if(this.events)return;if(!this._firstUpdated)return;const e=s.globalProvider;if(e&&e.state===d.SignedIn){if(this._loading=!0,this.eventQuery)try{const t=this.eventQuery.split("|");let n,a;t.length>1?(a=t[0].trim(),n=t[1].trim()):a=this.eventQuery;let i=yield e.graph.client.api(a);n&&(i=i.middlewareOptions(l(n)));const o=yield i.get();o&&o.value&&(this.events=o.value)}catch(e){}else{const t=this.date?new Date(this.date):new Date;t.setHours(0,0,0,0);const n=new Date(t.getTime());n.setDate(t.getDate()+this.days);try{this.events=yield e.graph.getEvents(t,n,this.groupId)}catch(e){}}this._loading=!1}else e&&e.state===d.Loading?this._loading=!0:this._loading=!1})}renderAgenda(){if(this._loading)return this.renderTemplate("loading",null)||this.renderLoading();if(this.events){const e=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,t=this.renderTemplate("default",{events:e});if(t)return t;if(this.groupByDay){const t={};for(let n=0;n<e.length;n++){const a=this.getDateHeaderFromDateTimeString(e[n].start.dateTime);t[a]=t[a]||[],t[a].push(e[n])}return n` <div class="agenda grouped ${this._isNarrow?"narrow":""}"> ${Object.keys(t).map(e=>n` <div class="group"> ${this.renderTemplate("header",{header:e},"header-"+e)||n` <div class="header" aria-label="${e}">${e}</div> `} ${this.renderListOfEvents(t[e])} </div> `)} </div> `}return this.renderListOfEvents(e)}return this.renderTemplate("no-data",null)||n``}renderListOfEvents(e){return n` <ul class="agenda-list"> ${e.map(e=>n` <li @click="${()=>this.eventClicked(e)}"> ${this.renderTemplate("event",{event:e},e.id)||this.renderEvent(e)} </li> `)} </ul> `}renderLoading(){return n` <div class="event"> <div class="event-time-container"> <div class="event-time-loading loading-element"></div> </div> <div class="event-details-container"> <div class="event-subject-loading loading-element"></div> <div class="event-location-container"> <div class="event-location-icon-loading loading-element"></div> <div class="event-location-loading loading-element"></div> </div> <div class="event-location-container"> <div class="event-attendee-loading loading-element"></div> <div class="event-attendee-loading loading-element"></div> <div class="event-attendee-loading loading-element"></div> </div> </div> </div> `}renderEvent(e){return n` <div class="event"> <div class="event-time-container"> <div class="event-time" aria-label="${this.getEventTimeString(e)}">${this.getEventTimeString(e)}</div> </div> <div class="event-details-container"> <div class="event-subject">${e.subject}</div> ${this.renderLocation(e)} ${this.renderAttendies(e)} </div> ${this.templates["event-other"]?n` <div class="event-other-container"> ${this.renderTemplate("event-other",{event:e},e.id+"-other")} </div> `:""} </div> `}renderLocation(e){return e.location.displayName?n` <div class="event-location-container"> <svg width="10" height="13" viewBox="0 0 10 13" fill="none" xmlns="http://www.w3.org/2000/svg"> <path fill-rule="evenodd" clip-rule="evenodd" d="M4.99989 6.49989C4.15159 6.49989 3.46143 5.81458 3.46143 4.97224C3.46143 4.12965 4.15159 3.44434 4.99989 3.44434C5.84845 3.44434 6.53835 4.12965 6.53835 4.97224C6.53835 5.81458 5.84845 6.49989 4.99989 6.49989Z" stroke="black"/> <path fill-rule="evenodd" clip-rule="evenodd" d="M8.1897 7.57436L5.00029 12L1.80577 7.56765C0.5971 6.01895 0.770299 3.47507 2.17681 2.12383C2.93098 1.39918 3.93367 1 5.00029 1C6.06692 1 7.06961 1.39918 7.82401 2.12383C9.23075 3.47507 9.40372 6.01895 8.1897 7.57436Z" stroke="black"/> </svg> <div class="event-location" aria-label="${e.location.displayName}">${e.location.displayName}</div> </div> `:null}renderAttendies(e){return e.attendees.length?n` <mgt-people class="event-attendees" .people="${e.attendees.map(e=>({displayName:e.emailAddress.name,emailAddresses:[e.emailAddress]}))}"></mgt-people> `:null}eventClicked(e){this.fireCustomEvent("eventClick",{event:e})}getEventTimeString(e){if(e.isAllDay)return"ALL DAY";return`${this.prettyPrintTimeFromDateTime(new Date(e.start.dateTime))} - ${this.prettyPrintTimeFromDateTime(new Date(e.end.dateTime))}`}prettyPrintTimeFromDateTime(e){e.setMinutes(e.getMinutes()-e.getTimezoneOffset());let t=e.getHours();const n=e.getMinutes(),a=t>=12?"PM":"AM";return`${t=(t%=12)||12}:${n<10?"0"+n:n} ${a}`}getDateHeaderFromDateTimeString(e){const t=new Date(e);t.setMinutes(t.getMinutes()-t.getTimezoneOffset());const n=t.getDay(),a=t.getMonth(),i=t.getDate(),o=t.getFullYear();return`${g(n)}, ${v(a)} ${i}, ${o}`}getEventDuration(e){let t=new Date(e.start.dateTime);const n=new Date(e.end.dateTime),a=new Date;let i="";a>t&&(t=a);const o=n.getTime()-t.getTime(),r=Math.round(o/6e4);if(r>1440||e.isAllDay)i=Math.ceil(r/1440)+"d";else if(r>60){i=Math.round(r/60)+"h";const e=r%60;e&&(i+=e+"m")}else i=r+"m";return i}};m([i({attribute:"events"})],h.prototype,"events",void 0),m([i({attribute:"group-by-day",reflect:!0,type:Boolean})],h.prototype,"groupByDay",void 0),m([i({attribute:"date",reflect:!0,type:String})],h.prototype,"date",void 0),m([i({attribute:"days",reflect:!0,type:Number})],h.prototype,"days",void 0),m([i({attribute:"event-query",type:String})],h.prototype,"eventQuery",void 0),m([i({attribute:"show-max",type:Number})],h.prototype,"showMax",void 0),m([i({attribute:"group-id",type:String})],h.prototype,"groupId",void 0),m([i({attribute:!1})],h.prototype,"_isNarrow",void 0),m([i({attribute:!1})],h.prototype,"_loading",void 0),h=m([o("mgt-agenda")],h);const u=()=>n` <mgt-mock-provider></mgt-mock-provider> <mgt-agenda></mgt-agenda> `,f=()=>n` <mgt-mock-provider></mgt-mock-provider> <mgt-agenda event-query="/me/events?orderby=start/dateTime"></mgt-agenda> `,y=()=>n` <mgt-mock-provider></mgt-mock-provider> <mgt-agenda group-by-day date="May 7, 2019" days="3"></mgt-agenda> `,x=()=>n` <mgt-mock-provider></mgt-mock-provider> <mgt-agenda> <template data-type="event"> <button class="eventButton"> <div class="event-subject">{{ event.subject }}</div> <div data-for="attendee in event.attendees"> <mgt-person person-query="{{ attendee.emailAddress.name }}" show-name show-email> </mgt-person> </div> </button> </template> <template data-type="no-data"> There are no events found! </template> </mgt-agenda> `;export default{title:"Mock Provider|mgt-agenda",component:"mgt-agenda",decorators:[e,t]};export{y as getByDate,f as getByEventQuery,x as getByEventTemplate,u as simple};
//# sourceMappingURL=agenda.stories-e75d44e6.js.map
