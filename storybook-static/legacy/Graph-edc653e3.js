System.register(["./lit-html-de476c62.js"],function(e){"use strict";var t,r,n,a,i,o,s,u,c,d,l,h,p,f,v,m,g,y,w,b,k,x,R,_,E;return{setters:[function(e){t=e.i,r=e._,n=e.p,a=e.r,i=e.t,o=e.m,s=e.T,u=e.j,c=e.k,d=e.a,l=e.e,h=e.n,p=e.b,f=e.c,v=e.d,m=e.h,g=e.f,y=e.o,w=e.q,b=e.s,k=e.A,x=e.P,R=e.u,_=e.v,E=e.w}],execute:function(){e({_:function(e,t){function r(){this.constructor=e}ne(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},b:void 0,d:je,e:ze,g:function(e){switch(e){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";default:return"Day"}},h:void 0,i:function(e,t){var r;return function(){var n=arguments,a=this;clearTimeout(r),r=setTimeout(function(){return e.apply(a,n)},t)}},j:He,l:function(e){var t=e.getMonth(),r=e.getDate();return"".concat(ze(t)," ").concat(r)},n:function(e,t,n,a){var i,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},o:void 0,p:X});var C=133;function S(e,t){for(var r=e.element.content,n=e.parts,a=document.createTreeWalker(r,C,null,!1),i=P(n),o=n[i],s=-1,u=0,c=[],d=null;a.nextNode();){s++;var l=a.currentNode;for(l.previousSibling===d&&(d=null),t.has(l)&&(c.push(l),null===d&&(d=l)),null!==d&&u++;void 0!==o&&o.index===s;)o.index=null!==d?-1:o.index-u,o=n[i=P(n,i)]}c.forEach(function(e){return e.parentNode.removeChild(e)})}var T=function(e){for(var t=11===e.nodeType?0:1,r=document.createTreeWalker(e,C,null,!1);r.nextNode();)t++;return t},P=function(e){for(var r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1)+1;r<e.length;r++){var n=e[r];if(t(n))return r}return-1};var A=function(e,t){return"".concat(e,"--").concat(t)},O=!0;void 0===window.ShadyCSS?O=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),O=!1);var D=function(e){return function(t){var r=A(t.type,e),n=i.get(r);void 0===n&&(n={stringsArray:new WeakMap,keyString:new Map},i.set(r,n));var a=n.stringsArray.get(t.strings);if(void 0!==a)return a;var u=t.strings.join(o);if(void 0===(a=n.keyString.get(u))){var c=t.getTemplateElement();O&&window.ShadyCSS.prepareTemplateDom(c,e),a=new s(t,c),n.keyString.set(u,a)}return n.stringsArray.set(t.strings,a),a}},N=["html","svg"],I=new Set,U=function(e,t,r){I.add(e);var n=r?r.element:document.createElement("template"),a=t.querySelectorAll("style"),o=a.length;if(0!==o){for(var s=document.createElement("style"),u=0;u<o;u++){var c=a[u];c.parentNode.removeChild(c),s.textContent+=c.textContent}!function(e){N.forEach(function(t){var r=i.get(A(t,e));void 0!==r&&r.keyString.forEach(function(e){var t=e.element.content,r=new Set;Array.from(t.querySelectorAll("style")).forEach(function(e){r.add(e)}),S(e,r)})})}(e);var d=n.content;r?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.element.content,a=e.parts;if(null!=r)for(var i=document.createTreeWalker(n,C,null,!1),o=P(a),s=0,u=-1;i.nextNode();)for(u++,i.currentNode===r&&(s=T(t),r.parentNode.insertBefore(t,r));-1!==o&&a[o].index===u;){if(s>0){for(;-1!==o;)a[o].index+=s,o=P(a,o);return}o=P(a,o)}else n.appendChild(t)}(r,s,d.firstChild):d.insertBefore(s,d.firstChild),window.ShadyCSS.prepareTemplateStyles(n,e);var l=d.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==l)t.insertBefore(l.cloneNode(!0),t.firstChild);else if(r){d.insertBefore(s,d.firstChild);var h=new Set;h.add(s),S(r,h)}}else window.ShadyCSS.prepareTemplateStyles(n,e)};window.JSCompiler_renameProperty=function(e,t){return e};var M={toAttribute:function(e,t){switch(t){case Boolean:return e?"":null;case Object:case Array:return null==e?e:JSON.stringify(e)}return e},fromAttribute:function(e,t){switch(t){case Boolean:return null!==e;case Number:return null===e?null:Number(e);case Object:case Array:return JSON.parse(e)}return e}},L=function(e,t){return t!==e&&(t==t||e==e)},q={attribute:!0,type:String,converter:M,reflect:!1,hasChanged:L},F=Promise.resolve(!0),H=function(e){function t(){var e;return p(this,t),(e=f(this,v(t).call(this)))._updateState=0,e._instanceProperties=void 0,e._updatePromise=F,e._hasConnectedResolver=void 0,e._changedProperties=new Map,e._reflectingProperties=void 0,e.initialize(),e}return d(t,e),l(t,[{key:"initialize",value:function(){this._saveInstanceProperties(),this._requestUpdate()}},{key:"_saveInstanceProperties",value:function(){var e=this;this.constructor._classProperties.forEach(function(t,r){if(e.hasOwnProperty(r)){var n=e[r];delete e[r],e._instanceProperties||(e._instanceProperties=new Map),e._instanceProperties.set(r,n)}})}},{key:"_applyInstanceProperties",value:function(){var e=this;this._instanceProperties.forEach(function(t,r){return e[r]=t}),this._instanceProperties=void 0}},{key:"connectedCallback",value:function(){this._updateState=32|this._updateState,this._hasConnectedResolver&&(this._hasConnectedResolver(),this._hasConnectedResolver=void 0)}},{key:"disconnectedCallback",value:function(){}},{key:"attributeChangedCallback",value:function(e,t,r){t!==r&&this._attributeToProperty(e,r)}},{key:"_propertyToAttribute",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:q,n=this.constructor,a=n._attributeNameForProperty(e,r);if(void 0!==a){var i=n._propertyValueToAttribute(t,r);if(void 0===i)return;this._updateState=8|this._updateState,null==i?this.removeAttribute(a):this.setAttribute(a,i),this._updateState=-9&this._updateState}}},{key:"_attributeToProperty",value:function(e,t){if(!(8&this._updateState)){var r=this.constructor,n=r._attributeToPropertyMap.get(e);if(void 0!==n){var a=r._classProperties.get(n)||q;this._updateState=16|this._updateState,this[n]=r._propertyValueFromAttribute(t,a),this._updateState=-17&this._updateState}}}},{key:"_requestUpdate",value:function(e,t){var r=!0;if(void 0!==e){var n=this.constructor,a=n._classProperties.get(e)||q;n._valueHasChanged(this[e],t,a.hasChanged)?(this._changedProperties.has(e)||this._changedProperties.set(e,t),!0!==a.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(e,a))):r=!1}!this._hasRequestedUpdate&&r&&this._enqueueUpdate()}},{key:"requestUpdate",value:function(e,t){return this._requestUpdate(e,t),this.updateComplete}},{key:"_enqueueUpdate",value:function(){var e,t,r,n,a=this;return regeneratorRuntime.async(function(i){for(;;)switch(i.prev=i.next){case 0:return this._updateState=4|this._updateState,r=this._updatePromise,this._updatePromise=new Promise(function(r,n){e=r,t=n}),i.prev=3,i.next=6,regeneratorRuntime.awrap(r);case 6:i.next=10;break;case 8:i.prev=8,i.t0=i.catch(3);case 10:if(this._hasConnected){i.next=13;break}return i.next=13,regeneratorRuntime.awrap(new Promise(function(e){return a._hasConnectedResolver=e}));case 13:if(i.prev=13,null==(n=this.performUpdate())){i.next=18;break}return i.next=18,regeneratorRuntime.awrap(n);case 18:i.next=23;break;case 20:i.prev=20,i.t1=i.catch(13),t(i.t1);case 23:e(!this._hasRequestedUpdate);case 24:case"end":return i.stop()}},null,this,[[3,8],[13,20]])}},{key:"performUpdate",value:function(){this._instanceProperties&&this._applyInstanceProperties();var e=!1,t=this._changedProperties;try{(e=this.shouldUpdate(t))&&this.update(t)}catch(t){throw e=!1,t}finally{this._markUpdated()}e&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(t)),this.updated(t))}},{key:"_markUpdated",value:function(){this._changedProperties=new Map,this._updateState=-5&this._updateState}},{key:"_getUpdateComplete",value:function(){return this._updatePromise}},{key:"shouldUpdate",value:function(e){return!0}},{key:"update",value:function(e){var t=this;void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach(function(e,r){return t._propertyToAttribute(r,t[r],e)}),this._reflectingProperties=void 0)}},{key:"updated",value:function(e){}},{key:"firstUpdated",value:function(e){}},{key:"_hasConnected",get:function(){return 32&this._updateState}},{key:"_hasRequestedUpdate",get:function(){return 4&this._updateState}},{key:"hasUpdated",get:function(){return 1&this._updateState}},{key:"updateComplete",get:function(){return this._getUpdateComplete()}}],[{key:"_ensureClassProperties",value:function(){var e=this;if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;var t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach(function(t,r){return e._classProperties.set(r,t)})}}},{key:"createProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:q;if(this._ensureClassProperties(),this._classProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){var n="symbol"===r(e)?Symbol():"__".concat(e);Object.defineProperty(this.prototype,e,{get:function(){return this[n]},set:function(t){var r=this[e];this[n]=t,this._requestUpdate(e,r)},configurable:!0,enumerable:!0})}}},{key:"finalize",value:function(){var e=Object.getPrototypeOf(this);if(e.hasOwnProperty("finalized")||e.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){var t=this.properties,r=[].concat(m(Object.getOwnPropertyNames(t)),m("function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[])),n=!0,a=!1,i=void 0;try{for(var o,s=r[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var u=o.value;this.createProperty(u,t[u])}}catch(e){a=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}}}},{key:"_attributeNameForProperty",value:function(e,t){var r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}},{key:"_valueHasChanged",value:function(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:L)(e,t)}},{key:"_propertyValueFromAttribute",value:function(e,t){var r=t.type,n=t.converter||M,a="function"==typeof n?n:n.fromAttribute;return a?a(e,r):e}},{key:"_propertyValueToAttribute",value:function(e,t){if(void 0!==t.reflect){var r=t.type,n=t.converter;return(n&&n.toAttribute||M.toAttribute)(e,r)}}},{key:"observedAttributes",get:function(){var e=this;this.finalize();var t=[];return this._classProperties.forEach(function(r,n){var a=e._attributeNameForProperty(n,r);void 0!==a&&(e._attributeToPropertyMap.set(a,n),t.push(a))}),t}}]),t}(h(HTMLElement));H.finalized=!0;var j=e("a",function(e){return function(t){return"function"==typeof t?function(e,t){return window.customElements.define(e,t),t}(e,t):function(e,t){return{kind:t.kind,elements:t.elements,finisher:function(t){window.customElements.define(e,t)}}}(e,t)}}),z=function(e,t){return"method"!==t.kind||!t.descriptor||"value"in t.descriptor?{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer:function(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher:function(r){r.createProperty(t.key,e)}}:Object.assign({},t,{finisher:function(r){r.createProperty(t.key,e)}})},B=function(e,t,r){t.constructor.createProperty(r,e)};function X(e){return function(t,r){return void 0!==r?B(e,t,r):z(e,t)}}var Q="adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,W=Symbol(),$=function(){function e(t,r){if(p(this,e),r!==W)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}return l(e,[{key:"toString",value:function(){return this.cssText}},{key:"styleSheet",get:function(){return void 0===this._styleSheet&&(Q?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}}]),e}(),G=e("c",function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=r.reduce(function(t,r,n){return t+function(e){if(e instanceof $)return e.cssText;if("number"==typeof e)return e;throw new Error("Value passed to 'css' function must be a 'css' function result: ".concat(e,". Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security."))}(r)+e[n+1]},e[0]);return new $(a,W)});(window.litElementVersions||(window.litElementVersions=[])).push("2.2.1");var V=function(e){return e.flat?e.flat(1/0):function e(t){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=0,a=t.length;n<a;n++){var i=t[n];Array.isArray(i)?e(i,r):r.push(i)}return r}(e)},Y=e("L",function(e){function t(){return p(this,t),f(this,v(t).apply(this,arguments))}return d(t,H),l(t,[{key:"initialize",value:function(){g(v(t.prototype),"initialize",this).call(this),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}},{key:"createRenderRoot",value:function(){return this.attachShadow({mode:"open"})}},{key:"adoptStyles",value:function(){var e=this.constructor._styles;0!==e.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?Q?this.renderRoot.adoptedStyleSheets=e.map(function(e){return e.styleSheet}):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(e.map(function(e){return e.cssText}),this.localName))}},{key:"connectedCallback",value:function(){g(v(t.prototype),"connectedCallback",this).call(this),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}},{key:"update",value:function(e){var r=this;g(v(t.prototype),"update",this).call(this,e);var n=this.render();n instanceof y&&this.constructor.render(n,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach(function(e){var t=document.createElement("style");t.textContent=e.cssText,r.renderRoot.appendChild(t)}))}},{key:"render",value:function(){}}],[{key:"finalize",value:function(){g(v(t),"finalize",this).call(this),this._styles=this.hasOwnProperty(JSCompiler_renameProperty("styles",this))?this._getUniqueStyles():this._styles||[]}},{key:"_getUniqueStyles",value:function(){var e=this.styles,t=[];Array.isArray(e)?V(e).reduceRight(function(e,t){return e.add(t),e},new Set).forEach(function(e){return t.unshift(e)}):e&&t.push(e);return t}}]),t}());Y.finalized=!0,Y.render=function(e,t,i){if(!i||"object"!==r(i)||!i.scopeName)throw new Error("The `scopeName` option is required.");var o=i.scopeName,s=n.has(t),d=O&&11===t.nodeType&&!!t.host,l=d&&!I.has(o),h=l?document.createDocumentFragment():t;if(a(e,h,Object.assign({templateFactory:D(o)},i)),l){var p=n.get(h);n.delete(h);var f=p.value instanceof u?p.value.template:void 0;U(o,h,f),c(t,t.firstChild),t.appendChild(h),n.set(t,p)}!s&&d&&window.ShadyCSS.styleElement(t.host)};var J,Z=function(){function e(){p(this,e),this.eventHandlers=[]}return l(e,[{key:"fire",value:function(e){var t=!0,r=!1,n=void 0;try{for(var a,i=this.eventHandlers[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){(0,a.value)(e)}}catch(e){r=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw n}}}},{key:"add",value:function(e){this.eventHandlers.push(e)}},{key:"remove",value:function(e){for(var t=0;t<this.eventHandlers.length;t++)this.eventHandlers[t]===e&&(this.eventHandlers.splice(t,1),t--)}}]),e}(),K=e("P",function(){function e(){p(this,e)}return l(e,null,[{key:"onProviderUpdated",value:function(e){this._eventDispatcher.add(e)}},{key:"removeProviderUpdatedListener",value:function(e){this._eventDispatcher.remove(e)}},{key:"handleProviderStateChanged",value:function(){e._eventDispatcher.fire(J.ProviderStateChanged)}},{key:"globalProvider",get:function(){return this._globalProvider},set:function(e){e!==this._globalProvider&&(this._globalProvider&&this._globalProvider.removeStateChangedHandler(this.handleProviderStateChanged),e&&e.onStateChanged(this.handleProviderStateChanged),this._globalProvider=e,this._eventDispatcher.fire(J.ProviderChanged))}}]),e}());K._eventDispatcher=new Z,function(e){e[e.ProviderChanged=0]="ProviderChanged",e[e.ProviderStateChanged=1]="ProviderStateChanged"}(J||(J={}));var ee,te;e("I",function(){function e(){p(this,e),this._loginChangedDispatcher=new Z,this._state=te.Loading}return l(e,[{key:"setState",value:function(e){e!==this._state&&(this._state=e,this._loginChangedDispatcher.fire({}))}},{key:"onStateChanged",value:function(e){this._loginChangedDispatcher.add(e)}},{key:"removeStateChangedHandler",value:function(e){this._loginChangedDispatcher.remove(e)}},{key:"getAccessTokenForScopes",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.getAccessToken({scopes:t})}},{key:"state",get:function(){return this._state}}]),e}());!function(e){e[e.Popup=0]="Popup",e[e.Redirect=1]="Redirect"}(ee||(ee=e("o",{}))),function(e){e[e.Loading=0]="Loading",e[e.SignedOut=1]="SignedOut",e[e.SignedIn=2]="SignedIn"}(te||(te=e("b",{})));var re=document.createElement("style");re.type="text/css",re.appendChild(document.createTextNode("\n@font-face {\n    font-family: 'FabricMDL2Icons';\n    src: url('https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff2') format('woff2'),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.woff) format(\"woff\"),\n    url(https://static2.sharepointonline.com/files/fabric/assets/icons/fabricmdl2icons-2.68.ttf) format(\"truetype\");;\n}\n")),document.head.appendChild(re);var ne=function(e,t){return(ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var ae;e("m",function(){return e("m",Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)});function ie(e,t,r,n){return new(r||(r=Promise))(function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new r(function(t){t(e.value)}).then(o,s)}u((n=n.apply(e,t||[])).next())})}!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(ae||(ae={}));var oe=function(){function e(t){if(p(this,e),this.requests=new Map,void 0!==t){var r=e.requestLimit;if(t.length>r){var n=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(r));throw n.name="Limit Exceeded Error",n}var a=!0,i=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var c=s.value;this.addRequest(c)}}catch(e){i=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}}}return l(e,[{key:"addRequest",value:function(t){var r=e.requestLimit;if(""===t.id){var n=new Error("Id for a request is empty, Please provide an unique id");throw n.name="Empty Id For Request",n}if(this.requests.size===r){var a=new Error("Maximum requests limit exceeded, Max allowed number of requests are ".concat(r));throw a.name="Limit Exceeded Error",a}if(this.requests.has(t.id)){var i=new Error("Adding request with duplicate id ".concat(t.id,", Make the id of the requests unique"));throw i.name="Duplicate RequestId Error",i}return this.requests.set(t.id,t),t.id}},{key:"removeRequest",value:function(e){for(var t=this.requests.delete(e),r=this.requests.entries(),n=r.next();!n.done;){var a=n.value[1].dependsOn;if(void 0!==a){var i=a.indexOf(e);-1!==i&&a.splice(i,1),0===a.length&&delete n.value[1].dependsOn}n=r.next()}return t}},{key:"getContent",value:function(){return ie(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n,a,i,o,s,u,c,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n={requests:r=[]},a=this.requests.entries(),!(i=a.next()).done){t.next=8;break}throw(o=new Error("No requests added yet, Please add at least one request.")).name="Empty Payload",o;case 8:if(e.validateDependencies(this.requests)){t.next=12;break}throw(s=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.")).name="Invalid Dependency",s;case 12:if(i.done){t.next=27;break}return u=i.value[1],t.next=16,e.getRequestData(u.request);case 16:if(void 0===(c=t.sent).body||void 0!==c.headers&&void 0!==c.headers["content-type"]){t.next=21;break}throw(d=new Error("Content-type header is not mentioned for request #".concat(u.id,", For request having body, Content-type header should be mentioned"))).name="Invalid Content-type header",d;case 21:c.id=u.id,void 0!==u.dependsOn&&u.dependsOn.length>0&&(c.dependsOn=u.dependsOn),r.push(c),i=a.next(),t.next=12;break;case 27:return n.requests=r,t.abrupt("return",n);case 29:case"end":return t.stop()}},t,this)}))}},{key:"addDependency",value:function(e,t){if(!this.requests.has(e)){var r=new Error("Dependent ".concat(e," does not exists, Please check the id"));throw r.name="Invalid Dependent",r}if(void 0!==t&&!this.requests.has(t)){var n=new Error("Dependency ".concat(t," does not exists, Please check the id"));throw n.name="Invalid Dependency",n}if(void 0!==t){var a=this.requests.get(e);if(void 0===a.dependsOn&&(a.dependsOn=[]),-1!==a.dependsOn.indexOf(t)){var i=new Error("Dependency ".concat(t," is already added for the request ").concat(e));throw i.name="Duplicate Dependency",i}a.dependsOn.push(t)}else{for(var o,s=this.requests.entries(),u=s.next();!u.done&&u.value[1].id!==e;)o=u,u=s.next();if(void 0===o){var c=new Error("Can't add dependency ".concat(t,", There is only a dependent request in the batch"));throw c.name="Invalid Dependency Addition",c}var d=o.value[0];if(void 0===u.value[1].dependsOn&&(u.value[1].dependsOn=[]),-1!==u.value[1].dependsOn.indexOf(d)){var l=new Error("Dependency ".concat(d," is already added for the request ").concat(e));throw l.name="Duplicate Dependency",l}u.value[1].dependsOn.push(d)}}},{key:"removeDependency",value:function(e,t){var r=this.requests.get(e);if(void 0===r||void 0===r.dependsOn||0===r.dependsOn.length)return!1;if(void 0!==t){var n=r.dependsOn.indexOf(t);return-1!==n&&(r.dependsOn.splice(n,1),!0)}return delete r.dependsOn,!0}}],[{key:"validateDependencies",value:function(e){if(0===e.size){var t=new Error("Empty requests map, Please provide at least one request.");throw t.name="Empty Requests Error",t}return function(e){for(var t=e.entries(),r=t.next();!r.done;){var n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;r=t.next()}return!0}(e)||function(e){var t=e.entries(),r=t.next(),n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;var a=r;for(r=t.next();!r.done;){var i=r.value[1];if(void 0===i.dependsOn||1!==i.dependsOn.length||i.dependsOn[0]!==a.value[1].id)return!1;a=r,r=t.next()}return!0}(e)||function(e){var t,r=e.entries(),n=r.next(),a=n.value[1];if(void 0===a.dependsOn||0===a.dependsOn.length)t=a.id;else{if(1!==a.dependsOn.length)return!1;var i=a.dependsOn[0];if(i===a.id||!e.has(i))return!1;t=i}for(n=r.next();!n.done;){var o=n.value[1];if((void 0===o.dependsOn||0===o.dependsOn.length)&&t!==o.id)return!1;if(void 0!==o.dependsOn&&0!==o.dependsOn.length){if(1===o.dependsOn.length&&(o.id===t||o.dependsOn[0]!==t))return!1;if(o.dependsOn.length>1)return!1}n=r.next()}return!0}(e)}},{key:"getRequestData",value:function(t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n,a,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n={url:""},a=new RegExp("^https?://"),n.url=a.test(t.url)?"/"+t.url.split(/.*?\/\/.*?\//)[1]:t.url,n.method=t.method,i={},t.headers.forEach(function(e,t){i[t]=e}),Object.keys(i).length&&(n.headers=i),t.method!==ae.PATCH&&t.method!==ae.POST&&t.method!==ae.PUT){r.next=11;break}return r.next=10,e.getRequestBody(t);case 10:n.body=r.sent;case 11:return r.abrupt("return",n);case 12:case"end":return r.stop()}},r)}))}},{key:"getRequestBody",value:function(e){return ie(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n,a,i,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=!1,t.prev=1,a=e.clone(),t.next=5,a.json();case 5:n=t.sent,r=!0,t.next=11;break;case 9:t.prev=9,t.t0=t.catch(1);case 11:if(r){t.next=33;break}if(t.prev=12,"undefined"==typeof Blob){t.next=23;break}return t.next=16,e.blob();case 16:return i=t.sent,o=new FileReader,t.next=20,new Promise(function(e){o.addEventListener("load",function(){var t=o.result,r=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(r[4])},!1),o.readAsDataURL(i)});case 20:n=t.sent,t.next=28;break;case 23:if("undefined"==typeof Buffer){t.next=28;break}return t.next=26,e.buffer();case 26:s=t.sent,n=s.toString("base64");case 28:r=!0,t.next=33;break;case 31:t.prev=31,t.t1=t.catch(12);case 33:return t.abrupt("return",n);case 34:case"end":return t.stop()}},t,null,[[1,9],[12,31]])}))}}]),e}();oe.requestLimit=20;var se,ue=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];p(this,e),this.middlewareOptions=new Map;var r=!0,n=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var s=i.value,u=s.constructor;this.middlewareOptions.set(u,s)}}catch(e){n=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}}return l(e,[{key:"getMiddlewareOptions",value:function(e){return this.middlewareOptions.get(e)}},{key:"setMiddlewareOptions",value:function(e,t){this.middlewareOptions.set(e,t)}}]),e}(),ce=function(){for(var e="",t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},de=function(e,t,r){var n=null;if("undefined"!=typeof Request&&e instanceof Request)n=e.headers.get(r);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)n=t.headers.get(r);else if(t.headers instanceof Array){for(var a=t.headers,i=0,o=a.length;i<o;i++)if(a[i][0]===r){n=a[i][1];break}}else void 0!==t.headers[r]&&(n=t.headers[r]);return n},le=function(e,t,r,n){if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(r,n);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers(w({},r,n));else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(r,n);else if(t.headers instanceof Array){for(var a=0,i=t.headers.length;a<i;a++){var o=t.headers[a];if(o[0]===r){o[1]=n;break}}a===i&&t.headers.push([r,n])}else Object.assign(t.headers,w({},r,n))},he=function(e,t,r,n){"undefined"!=typeof Request&&e instanceof Request?e.headers.append(r,n):void 0!==t&&(void 0===t.headers?t.headers=new Headers(w({},r,n)):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(r,n):t.headers instanceof Array?t.headers.push([r,n]):void 0===t.headers?t.headers=w({},r,n):void 0===t.headers[r]?t.headers[r]=n:t.headers[r]+=", ".concat(n))},pe=function(e,t){return ie(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var n,a,i,o,s,u,c,d,l,h,p,f;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.headers.get("Content-Type")){r.next=6;break}return r.next=3,t.blob();case 3:r.t0=r.sent,r.next=9;break;case 6:return r.next=8,Promise.resolve(void 0);case 8:r.t0=r.sent;case 9:return n=r.t0,a=t.method,i=t.headers,o=t.referrer,s=t.referrerPolicy,u=t.mode,c=t.credentials,d=t.cache,l=t.redirect,h=t.integrity,p=t.keepalive,f=t.signal,r.abrupt("return",new Request(e,{method:a,headers:i,body:n,referrer:o,referrerPolicy:s,mode:u,credentials:c,cache:d,redirect:l,integrity:h,keepalive:p,signal:f}));case 12:case"end":return r.stop()}},r)}))},fe=function e(t,r){p(this,e),this.authenticationProvider=t,this.authenticationProviderOptions=r};!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(se||(se={}));var ve=function(){function e(){p(this,e),this.featureUsage=se.NONE}return l(e,[{key:"setFeatureUsage",value:function(e){this.featureUsage=this.featureUsage|e}},{key:"getFeatureUsage",value:function(){return this.featureUsage.toString(16)}}],[{key:"updateFeatureUsageFlag",value:function(t,r){var n;t.middlewareControl instanceof ue?n=t.middlewareControl.getMiddlewareOptions(e):t.middlewareControl=new ue,void 0===n&&(n=new e,t.middlewareControl.setMiddlewareOptions(e,n)),n.setFeatureUsage(r)}}]),e}(),me=function(){function e(t){p(this,e),this.authenticationProvider=t}return l(e,[{key:"execute",value:function(t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n,a,i,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t.middlewareControl instanceof ue&&(n=t.middlewareControl.getMiddlewareOptions(fe)),void 0!==n&&(a=n.authenticationProvider,i=n.authenticationProviderOptions),void 0===a&&(a=this.authenticationProvider),r.next=6,a.getAccessToken(i);case 6:return o=r.sent,s="Bearer ".concat(o),he(t.request,t.options,e.AUTHORIZATION_HEADER,s),ve.updateFeatureUsageFlag(t,se.AUTHENTICATION_HANDLER_ENABLED),r.next=12,this.nextMiddleware.execute(t);case 12:return r.abrupt("return",r.sent);case 15:throw r.prev=15,r.t0=r.catch(0),r.t0;case 18:case"end":return r.stop()}},r,this,[[0,15]])}))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();me.AUTHORIZATION_HEADER="Authorization";var ge=function(){function e(){p(this,e)}return l(e,[{key:"execute",value:function(e){return ie(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e.request,e.options);case 3:return e.response=t.sent,t.abrupt("return");case 7:throw t.prev=7,t.t0=t.catch(0),t.t0;case 10:case"end":return t.stop()}},t,null,[[0,7]])}))}}]),e}(),ye=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_DELAY,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_MAX_RETRIES,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.DEFAULT_SHOULD_RETRY;if(p(this,e),t>e.MAX_DELAY&&r>e.MAX_MAX_RETRIES){var a=new Error("Delay and MaxRetries should not be more than ".concat(e.MAX_DELAY," and ").concat(e.MAX_MAX_RETRIES));throw a.name="MaxLimitExceeded",a}if(t>e.MAX_DELAY){var i=new Error("Delay should not be more than ".concat(e.MAX_DELAY));throw i.name="MaxLimitExceeded",i}if(r>e.MAX_MAX_RETRIES){var o=new Error("MaxRetries should not be more than ".concat(e.MAX_MAX_RETRIES));throw o.name="MaxLimitExceeded",o}if(t<0&&r<0){var s=new Error("Delay and MaxRetries should not be negative");throw s.name="MinExpectationNotMet",s}if(t<0){var u=new Error("Delay should not be negative");throw u.name="MinExpectationNotMet",u}if(r<0){var c=new Error("MaxRetries should not be negative");throw c.name="MinExpectationNotMet",c}this.delay=Math.min(t,e.MAX_DELAY),this.maxRetries=Math.min(r,e.MAX_MAX_RETRIES),this.shouldRetry=n}return l(e,[{key:"getMaxDelay",value:function(){return e.MAX_DELAY}}]),e}();ye.DEFAULT_DELAY=3,ye.DEFAULT_MAX_RETRIES=3,ye.MAX_DELAY=180,ye.MAX_MAX_RETRIES=10,ye.DEFAULT_SHOULD_RETRY=function(){return!0};var we=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ye;p(this,e),this.options=t}return l(e,[{key:"isRetry",value:function(t){return-1!==e.RETRY_STATUS_CODES.indexOf(t.status)}},{key:"isBuffered",value:function(e,t){var r="string"==typeof e?t.method:e.method;if((r===ae.PUT||r===ae.PATCH||r===ae.POST)&&"application/octet-stream"===de(e,t,"Content-Type"))return!1;return!0}},{key:"getDelay",value:function(t,r,n){var a,i=function(){return Number(Math.random().toFixed(3))},o=void 0!==t.headers?t.headers.get(e.RETRY_AFTER_HEADER):null;return a=null!==o?Number.isNaN(Number(o))?Math.round((new Date(o).getTime()-Date.now())/1e3):Number(o):r>=2?this.getExponentialBackOffTime(r)+n+i():n+i(),Math.min(a,this.options.getMaxDelay()+i())}},{key:"getExponentialBackOffTime",value:function(e){return Math.round(.5*(Math.pow(2,e)-1))}},{key:"sleep",value:function(e){return ie(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=1e3*e,t.abrupt("return",new Promise(function(e){return setTimeout(e,r)}));case 2:case"end":return t.stop()}},t)}))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof ue&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new ye,this.options)),t}},{key:"executeWithRetry",value:function(t,r,n){return ie(this,void 0,void 0,regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this.nextMiddleware.execute(t);case 3:if(!(r<n.maxRetries&&this.isRetry(t.response)&&this.isBuffered(t.request,t.options)&&n.shouldRetry(n.delay,r,t.request,t.options,t.response))){a.next=14;break}return++r,le(t.request,t.options,e.RETRY_ATTEMPT_HEADER,r.toString()),i=this.getDelay(t.response,r,n.delay),a.next=9,this.sleep(i);case 9:return a.next=11,this.executeWithRetry(t,r,n);case 11:return a.abrupt("return",a.sent);case 14:return a.abrupt("return");case 15:a.next=20;break;case 17:throw a.prev=17,a.t0=a.catch(0),a.t0;case 20:case"end":return a.stop()}},a,this,[[0,17]])}))}},{key:"execute",value:function(e){return ie(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,0,r=this.getOptions(e),ve.updateFeatureUsageFlag(e,se.RETRY_HANDLER_ENABLED),t.next=6,this.executeWithRetry(e,0,r);case 6:return t.abrupt("return",t.sent);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}},t,this,[[0,9]])}))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();we.RETRY_STATUS_CODES=[429,503,504],we.RETRY_ATTEMPT_HEADER="Retry-Attempt",we.RETRY_AFTER_HEADER="Retry-After";var be=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_MAX_REDIRECTS,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_SHOULD_RETRY;if(p(this,e),t>e.MAX_MAX_REDIRECTS){var n=new Error("MaxRedirects should not be more than ".concat(e.MAX_MAX_REDIRECTS));throw n.name="MaxLimitExceeded",n}if(t<0){var a=new Error("MaxRedirects should not be negative");throw a.name="MinExpectationNotMet",a}this.maxRedirects=t,this.shouldRedirect=r};be.DEFAULT_MAX_REDIRECTS=5,be.MAX_MAX_REDIRECTS=20,be.DEFAULT_SHOULD_RETRY=function(){return!0};var ke=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new be;p(this,e),this.options=t}return l(e,[{key:"isRedirect",value:function(t){return-1!==e.REDIRECT_STATUS_CODES.indexOf(t.status)}},{key:"hasLocationHeader",value:function(t){return t.headers.has(e.LOCATION_HEADER)}},{key:"getLocationHeader",value:function(t){return t.headers.get(e.LOCATION_HEADER)}},{key:"isRelativeURL",value:function(e){return-1===e.indexOf("://")}},{key:"shouldDropAuthorizationHeader",value:function(e,t){var r,n,a=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,i=a.exec(e);null!==i&&(r=i[0]);var o=a.exec(t);return null!==o&&(n=o[0]),void 0!==r&&void 0!==n&&r!==n}},{key:"updateRequestUrl",value:function(e,t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("string"!=typeof t.request){r.next=4;break}r.t0=e,r.next=7;break;case 4:return r.next=6,pe(e,t.request);case 6:r.t0=r.sent;case 7:t.request=r.t0;case 8:case"end":return r.stop()}},r)}))}},{key:"getOptions",value:function(e){var t;return e.middlewareControl instanceof ue&&(t=e.middlewareControl.getMiddlewareOptions(be)),void 0===t&&(t=Object.assign(new be,this.options)),t}},{key:"executeWithRedirect",value:function(t,r,n){return ie(this,void 0,void 0,regeneratorRuntime.mark(function a(){var i,o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,this.nextMiddleware.execute(t);case 3:if(i=t.response,!(r<n.maxRedirects&&this.isRedirect(i)&&this.hasLocationHeader(i)&&n.shouldRedirect(i))){a.next=19;break}if(++r,i.status!==e.STATUS_CODE_SEE_OTHER){a.next=11;break}t.options.method=ae.GET,delete t.options.body,a.next=15;break;case 11:return o=this.getLocationHeader(i),!this.isRelativeURL(o)&&this.shouldDropAuthorizationHeader(i.url,o)&&le(t.request,t.options,e.AUTHORIZATION_HEADER,void 0),a.next=15,this.updateRequestUrl(o,t);case 15:return a.next=17,this.executeWithRedirect(t,r,n);case 17:a.next=20;break;case 19:return a.abrupt("return");case 20:a.next=25;break;case 22:throw a.prev=22,a.t0=a.catch(0),a.t0;case 25:case"end":return a.stop()}},a,this,[[0,22]])}))}},{key:"execute",value:function(t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,0,n=this.getOptions(t),t.options.redirect=e.MANUAL_REDIRECT,ve.updateFeatureUsageFlag(t,se.REDIRECT_HANDLER_ENABLED),r.next=7,this.executeWithRedirect(t,0,n);case 7:return r.abrupt("return",r.sent);case 10:throw r.prev=10,r.t0=r.catch(0),r.t0;case 13:case"end":return r.stop()}},r,this,[[0,10]])}))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();ke.REDIRECT_STATUS_CODES=[301,302,303,307,308],ke.STATUS_CODE_SEE_OTHER=303,ke.LOCATION_HEADER="Location",ke.AUTHORIZATION_HEADER="Authorization",ke.MANUAL_REDIRECT="manual";var xe=function(){function e(){p(this,e)}return l(e,[{key:"execute",value:function(t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n,a,i,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,null===(n=de(t.request,t.options,e.CLIENT_REQUEST_ID_HEADER))&&(n=ce(),le(t.request,t.options,e.CLIENT_REQUEST_ID_HEADER,n)),a="".concat(e.PRODUCT_NAME,"/").concat("2.0.0"),t.middlewareControl instanceof ue&&(i=t.middlewareControl.getMiddlewareOptions(ve)),void 0!==i&&(o=i.getFeatureUsage(),a+=" (".concat(e.FEATURE_USAGE_STRING,"=").concat(o,")")),he(t.request,t.options,e.SDK_VERSION_HEADER,a),r.next=9,this.nextMiddleware.execute(t);case 9:return r.abrupt("return",r.sent);case 12:throw r.prev=12,r.t0=r.catch(0),r.t0;case 15:case"end":return r.stop()}},r,this,[[0,12]])}))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}();xe.CLIENT_REQUEST_ID_HEADER="client-request-id",xe.SDK_VERSION_HEADER="SdkVersion",xe.PRODUCT_NAME="graph-js",xe.FEATURE_USAGE_STRING="featureUsage";var Re,_e,Ee,Ce,Se="v1.0",Te="https://graph.microsoft.com/",Pe=function(){function e(t){p(this,e),this.provider=t}return l(e,[{key:"getAccessToken",value:function(){return ie(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){t.provider(function(t,n){n?e(n):r(t)})}));case 1:case"end":return e.stop()}},e)}))}}]),e}(),Ae=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;p(this,e),this.statusCode=t,this.code=null,this.message=null,this.requestId=null,this.date=new Date,this.body=null},Oe=function(){function e(){p(this,e)}return l(e,null,[{key:"constructError",value:function(e,t){var r=new Ae(t);return void 0!==e.name&&(r.code=e.name),r.body=e.toString(),r.message=e.message,r.date=new Date,r}},{key:"constructErrorFromResponse",value:function(e,t){e=e.error;var r=new Ae(t);r.code=e.code,r.message=e.message,void 0!==e.innerError&&(r.requestId=e.innerError["request-id"],r.date=new Date(e.innerError.date));try{r.body=JSON.stringify(e)}catch(e){}return r}},{key:"getError",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0;return ie(this,void 0,void 0,regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(i=t&&t.error?e.constructErrorFromResponse(t,r):"undefined"!=typeof Error&&t instanceof Error?e.constructError(t,r):new Ae(r),"function"!=typeof n){a.next=5;break}n(i,null),a.next=6;break;case 5:return a.abrupt("return",i);case 6:case"end":return a.stop()}},a)}))}}]),e}(),De=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],Ne=function(e){var t=e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e};!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(Re||(Re={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(_e||(_e={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(Ee||(Ee={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(Ce||(Ce={}));var Ie=function(){function e(){p(this,e)}return l(e,null,[{key:"parseDocumentResponse",value:function(e,t){try{return"undefined"!=typeof DOMParser?new Promise(function(r,n){e.text().then(function(e){try{var a=(new DOMParser).parseFromString(e,t);r(a)}catch(e){n(e)}})}):Promise.resolve(e.body)}catch(e){throw e}}},{key:"convertResponse",value:function(t,r){return ie(this,void 0,void 0,regeneratorRuntime.mark(function n(){var a,i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(204!==t.status){n.next=2;break}return n.abrupt("return",Promise.resolve());case 2:n.prev=2,n.t0=r,n.next=n.t0===Re.ARRAYBUFFER?6:n.t0===Re.BLOB?10:n.t0===Re.DOCUMENT?14:n.t0===Re.JSON?18:n.t0===Re.STREAM?22:n.t0===Re.TEXT?26:30;break;case 6:return n.next=8,t.arrayBuffer();case 8:return a=n.sent,n.abrupt("break",60);case 10:return n.next=12,t.blob();case 12:return a=n.sent,n.abrupt("break",60);case 14:return n.next=16,e.parseDocumentResponse(t,_e.TEXT_XML);case 16:return a=n.sent,n.abrupt("break",60);case 18:return n.next=20,t.json();case 20:return a=n.sent,n.abrupt("break",60);case 22:return n.next=24,Promise.resolve(t.body);case 24:return a=n.sent,n.abrupt("break",60);case 26:return n.next=28,t.text();case 28:return a=n.sent,n.abrupt("break",60);case 30:if(null===(i=t.headers.get("Content-type"))){n.next=58;break}if(o=i.split(";")[0],!new RegExp(Ce.DOCUMENT).test(o)){n.next=39;break}return n.next=36,e.parseDocumentResponse(t,o);case 36:a=n.sent,n.next=56;break;case 39:if(!new RegExp(Ce.IMAGE).test(o)){n.next=43;break}a=t.blob(),n.next=56;break;case 43:if(o!==Ee.TEXT_PLAIN){n.next=49;break}return n.next=46,t.text();case 46:a=n.sent,n.next=56;break;case 49:if(o!==Ee.APPLICATION_JSON){n.next=55;break}return n.next=52,t.json();case 52:a=n.sent,n.next=56;break;case 55:a=Promise.resolve(t.body);case 56:n.next=59;break;case 58:a=Promise.resolve(t.body);case 59:return n.abrupt("break",60);case 60:n.next=65;break;case 62:throw n.prev=62,n.t1=n.catch(2),n.t1;case 65:return n.abrupt("return",a);case 66:case"end":return n.stop()}},n,null,[[2,62]])}))}},{key:"getResponse",value:function(t,r,n){return ie(this,void 0,void 0,regeneratorRuntime.mark(function a(){var i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,r!==Re.RAW){a.next=5;break}return a.abrupt("return",Promise.resolve(t));case 5:return a.next=7,e.convertResponse(t,r);case 7:if(i=a.sent,!t.ok){a.next=16;break}if("function"!=typeof n){a.next=13;break}n(null,i),a.next=14;break;case 13:return a.abrupt("return",i);case 14:a.next=17;break;case 16:throw i;case 17:a.next=22;break;case 19:throw a.prev=19,a.t0=a.catch(0),a.t0;case 22:case"end":return a.stop()}},a,null,[[0,19]])}))}}]),e}(),Ue=function(){function e(t,r,n){var a=this;p(this,e),this.parsePath=function(e){if(-1!==e.indexOf("https://")){var t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(a.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));var r=e.indexOf("/");-1!==r&&(a.urlComponents.version=e.substring(0,r),e=e.substring(r+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));var n=e.indexOf("?");if(-1===n)a.urlComponents.path=e;else{a.urlComponents.path=e.substr(0,n);var i=e.substring(n+1,e.length).split("&"),o=!0,s=!1,u=void 0;try{for(var c,d=i[Symbol.iterator]();!(o=(c=d.next()).done);o=!0){var l=c.value.split("="),h=l[0],p=l[1];-1!==De.indexOf(h)?a.urlComponents.oDataQueryParams[h]=p:a.urlComponents.otherURLQueryParams[h]=p}}catch(e){s=!0,u=e}finally{try{o||null==d.return||d.return()}finally{if(s)throw u}}}},this.httpClient=t,this.config=r,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{}},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(n)}return l(e,[{key:"addCsvQueryParameter",value:function(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";var n=[];r.length>1&&"string"==typeof t?n=Array.prototype.slice.call(r):"string"==typeof t?n.push(t):n=n.concat(t),this.urlComponents.oDataQueryParams[e]+=n.join(",")}},{key:"buildFullUrl",value:function(){var e,t,r=(e=[this.urlComponents.host,this.urlComponents.version,this.urlComponents.path],t=function(e){return e.replace(/^\/+/,"")},Array.prototype.slice.call(e).reduce(function(e,r){return[(n=e,n.replace(/\/+$/,"")),t(r)].join("/");var n})+this.createQueryString());return this.config.debugLogging&&console.log(r),r}},{key:"createQueryString",value:function(){var e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(var r in e.oDataQueryParams)e.oDataQueryParams.hasOwnProperty(r)&&t.push(r+"="+e.oDataQueryParams[r]);if(0!==Object.keys(e.otherURLQueryParams).length)for(var n in e.otherURLQueryParams)e.otherURLQueryParams.hasOwnProperty(n)&&t.push(n+"="+e.otherURLQueryParams[n]);return t.length>0?"?"+t.join("&"):""}},{key:"updateRequestOptions",value:function(e){var t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){var n=Object.assign({},this.config.fetchOptions);Object.assign(e,n),void 0!==r(this.config.fetchOptions.headers)&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}},{key:"send",value:function(e,t,r){return ie(this,void 0,void 0,regeneratorRuntime.mark(function n(){var a,i,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=new ue(this._middlewareOptions),this.updateRequestOptions(t),n.prev=2,n.next=5,this.httpClient.sendRequest({request:e,options:t,middlewareControl:i});case 5:return o=n.sent,a=o.response,n.next=9,Ie.getResponse(a,this._responseType,r);case 9:return s=n.sent,n.abrupt("return",s);case 13:return n.prev=13,n.t0=n.catch(2),void 0!==a&&(u=a.status),n.next=18,Oe.getError(n.t0,u,r);case 18:throw n.sent;case 20:case"end":return n.stop()}},n,this,[[2,13]])}))}},{key:"header",value:function(e,t){return this._headers[e]=t,this}},{key:"headers",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this._headers[t]=e[t]);return this}},{key:"option",value:function(e,t){return this._options[e]=t,this}},{key:"options",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(this._options[t]=e[t]);return this}},{key:"middlewareOptions",value:function(e){return this._middlewareOptions=e,this}},{key:"version",value:function(e){return this.urlComponents.version=e,this}},{key:"responseType",value:function(e){return this._responseType=e,this}},{key:"select",value:function(e){return this.addCsvQueryParameter("$select",e,arguments),this}},{key:"expand",value:function(e){return this.addCsvQueryParameter("$expand",e,arguments),this}},{key:"orderby",value:function(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}},{key:"filter",value:function(e){return this.urlComponents.oDataQueryParams.$filter=e,this}},{key:"search",value:function(e){return this.urlComponents.oDataQueryParams.$search=e,this}},{key:"top",value:function(e){return this.urlComponents.oDataQueryParams.$top=e,this}},{key:"skip",value:function(e){return this.urlComponents.oDataQueryParams.$skip=e,this}},{key:"skipToken",value:function(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}},{key:"count",value:function(e){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}},{key:"query",value:function(e){var t=this.urlComponents.otherURLQueryParams;if("string"==typeof e){var r=e.split("="),n=r[0],a=r[1];t[n]=a}else for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return this}},{key:"get",value:function(e){return ie(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.buildFullUrl(),n={method:ae.GET},t.prev=2,t.next=5,this.send(r,n,e);case 5:return a=t.sent,t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(2),t.t0;case 12:case"end":return t.stop()}},t,this,[[2,9]])}))}},{key:"post",value:function(e,t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n,a,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),a={method:ae.POST,body:Ne(e),headers:"undefined"!=typeof FormData&&e instanceof FormData?{}:{"Content-Type":"application/json"}},r.prev=2,r.next=5,this.send(n,a,t);case 5:return i=r.sent,r.abrupt("return",i);case 9:throw r.prev=9,r.t0=r.catch(2),r.t0;case 12:case"end":return r.stop()}},r,this,[[2,9]])}))}},{key:"create",value:function(e,t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.post(e,t);case 3:return r.abrupt("return",r.sent);case 6:throw r.prev=6,r.t0=r.catch(0),r.t0;case 9:case"end":return r.stop()}},r,this,[[0,6]])}))}},{key:"put",value:function(e,t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n,a,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),a={method:ae.PUT,body:Ne(e),headers:{"Content-Type":"application/json"}},r.prev=2,r.next=5,this.send(n,a,t);case 5:return i=r.sent,r.abrupt("return",i);case 9:throw r.prev=9,r.t0=r.catch(2),r.t0;case 12:case"end":return r.stop()}},r,this,[[2,9]])}))}},{key:"patch",value:function(e,t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n,a,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),a={method:ae.PATCH,body:Ne(e),headers:{"Content-Type":"application/json"}},r.prev=2,r.next=5,this.send(n,a,t);case 5:return i=r.sent,r.abrupt("return",i);case 9:throw r.prev=9,r.t0=r.catch(2),r.t0;case 12:case"end":return r.stop()}},r,this,[[2,9]])}))}},{key:"update",value:function(e,t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.patch(e,t);case 3:return r.abrupt("return",r.sent);case 6:throw r.prev=6,r.t0=r.catch(0),r.t0;case 9:case"end":return r.stop()}},r,this,[[0,6]])}))}},{key:"delete",value:function(e){return ie(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.buildFullUrl(),n={method:ae.DELETE},t.prev=2,t.next=5,this.send(r,n,e);case 5:return a=t.sent,t.abrupt("return",a);case 9:throw t.prev=9,t.t0=t.catch(2),t.t0;case 12:case"end":return t.stop()}},t,this,[[2,9]])}))}},{key:"del",value:function(e){return ie(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.delete(e);case 3:return t.abrupt("return",t.sent);case 6:throw t.prev=6,t.t0=t.catch(0),t.t0;case 9:case"end":return t.stop()}},t,this,[[0,6]])}))}},{key:"getStream",value:function(e){return ie(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.buildFullUrl(),n={method:ae.GET},this.responseType(Re.STREAM),t.prev=3,t.next=6,this.send(r,n,e);case 6:return a=t.sent,t.abrupt("return",a);case 10:throw t.prev=10,t.t0=t.catch(3),t.t0;case 13:case"end":return t.stop()}},t,this,[[3,10]])}))}},{key:"putStream",value:function(e,t){return ie(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n,a,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=this.buildFullUrl(),a={method:ae.PUT,headers:{"Content-Type":"application/octet-stream"},body:e},r.prev=2,r.next=5,this.send(n,a,t);case 5:return i=r.sent,r.abrupt("return",i);case 9:throw r.prev=9,r.t0=r.catch(2),r.t0;case 12:case"end":return r.stop()}},r,this,[[2,9]])}))}}]),e}(),Me=function(){function e(t){p(this,e),this.middleware=t}return l(e,[{key:"sendRequest",value:function(e){return ie(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"string"!=typeof e.request||void 0!==e.options){t.next=6;break}throw(r=new Error).name="InvalidRequestOptions",r.message="Unable to execute the middleware, Please provide valid options for a request",r;case 6:return t.next=8,this.middleware.execute(e);case 8:return t.abrupt("return",e);case 11:throw t.prev=11,t.t0=t.catch(0),t.t0;case 14:case"end":return t.stop()}},t,this,[[0,11]])}))}}]),e}(),Le=function(){function e(){p(this,e)}return l(e,null,[{key:"createWithAuthenticationProvider",value:function(t){var r=new me(t),n=new we(new ye),a=new xe,i=new ge;if(r.setNext(n),new Function("try {return this === global;}catch(e){return false;}")()){var o=new ke(new be);n.setNext(o),o.setNext(a)}else n.setNext(a);return a.setNext(i),e.createWithMiddleware(r)}},{key:"createWithMiddleware",value:function(e){return new Me(e)}}]),e}(),qe=function(){if("undefined"==typeof Promise&&"undefined"==typeof fetch){var e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){var t=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw t.name="PolyFillNotAvailable",t}if("undefined"==typeof fetch){var r=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}return!0},Fe=e("C",function(){function e(t){p(this,e),this.config={baseUrl:Te,debugLogging:!1,defaultVersion:Se};try{qe()}catch(a){throw a}for(var r in t)t.hasOwnProperty(r)&&(this.config[r]=t[r]);var n;if(void 0!==t.authProvider&&void 0!==t.middleware){var a=new Error;throw a.name="AmbiguityInInitialization",a.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",a}if(void 0!==t.authProvider)n=Le.createWithAuthenticationProvider(t.authProvider);else{if(void 0===t.middleware){var i=new Error;throw i.name="InvalidMiddlewareChain",i.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",i}n=new Me(t.middleware)}this.httpClient=n}return l(e,[{key:"api",value:function(e){return new Ue(this.httpClient,this.config,e)}}],[{key:"init",value:function(t){var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]="authProvider"===n?new Pe(t[n]):t[n]);return e.initWithMiddleware(r)}},{key:"initWithMiddleware",value:function(t){try{return new e(t)}catch(e){throw e}}}]),e}());function He(e){var t=e,r=e,n=e;return r.mail?r.mail:t.scoredEmailAddresses&&t.scoredEmailAddresses.length?t.scoredEmailAddresses[0].address:n.emailAddresses&&n.emailAddresses.length?n.emailAddresses[0].address:null}function je(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return[new fe(void 0,{scopes:t})]}function ze(e){switch(e){case 0:return"January";case 1:return"February";case 2:return"March";case 3:return"April";case 4:return"May";case 5:return"June";case 6:return"July";case 7:return"August";case 8:return"September";case 9:return"October";case 10:return"November";case 11:return"December";default:return"Month"}}function Be(e,t){return function e(t,r,n){var a=Object.prototype.toString.call(t);var i=Object.prototype.toString.call(r);if(a===i&&"[object Object]"===a&&!n.has(t)){for(var o in n.add(t),t)if(!e(t[o],r[o],n))return!1;for(var s in r)if(!t.hasOwnProperty(s))return!1;return!0}if(a===i&&"[object Array]"===a&&!n.has(t)){if(n.add(t),t.length!==r.length)return!1;for(var u=0;u<t.length;u++)if(!e(t[u],r[u],n))return!1;return!0}return t===r}(e,t,new Set)}var Xe=new WeakMap,Qe=e("k",b(function(e){return function(t){if(!(t instanceof k)||t instanceof x||"class"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");var r=t.committer,n=r.element;Xe.has(t)||(n.className=r.strings.join(" "));var a=n.classList,i=Xe.get(t);for(var o in i)o in e||a.remove(o);for(var s in e){var u=e[s];if(!i||u!==i[s])a[u?"add":"remove"](s)}Xe.set(t,e)}})),We=e("f",function(e){function t(){var e;return p(this,t),(e=f(this,v(t).call(this))).isShadowRootDisabled()&&(e._needsShimAdoptedStyleSheets=!0),e}return d(t,Y),l(t,[{key:"isShadowRootDisabled",value:function(){return!t._useShadowRoot||!this.constructor._useShadowRoot}},{key:"fireCustomEvent",value:function(e,t){var r=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:t});return this.dispatchEvent(r)}},{key:"createRenderRoot",value:function(){return this.isShadowRootDisabled()?this:g(v(t.prototype),"createRenderRoot",this).call(this)}}],[{key:"useShadowRoot",get:function(){return this._useShadowRoot},set:function(e){this._useShadowRoot=e}}]),t}());We._useShadowRoot=!0;var $e=function(){function e(){p(this,e)}return l(e,null,[{key:"renderTemplate",value:function(e,t,r){if(e.$parentTemplateContext&&(t=Object.assign(Object.assign({},t),{$parent:e.$parentTemplateContext})),e.content&&e.content.childNodes.length){var n=e.content.cloneNode(!0);return this.renderNode(n,t,r)}if(e.childNodes.length){for(var a=document.createElement("div"),i=0;i<e.childNodes.length;i++)a.appendChild(e.childNodes[i].cloneNode(!0));return this.renderNode(a,t,r)}}},{key:"getValueFromObject",value:function(e,t){if("this"===(t=t.trim()))return e;for(var r=t.split("."),n=e,a=0;a<r.length;a++){if(!(n=n[r[a]]))return null}return n}},{key:"replaceExpression",value:function(e,t,n){var a=this;return e.replace(this._converterExpression,function(e){return n?a.evalInContext(e.substring(3,e.length-3).trim(),Object.assign(Object.assign({},n),t)):""}).replace(this._expression,function(e){var n=e.substring(2,e.length-2),i=a.getValueFromObject(t,n);return i?"object"===r(i)?JSON.stringify(i):i.toString():""})}},{key:"renderNode",value:function(e,t,r){if("#text"===e.nodeName)return e.textContent=this.replaceExpression(e.textContent,t,r),e;if("TEMPLATE"===e.nodeName)return e.$parentTemplateContext=t,e;var n=e;if(n.attributes)for(var a=0;a<n.attributes.length;a++){var i=n.attributes[a];n.setAttribute(i.name,this.replaceExpression(i.value,t,r))}for(var o=[],s=[],u=!1,c=0;c<e.childNodes.length;c++){var d=e.childNodes[c],l=d,h=!1;if(l.dataset){var p=!1;if(l.dataset.if){var f=l.dataset.if;this.evalBoolInContext(f,t)?(l.removeAttribute("data-if"),u=!0,h=!0):(s.push(l),p=!0)}else void 0!==l.dataset.else&&(u?(s.push(l),p=!0):l.removeAttribute("data-else"));l.dataset.for&&!p?o.push(l):p||this.renderNode(d,t,r)}else this.renderNode(d,t,r);h||"#text"===d.nodeName||(u=!1)}for(var v=0,m=s;v<m.length;v++){var g=m[v];n.removeChild(g)}for(var y=0;y<o.length;y++){var w=o[y],b=w.dataset.for.split(" ");if(b.length>1){var k=b[0],x=b[b.length-1],R=this.getValueFromObject(t,x);if(Array.isArray(R)){w.removeAttribute("data-for");for(var _=0;_<R.length;_++){var E=Object.assign({$index:_},t);E[k]=R[_];var C=w.cloneNode(!0);this.renderNode(C,E,r),n.insertBefore(C,w)}n.removeChild(w)}}}return e}},{key:"evalBoolInContext",value:function(e,t){return new Function("with(this) { return !!("+e+")}").call(t)}},{key:"evalInContext",value:function(e,t){var r,n=new Function("with(this) { return "+e+";}");try{r=n.call(t)}catch(e){}return r}}]),e}();function Ge(){var e=_([' <slot name="','"></slot> ']);return Ge=function(){return e},e}$e._expression=/{{\s*([$\w]+)(\.[$\w]+)*\s*}}/g,$e._converterExpression=/{{{\s*[$\w\.()]+\s*}}}/g;var Ve,Ye=e("M",function(e){function t(){var e;return p(this,t),(e=f(this,v(t).call(this))).templateConverters={},e.templates={},e._renderedSlots=!1,e._renderedTemplates={},e._slotNamesAddedDuringRender=[],e.templateConverters.lower=function(e){return e.toLowerCase()},e.templateConverters.upper=function(e){return e.toUpperCase()},e}return d(t,We),l(t,[{key:"update",value:function(e){this.templates=this.getTemplates(),this._slotNamesAddedDuringRender=[],g(v(t.prototype),"update",this).call(this,e)}},{key:"updated",value:function(e){g(v(t.prototype),"updated",this).call(this,e),this.removeUnusedSlottedElements()}},{key:"renderTemplate",value:function(e,t,r){if(!this.templates[e])return null;r=r||e,this._slotNamesAddedDuringRender.push(r),this._renderedSlots=!0;var n=R(Ge(),r);if(this._renderedTemplates.hasOwnProperty(r)){var a=this._renderedTemplates[r],i=a.context,o=a.slot;if(Be(i,t))return n;this.removeChild(o)}var s=$e.renderTemplate(this.templates[e],t,this.templateConverters),u=document.createElement("div");return u.slot=r,u.dataset.generated="template",s&&u.appendChild(s),this.appendChild(u),this._renderedTemplates[r]={context:t,slot:u},this.fireCustomEvent("templateRendered",{templateType:e,context:t,element:u}),n}},{key:"getTemplates",value:function(){for(var e={},t=0;t<this.children.length;t++){var r=this.children[t];if("TEMPLATE"===r.nodeName){var n=r;n.dataset.type?e[n.dataset.type]=n:e.default=n}}return e}},{key:"removeUnusedSlottedElements",value:function(){if(this._renderedSlots){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.dataset&&t.dataset.generated&&!this._slotNamesAddedDuringRender.includes(t.slot)&&(this.removeChild(t),delete this._renderedTemplates[t.slot],e--)}this._renderedSlots=!1}}}]),t}());function Je(){var e=_([':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\E70D"}.ms-Icon--ChevronUp::before{content:"\\E70E"}.ms-Icon--Contact::before{content:"\\E77B"}.ms-Icon--AddFriend::before{content:"\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\EB6D"}:host{display:inherit}:host .root{display:inline-block;color:var(--color,#201f1e);position:relative;vertical-align:top}:host svg,mgt-person svg{width:var(--avatar-size-s,24px);height:var(--avatar-size-s,24px)}:host img,mgt-person img{border:var(--avatar-border);border-radius:50%}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;font-family:var(--default-font-family, "Segoe UI")}:host .Details,mgt-person .Details{flex:1 1 auto;display:flex;flex-direction:column;margin-left:12px}:host .Details.small,mgt-person .Details.small{margin-left:6px}:host .user-avatar,mgt-person .user-avatar{width:var(--avatar-size,48px);height:var(--avatar-size,48px);display:flex;justify-content:center;align-items:center}:host .user-avatar.initials,mgt-person .user-avatar.initials{color:var(--initials-color,#fff);background-color:var(--initials-background-color,#b4009e);border-radius:50%;font-weight:400;font-size:60%}:host .user-avatar.small,mgt-person .user-avatar.small{width:var(--avatar-size-s,24px);height:var(--avatar-size-s,24px)}:host .user-avatar.row-span-2,mgt-person .user-avatar.row-span-2{width:var(--avatar-size,48px);height:var(--avatar-size,48px)}:host .user-avatar img,mgt-person .user-avatar img{height:100%}:host .avatar-icon,mgt-person .avatar-icon{flex:1 1 auto;line-height:1;margin:0;font-size:var(--avatar-size,48px)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,24px)}:host .avatar-icon.row-span-2,mgt-person .avatar-icon.row-span-2{grid-row:1/3;-ms-grid-row:1;-ms-grid-row-span:2}:host .avatar-icon.row-span-3,mgt-person .avatar-icon.row-span-3{grid-row:1/4;-ms-grid-row:1;-ms-grid-row-span:3}:host .user-name,mgt-person .user-name{font-size:var(--font-size,14px);font-weight:var(--font-weight,600);white-space:nowrap;grid-column:2;-ms-grid-column:2}:host .user-email,mgt-person .user-email{color:var(--email-color,#323130);font-size:var(--email-font-size,12px);white-space:nowrap;grid-column:2;-ms-grid-column:2;grid-row:2;-ms-grid-row:2}.root .flyout{display:none;position:absolute;z-index:1;opacity:0;transition-property:opacity;transition-duration:.1s;padding:8px}.root .flyout.visible{display:inline-block;opacity:1}.root .flyout.visible.openLeft{right:0}'],[':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\\\\E70E"}.ms-Icon--Contact::before{content:"\\\\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\\\\EB6D"}:host{display:inherit}:host .root{display:inline-block;color:var(--color,#201f1e);position:relative;vertical-align:top}:host svg,mgt-person svg{width:var(--avatar-size-s,24px);height:var(--avatar-size-s,24px)}:host img,mgt-person img{border:var(--avatar-border);border-radius:50%}:host .person-root,mgt-person .person-root{position:relative;display:flex;align-items:center;font-family:var(--default-font-family, "Segoe UI")}:host .Details,mgt-person .Details{flex:1 1 auto;display:flex;flex-direction:column;margin-left:12px}:host .Details.small,mgt-person .Details.small{margin-left:6px}:host .user-avatar,mgt-person .user-avatar{width:var(--avatar-size,48px);height:var(--avatar-size,48px);display:flex;justify-content:center;align-items:center}:host .user-avatar.initials,mgt-person .user-avatar.initials{color:var(--initials-color,#fff);background-color:var(--initials-background-color,#b4009e);border-radius:50%;font-weight:400;font-size:60%}:host .user-avatar.small,mgt-person .user-avatar.small{width:var(--avatar-size-s,24px);height:var(--avatar-size-s,24px)}:host .user-avatar.row-span-2,mgt-person .user-avatar.row-span-2{width:var(--avatar-size,48px);height:var(--avatar-size,48px)}:host .user-avatar img,mgt-person .user-avatar img{height:100%}:host .avatar-icon,mgt-person .avatar-icon{flex:1 1 auto;line-height:1;margin:0;font-size:var(--avatar-size,48px)}:host .avatar-icon.small,mgt-person .avatar-icon.small{font-size:var(--avatar-size-s,24px)}:host .avatar-icon.row-span-2,mgt-person .avatar-icon.row-span-2{grid-row:1/3;-ms-grid-row:1;-ms-grid-row-span:2}:host .avatar-icon.row-span-3,mgt-person .avatar-icon.row-span-3{grid-row:1/4;-ms-grid-row:1;-ms-grid-row-span:3}:host .user-name,mgt-person .user-name{font-size:var(--font-size,14px);font-weight:var(--font-weight,600);white-space:nowrap;grid-column:2;-ms-grid-column:2}:host .user-email,mgt-person .user-email{color:var(--email-color,#323130);font-size:var(--email-font-size,12px);white-space:nowrap;grid-column:2;-ms-grid-column:2;grid-row:2;-ms-grid-row:2}.root .flyout{display:none;position:absolute;z-index:1;opacity:0;transition-property:opacity;transition-duration:.1s;padding:8px}.root .flyout.visible{display:inline-block;opacity:1}.root .flyout.visible.openLeft{right:0}']);return Je=function(){return e},e}!function(e){e[e.none=0]="none",e[e.hover=1]="hover",e[e.click=2]="click"}(Ve||(Ve=e("h",{})));var Ze=[G(Je())];function Ke(){var e=_([" "," "," "]);return Ke=function(){return e},e}function et(){var e=_([' <div class="user-email" aria-label="','">',"</div> "]);return et=function(){return e},e}function tt(){var e=_([' <div class="user-name" aria-label="','">',"</div> "]);return tt=function(){return e},e}function rt(){var e=_([' <i class="','"></i> ']);return rt=function(){return e},e}function nt(){var e=_([' <div class="','" title="','" aria-label="','"> '," </div> "]);return nt=function(){return e},e}function at(){var e=_([' <span class="initials-text" aria-label="','"> '," </span> "]);return at=function(){return e},e}function it(){var e=_([' <img alt="','" src="','"> ']);return it=function(){return e},e}function ot(){var e=_([' <span class="','"> '," </span> "]);return ot=function(){return e},e}function st(){var e=_([' <mgt-person-card .personDetails="','" .personImage="','"> </mgt-person-card> ']);return st=function(){return e},e}function ut(){var e=_([' <div style="','" class="','"> '," </div> "]);return ut=function(){return e},e}function ct(){var e=_([' <div class="root" @mouseenter="','" @mouseleave="','" @click="','"> '," "," </div> "]);return ct=function(){return e},e}function dt(){var e=_([' <div class="person-root"> '," "," </div> "]);return dt=function(){return e},e}var lt=function(e,t,n,a){var i,o=arguments.length,s=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":r(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ht=function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,s)}u((n=n.apply(e,t||[])).next())})},pt=function(e){function t(){var e;return p(this,t),(e=f(this,v(t).apply(this,arguments))).personCardInteraction=Ve.none,e._isPersonCardVisible=!1,e._personCardShouldRender=!1,e._openLeft=!1,e._openUp=!1,e}return d(t,Ye),l(t,[{key:"attributeChangedCallback",value:function(e,r,n){g(v(t.prototype),"attributeChangedCallback",this).call(this,e,r,n),"person-query"!==e&&"user-id"!==e||r===n||(this.personDetails=null,this.loadData())}},{key:"firstUpdated",value:function(){var e=this;K.onProviderUpdated(function(){return e.loadData()}),this.loadData()}},{key:"render",value:function(){var e=this.renderTemplate("default",{person:this.personDetails,personImage:this.getImage()})||R(dt(),this.renderImage(),this.renderDetails());return R(ct(),this._handleMouseEnter,this._handleMouseLeave,this._handleMouseClick,e,this.renderPersonCard())}},{key:"updated",value:function(e){g(v(t.prototype),"updated",this).call(this,e);var r=this.renderRoot.querySelector(".initials-text");if(r&&r.parentNode&&r.parentNode.getBoundingClientRect){var n=r.parentNode.getBoundingClientRect().height;r.style.fontSize="".concat(.5*n,"px")}}},{key:"loadData",value:function(){return ht(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,n,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=K.globalProvider)&&t.state!==te.Loading){e.next=3;break}return e.abrupt("return");case 3:if(t.state!==te.SignedOut){e.next=6;break}return this.personDetails=null,e.abrupt("return");case 6:if(!this.personDetails){e.next=9;break}return this.personImage&&"@"===this.personImage&&!this.personDetails.personImage&&this.loadImage(),e.abrupt("return");case 9:if(!(this.userId||this.personQuery&&"me"===this.personQuery)){e.next=19;break}return r=t.graph.createBatch(),this.userId?(r.get("user","/users/".concat(this.userId),["user.readbasic.all"]),r.get("photo","users/".concat(this.userId,"/photo/$value"),["user.readbasic.all"])):(r.get("user","me",["user.read"]),r.get("photo","me/photo/$value",["user.read"])),e.next=14,r.execute();case 14:n=e.sent,this.personDetails=n.user,this.personDetails.personImage=n.photo,e.next=24;break;case 19:if(this.personDetails||!this.personQuery){e.next=24;break}return e.next=22,t.graph.findPerson(this.personQuery);case 22:(a=e.sent)&&a.length>0&&(i=a[0],this.personDetails=i,this.loadImage());case 24:case"end":return e.stop()}},e,this)}))}},{key:"loadImage",value:function(){return ht(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,n,a,i,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=K.globalProvider,!(r=this.personDetails).userPrincipalName){e.next=9;break}return a=r.userPrincipalName,e.next=6,t.graph.getUserPhoto(a);case 6:n=e.sent,e.next=25;break;case 9:if(!(i=He(r))){e.next=25;break}return e.next=13,t.graph.findUserByEmail(i);case 13:if(!(o=e.sent)||!o.length){e.next=25;break}if(!o[0].personType||"OrganizationUser"!==o[0].personType.subclass){e.next=21;break}return e.next=18,t.graph.getUserPhoto(o[0].scoredEmailAddresses[0].address);case 18:n=e.sent,e.next=25;break;case 21:return s=o[0].id,e.next=24,t.graph.getContactPhoto(s);case 24:n=e.sent;case 25:n&&(this.personDetails.personImage=n),this.requestUpdate();case 27:case"end":return e.stop()}},e,this)}))}},{key:"_handleMouseClick",value:function(){this.personCardInteraction!==Ve.click||this._isPersonCardVisible?this._hidePersonCard():this._showPersonCard()}},{key:"_handleMouseEnter",value:function(e){this.personCardInteraction===Ve.hover&&(clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseEnterTimeout=setTimeout(this._showPersonCard.bind(this),500))}},{key:"_handleMouseLeave",value:function(e){clearTimeout(this._mouseEnterTimeout),clearTimeout(this._mouseLeaveTimeout),this._mouseLeaveTimeout=setTimeout(this._hidePersonCard.bind(this),500)}},{key:"_showPersonCard",value:function(){this._personCardShouldRender||(this._personCardShouldRender=!0),this._isPersonCardVisible=!0}},{key:"_hidePersonCard",value:function(){this._isPersonCardVisible=!1;var e=this.querySelector("mgt-person-card");e&&(e.isExpanded=!1)}},{key:"getImage",value:function(){return this.personImage&&"@"!==this.personImage?this.personImage:this.personDetails&&this.personDetails.personImage?this.personDetails.personImage:null}},{key:"renderPersonCard",value:function(){if(this.personCardInteraction!==Ve.none&&this._personCardShouldRender){var e=this.renderRoot.querySelector(".root").getBoundingClientRect(),t=e.left,r=(window.innerWidth||document.documentElement.clientWidth)-e.right;this._openLeft=r<t;var n=(window.innerHeight||document.documentElement.clientHeight)-e.bottom;this._openUp=n<175;var a=null;if(this._openUp){var i=this.getBoundingClientRect().bottom-this.getBoundingClientRect().top;a="bottom: ".concat(i/2+8,"px")}var o={flyout:!0,openLeft:this._openLeft,openUp:this._openUp,visible:this._isPersonCardVisible};if(this._isPersonCardVisible){var s=this.getImage();return R(ut(),a,Qe(o),this.renderTemplate("person-card",{person:this.personDetails,personImage:s})||R(st(),this.personDetails,s))}}}},{key:"renderDetails",value:function(){if(this.showEmail||this.showName){var e={Details:!0,small:!(this.showEmail&&this.showName)};return R(ot(),Qe(e),this.renderNameAndEmail())}return null}},{key:"renderImage",value:function(){if(this.personDetails){var e,t=this.personCardInteraction===Ve.none?this.personDetails.displayName:"",r=this.getImage(),n=this.showEmail&&this.showName,a={initials:!r,"row-span-2":n,small:!n,"user-avatar":!0};if(r)e=R(it(),t,r);else{var i=this.getInitials();e=R(at(),i,i)}return R(nt(),Qe(a),t,t,e)}return this.renderEmptyImage()}},{key:"renderEmptyImage",value:function(){var e=this.showEmail&&this.showName,t={"avatar-icon":!0,"ms-Icon":!0,"ms-Icon--Contact":!0,"row-span-2":e,small:!e};return R(rt(),Qe(t))}},{key:"renderNameAndEmail",value:function(){if(this.personDetails&&(this.showEmail||this.showName)){var e,t=this.showName?R(tt(),this.personDetails.displayName,this.personDetails.displayName):null;if(this.showEmail){var r=He(this.personDetails);e=R(et(),r,r)}return R(Ke(),t,e)}}},{key:"getInitials",value:function(){if(!this.personDetails)return"";var e="";if(this.personDetails.givenName&&(e+=this.personDetails.givenName[0].toUpperCase()),this.personDetails.surname&&(e+=this.personDetails.surname[0].toUpperCase()),!e&&this.personDetails.displayName)for(var t=this.personDetails.displayName.split(" "),r=0;r<2&&r<t.length;r++)t[r][0].match(/[a-z]/i)&&(e+=t[r][0].toUpperCase());return e}}],[{key:"styles",get:function(){return Ze}}]),t}();lt([X({attribute:"person-query"})],pt.prototype,"personQuery",void 0),lt([X({attribute:"user-id"})],pt.prototype,"userId",void 0),lt([X({attribute:"show-name",type:Boolean})],pt.prototype,"showName",void 0),lt([X({attribute:"show-email",type:Boolean})],pt.prototype,"showEmail",void 0),lt([X({attribute:"person-details",type:Object})],pt.prototype,"personDetails",void 0),lt([X({attribute:"person-image",type:String})],pt.prototype,"personImage",void 0),lt([X({attribute:"person-card",converter:function(e,t){return e=e.toLowerCase(),void 0===Ve[e]?Ve.none:Ve[e]}})],pt.prototype,"personCardInteraction",void 0),lt([X({attribute:!1})],pt.prototype,"_isPersonCardVisible",void 0),lt([X({attribute:!1})],pt.prototype,"_personCardShouldRender",void 0),pt=lt([j("mgt-person")],pt);var ft=function e(t,r){p(this,e),"/"!==t.charAt(0)&&(t="/"+t),this.resource=t,this.method=r},vt=function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,s)}u((n=n.apply(e,t||[])).next())})},mt=function(){function e(t){p(this,e),this.requests=new Map,this.scopes=[],this.client=t}return l(e,[{key:"get",value:function(e,t,r){var n=new ft(t,"GET");this.requests.set(e,n),r&&(this.scopes=this.scopes.concat(r))}},{key:"execute",value:function(){return vt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n,a,i,o,s,u,c,d,l,h,p,f,v,g,y;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r={},this.requests.size){t.next=3;break}return t.abrupt("return",r);case 3:for(n=new oe,a=!0,i=!1,o=void 0,t.prev=7,s=this.requests[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)c=u.value,n.addRequest({id:c[0],request:new Request(e.baseUrl+c[1].resource,{method:c[1].method})});t.next=15;break;case 11:t.prev=11,t.t0=t.catch(7),i=!0,o=t.t0;case 15:t.prev=15,t.prev=16,a||null==s.return||s.return();case 18:if(t.prev=18,!i){t.next=21;break}throw o;case 21:return t.finish(18);case 22:return t.finish(15);case 23:return d=this.client.api("$batch").version("beta"),this.scopes.length&&(d=d.middlewareOptions(je.apply(void 0,m(this.scopes)))),t.t1=d,t.next=28,n.getContent();case 28:return t.t2=t.sent,t.next=31,t.t1.post.call(t.t1,t.t2);case 31:for(l=t.sent,h=!0,p=!1,f=void 0,t.prev=35,v=l.responses[Symbol.iterator]();!(h=(g=v.next()).done);h=!0)200!==(y=g.value).status?y[y.id]=null:y.headers["Content-Type"].includes("image/jpeg")?r[y.id]="data:image/jpeg;base64,"+y.body:r[y.id]=y.body;t.next=43;break;case 39:t.prev=39,t.t3=t.catch(35),p=!0,f=t.t3;case 43:t.prev=43,t.prev=44,h||null==v.return||v.return();case 46:if(t.prev=46,!p){t.next=49;break}throw f;case 49:return t.finish(46);case 50:return t.finish(43);case 51:return t.abrupt("return",r);case 52:case"end":return t.stop()}},t,this,[[7,11,15,23],[16,,18,22],[35,39,43,51],[44,,46,50]])}))}}]),e}();mt.baseUrl="https://graph.microsoft.com";var gt=function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,s)}u((n=n.apply(e,t||[])).next())})},yt=function(){function e(){p(this,e)}return l(e,[{key:"execute",value:function(e){return gt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r="mgt/".concat("1.1.0-preview.2"),r+=", "+de(e.request,e.options,"SdkVersion"),le(e.request,e.options,"SdkVersion",r),t.next=6,this.nextMiddleware.execute(e);case 6:return t.abrupt("return",t.sent);case 9:throw t.prev=9,t.t0=t.catch(0),t.t0;case 12:case"end":return t.stop()}},t,this,[[0,9]])}))}},{key:"setNext",value:function(e){this.nextMiddleware=e}}]),e}(),wt=function(e,t,r,n){return new(r||(r=Promise))(function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,s)}u((n=n.apply(e,t||[])).next())})};e("G",function(){function e(t){if(p(this,e),t){var r=new me(t),n=new we(new ye),a=new xe,i=new yt,o=new ge;r.setNext(n),n.setNext(a),a.setNext(i),i.setNext(o),this.client=Fe.initWithMiddleware({middleware:r})}}return l(e,[{key:"createBatch",value:function(){return new mt(this.client)}},{key:"getMe",value:function(){return wt(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.client.api("me").middlewareOptions(je("user.read")).get());case 1:case"end":return e.stop()}},e,this)}))}},{key:"getUser",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return"user.readbasic.all",t.abrupt("return",this.client.api("/users/".concat(e)).middlewareOptions(je("user.readbasic.all")).get());case 2:case"end":return t.stop()}},t,this)}))}},{key:"findPerson",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return"people.read",t.next=3,this.client.api("/me/people").search('"'+e+'"').middlewareOptions(je("people.read")).get();case 3:return r=t.sent,t.abrupt("return",r?r.value:null);case 5:case"end":return t.stop()}},t,this)}))}},{key:"findContactByEmail",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return"contacts.read",t.next=3,this.client.api("/me/contacts").filter("emailAddresses/any(a:a/address eq '".concat(e,"')")).middlewareOptions(je("contacts.read")).get();case 3:return r=t.sent,t.abrupt("return",r?r.value:null);case 5:case"end":return t.stop()}},t,this)}))}},{key:"findUserByEmail",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all([this.findPerson(e),this.findContactByEmail(e)]).then(function(e){var t=E(e,2),r=t[0],n=t[1];return(r||[]).concat(n||[])}));case 1:case"end":return t.stop()}},t,this)}))}},{key:"myPhoto",value:function(){return wt(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPhotoForResource("me",["user.read"]));case 1:case"end":return e.stop()}},e,this)}))}},{key:"getUserPhoto",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getPhotoForResource("users/".concat(e),["user.readbasic.all"]));case 1:case"end":return t.stop()}},t,this)}))}},{key:"getContactPhoto",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getPhotoForResource("me/contacts/".concat(e),["contacts.read"]));case 1:case"end":return t.stop()}},t,this)}))}},{key:"getEvents",value:function(e,t,r){return wt(this,void 0,void 0,regeneratorRuntime.mark(function n(){var a,i,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return"calendars.read",a="startdatetime=".concat(e.toISOString()),i="enddatetime=".concat(t.toISOString()),o=r?"groups/".concat(r,"/calendar"):"me",o+="/calendarview?".concat(a,"&").concat(i),n.next=7,this.client.api(o).middlewareOptions(je("calendars.read")).orderby("start/dateTime").get();case 7:return s=n.sent,n.abrupt("return",s?s.value:null);case 9:case"end":return n.stop()}},n,this)}))}},{key:"getPeople",value:function(){return wt(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"people.read","/me/people",e.next=4,this.client.api("/me/people").middlewareOptions(je("people.read")).filter("personType/class eq 'Person'").get();case 4:return t=e.sent,e.abrupt("return",t?t.value:null);case 6:case"end":return e.stop()}},e,this)}))}},{key:"getPeopleFromGroup",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return"people.read",r="/groups/".concat(e,"/members"),t.next=4,this.client.api(r).middlewareOptions(je("people.read")).get();case 4:return n=t.sent,t.abrupt("return",n?n.value:null);case 6:case"end":return t.stop()}},t,this)}))}},{key:"getPlansForGroup",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return"Group.Read.All",r="/groups/".concat(e,"/planner/plans"),t.next=4,this.client.api(r).header("Cache-Control","no-store").middlewareOptions(je("Group.Read.All")).get();case 4:return n=t.sent,t.abrupt("return",n?n.value:null);case 6:case"end":return t.stop()}},t,this)}))}},{key:"planner_getAllMyPlans",value:function(){return wt(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.api("/me/planner/plans").header("Cache-Control","no-store").middlewareOptions(je("Group.Read.All")).get();case 2:return t=e.sent,e.abrupt("return",t&&t.value);case 4:case"end":return e.stop()}},e,this)}))}},{key:"planner_getSinglePlan",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.client.api("/planner/plans/".concat(e)).header("Cache-Control","no-store").middlewareOptions(je("Group.Read.All")).get();case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}},t,this)}))}},{key:"planner_getBucketsForPlan",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.client.api("/planner/plans/".concat(e,"/buckets")).header("Cache-Control","no-store").middlewareOptions(je("Group.Read.All")).get();case 2:return r=t.sent,t.abrupt("return",r&&r.value);case 4:case"end":return t.stop()}},t,this)}))}},{key:"planner_getTasksForBucket",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.client.api("/planner/buckets/".concat(e,"/tasks")).header("Cache-Control","no-store").middlewareOptions(je("Group.Read.All")).get();case 2:return r=t.sent,t.abrupt("return",r&&r.value);case 4:case"end":return t.stop()}},t,this)}))}},{key:"planner_setTaskDetails",value:function(e,t,r){return wt(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.client.api("/planner/tasks/".concat(e)).header("Cache-Control","no-store").middlewareOptions(je("Group.ReadWrite.All")).header("If-Match",r).patch(JSON.stringify(t));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"planner_setTaskComplete",value:function(e,t){return wt(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.planner_setTaskDetails(e,{percentComplete:100},t));case 1:case"end":return r.stop()}},r,this)}))}},{key:"planner_setTaskIncomplete",value:function(e,t){return wt(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.planner_setTaskDetails(e,{percentComplete:0},t));case 1:case"end":return r.stop()}},r,this)}))}},{key:"planner_assignPeopleToTask",value:function(e,t,r){return wt(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.planner_setTaskDetails(e,{assignments:t},r));case 1:case"end":return n.stop()}},n,this)}))}},{key:"planner_addTask",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.client.api("/planner/tasks").header("Cache-Control","no-store").middlewareOptions(je("Group.ReadWrite.All")).post(e));case 1:case"end":return t.stop()}},t,this)}))}},{key:"planner_removeTask",value:function(e,t){return wt(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.client.api("/planner/tasks/".concat(e)).header("Cache-Control","no-store").header("If-Match",t).middlewareOptions(je("Group.ReadWrite.All")).delete());case 1:case"end":return r.stop()}},r,this)}))}},{key:"todo_getAllMyGroups",value:function(){return wt(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.api("/me/outlook/taskGroups").header("Cache-Control","no-store").version("beta").middlewareOptions(je("Tasks.Read")).get();case 2:return t=e.sent,e.abrupt("return",t&&t.value);case 4:case"end":return e.stop()}},e,this)}))}},{key:"todo_getSingleGroup",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.client.api("/me/outlook/taskGroups/".concat(e)).header("Cache-Control","no-store").version("beta").middlewareOptions(je("Tasks.Read")).get();case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}},t,this)}))}},{key:"todo_getFoldersForGroup",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.client.api("/me/outlook/taskGroups/".concat(e,"/taskFolders")).header("Cache-Control","no-store").version("beta").middlewareOptions(je("Tasks.Read")).get();case 2:return r=t.sent,t.abrupt("return",r&&r.value);case 4:case"end":return t.stop()}},t,this)}))}},{key:"todo_getAllTasksForFolder",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.client.api("/me/outlook/taskFolders/".concat(e,"/tasks")).header("Cache-Control","no-store").version("beta").middlewareOptions(je("Tasks.Read")).get();case 2:return r=t.sent,t.abrupt("return",r&&r.value);case 4:case"end":return t.stop()}},t,this)}))}},{key:"todo_setTaskDetails",value:function(e,t,r){return wt(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.client.api("/me/outlook/tasks/".concat(e)).header("Cache-Control","no-store").version("beta").header("If-Match",r).middlewareOptions(je("Tasks.ReadWrite")).patch(t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"todo_setTaskComplete",value:function(e,t){return wt(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.todo_setTaskDetails(e,{isReminderOn:!1,status:"completed"},t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))}},{key:"todo_setTaskIncomplete",value:function(e,t){return wt(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.todo_setTaskDetails(e,{isReminderOn:!0,status:"notStarted"},t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))}},{key:"todo_addTask",value:function(e){return wt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.parentFolderId,!(n=void 0===r?null:r)){t.next=7;break}return t.next=4,this.client.api("/me/outlook/taskFolders/".concat(n,"/tasks")).header("Cache-Control","no-store").version("beta").middlewareOptions(je("Tasks.ReadWrite")).post(e);case 4:return t.abrupt("return",t.sent);case 7:return t.next=9,this.client.api("/me/outlook/tasks").header("Cache-Control","no-store").version("beta").middlewareOptions(je("Tasks.ReadWrite")).post(e);case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}},t,this)}))}},{key:"todo_removeTask",value:function(e,t){return wt(this,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.client.api("/me/outlook/tasks/".concat(e)).header("Cache-Control","no-store").version("beta").header("If-Match",t).middlewareOptions(je("Tasks.ReadWrite")).delete();case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},r,this)}))}},{key:"blobToBase64",value:function(e){return new Promise(function(t,r){var n=new FileReader;n.onerror=r,n.onload=function(e){t(n.result)},n.readAsDataURL(e)})}},{key:"getPhotoForResource",value:function(e,t){return wt(this,void 0,void 0,regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,this.client.api("".concat(e,"/photo/$value")).version("beta").responseType(Re.BLOB).middlewareOptions(je.apply(void 0,m(t))).get();case 3:return n=r.sent,r.next=6,this.blobToBase64(n);case 6:return r.abrupt("return",r.sent);case 9:return r.prev=9,r.t0=r.catch(0),r.abrupt("return",null);case 12:case"end":return r.stop()}},r,this,[[0,9]])}))}}]),e}())}}});
//# sourceMappingURL=Graph-edc653e3.js.map
