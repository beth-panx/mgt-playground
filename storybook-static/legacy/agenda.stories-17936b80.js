System.register(["./lit-html-de476c62.js","./index-14c7f544.js","./Graph-edc653e3.js","./mgt-mock-provider-ad9c32b1.js"],function(e){"use strict";var t,n,a,i,o,r,d,s,l,c,v,g,u,m,p,h,f,x,y,b,w;return{setters:[function(e){t=e.v,n=e._,a=e.a,i=e.b,o=e.c,r=e.d,d=e.x,s=e.e,l=e.f,c=e.u},function(e){v=e.e,g=e.f},function(e){u=e.c,m=e.p,p=e.a,h=e.P,f=e.b,x=e.d,y=e.g,b=e.e,w=e.M},function(){}],execute:function(){function k(){var e=t([':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\E70D"}.ms-Icon--ChevronUp::before{content:"\\E70E"}.ms-Icon--Contact::before{content:"\\E77B"}.ms-Icon--AddFriend::before{content:"\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\EB6D"}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,40px 10px 14px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);color:var(--agenda-header-color,#333)}:host .agenda > .group:first-child > .header,mgt-agenda .agenda > .group:first-child > .header{margin-top:0}:host .agenda-list,mgt-agenda .agenda-list{list-style-type:none;padding:0;margin:0;font-family:var(--default-font-family);font-style:normal;font-weight:400}:host .event,mgt-agenda .event{background:var(--event-background,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--event-box-shadow,0 2px 8px rgba(0,0,0,.092));margin:var(--event-margin,0 10px 14px 10px);padding:var(--event-padding,0);display:flex}:host .narrow .event,mgt-agenda .narrow .event{flex-direction:column}:host .event-time-container,mgt-agenda .event-time-container{display:flex;flex-direction:column;margin:18px 38px 18px 18px;width:120px}:host .narrow .event-time-container,mgt-agenda .narrow .event-time-container{margin:14px 18px 8px 18px}:host .event-time,mgt-agenda .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,#000);font-weight:600}:host .event-duration,mgt-agenda .event-duration{color:rgba(16,16,16,.3)}:host .event-details-container,mgt-agenda .event-details-container{margin:14px 18px 14px 0}:host .narrow .event-details-container,mgt-agenda .narrow .event-details-container{margin:0 18px 14px 18px}:host .event-subject,mgt-agenda .event-subject{margin:0 18px 0 0;font-size:var(--event-subject-font-size,19px);color:var(--event-subject-color,#333)}:host .event-location-container,mgt-agenda .event-location-container{display:flex;margin:8px 18px 0 0}:host .event-location,mgt-agenda .event-location{font-size:var(--event-location-font-size,12px);color:var(--event-location-color,#000);margin:0 0 0 4px}:host .event-attendees,mgt-agenda .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}:host .event-other-container,mgt-agenda .event-other-container{margin:2px 16px 4px 16px;margin-left:auto}:host .loading-element,mgt-agenda .loading-element{background:#f2f2f2;border-radius:1px}:host .event-time-loading,mgt-agenda .event-time-loading{width:100px;height:10px}:host .event-subject-loading,mgt-agenda .event-subject-loading{width:263px;height:16px}:host .event-location-icon-loading,mgt-agenda .event-location-icon-loading{width:14px;height:14px}:host .event-location-loading,mgt-agenda .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .event-attendee-loading,mgt-agenda .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}'],[':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\\\\E70E"}.ms-Icon--Contact::before{content:"\\\\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\\\\EB6D"}:host .header,mgt-agenda .header{margin:var(--agenda-header-margin,40px 10px 14px 10px);font-family:var(--default-font-family);font-size:var(--agenda-header-font-size,24px);color:var(--agenda-header-color,#333)}:host .agenda > .group:first-child > .header,mgt-agenda .agenda > .group:first-child > .header{margin-top:0}:host .agenda-list,mgt-agenda .agenda-list{list-style-type:none;padding:0;margin:0;font-family:var(--default-font-family);font-style:normal;font-weight:400}:host .event,mgt-agenda .event{background:var(--event-background,#fff);border:var(--event-border,solid 2px transparent);box-shadow:var(--event-box-shadow,0 2px 8px rgba(0,0,0,.092));margin:var(--event-margin,0 10px 14px 10px);padding:var(--event-padding,0);display:flex}:host .narrow .event,mgt-agenda .narrow .event{flex-direction:column}:host .event-time-container,mgt-agenda .event-time-container{display:flex;flex-direction:column;margin:18px 38px 18px 18px;width:120px}:host .narrow .event-time-container,mgt-agenda .narrow .event-time-container{margin:14px 18px 8px 18px}:host .event-time,mgt-agenda .event-time{font-size:var(--event-time-font-size,12px);color:var(--event-time-color,#000);font-weight:600}:host .event-duration,mgt-agenda .event-duration{color:rgba(16,16,16,.3)}:host .event-details-container,mgt-agenda .event-details-container{margin:14px 18px 14px 0}:host .narrow .event-details-container,mgt-agenda .narrow .event-details-container{margin:0 18px 14px 18px}:host .event-subject,mgt-agenda .event-subject{margin:0 18px 0 0;font-size:var(--event-subject-font-size,19px);color:var(--event-subject-color,#333)}:host .event-location-container,mgt-agenda .event-location-container{display:flex;margin:8px 18px 0 0}:host .event-location,mgt-agenda .event-location{font-size:var(--event-location-font-size,12px);color:var(--event-location-color,#000);margin:0 0 0 4px}:host .event-attendees,mgt-agenda .event-attendees{--list-margin:8px 0 0 0;--avatar-size-s:20px}:host .event-other-container,mgt-agenda .event-other-container{margin:2px 16px 4px 16px;margin-left:auto}:host .loading-element,mgt-agenda .loading-element{background:#f2f2f2;border-radius:1px}:host .event-time-loading,mgt-agenda .event-time-loading{width:100px;height:10px}:host .event-subject-loading,mgt-agenda .event-subject-loading{width:263px;height:16px}:host .event-location-icon-loading,mgt-agenda .event-location-icon-loading{width:14px;height:14px}:host .event-location-loading,mgt-agenda .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .event-attendee-loading,mgt-agenda .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}']);return k=function(){return e},e}var D=[u(k())];function z(){var e=t([' <mgt-people class="event-attendees" .people="','"></mgt-people> ']);return z=function(){return e},e}function T(){var e=t([' <div class="event-location-container"> <svg width="10" height="13" viewBox="0 0 10 13" fill="none" xmlns="http://www.w3.org/2000/svg"> <path fill-rule="evenodd" clip-rule="evenodd" d="M4.99989 6.49989C4.15159 6.49989 3.46143 5.81458 3.46143 4.97224C3.46143 4.12965 4.15159 3.44434 4.99989 3.44434C5.84845 3.44434 6.53835 4.12965 6.53835 4.97224C6.53835 5.81458 5.84845 6.49989 4.99989 6.49989Z" stroke="black"/> <path fill-rule="evenodd" clip-rule="evenodd" d="M8.1897 7.57436L5.00029 12L1.80577 7.56765C0.5971 6.01895 0.770299 3.47507 2.17681 2.12383C2.93098 1.39918 3.93367 1 5.00029 1C6.06692 1 7.06961 1.39918 7.82401 2.12383C9.23075 3.47507 9.40372 6.01895 8.1897 7.57436Z" stroke="black"/> </svg> <div class="event-location" aria-label="','">',"</div> </div> "]);return T=function(){return e},e}function E(){var e=t([' <div class="event-other-container"> '," </div> "]);return E=function(){return e},e}function C(){var e=t([' <div class="event"> <div class="event-time-container"> <div class="event-time" aria-label="','">','</div> </div> <div class="event-details-container"> <div class="event-subject">',"</div> "," "," </div> "," </div> "]);return C=function(){return e},e}function j(){var e=t([' <div class="event"> <div class="event-time-container"> <div class="event-time-loading loading-element"></div> </div> <div class="event-details-container"> <div class="event-subject-loading loading-element"></div> <div class="event-location-container"> <div class="event-location-icon-loading loading-element"></div> <div class="event-location-loading loading-element"></div> </div> <div class="event-location-container"> <div class="event-attendee-loading loading-element"></div> <div class="event-attendee-loading loading-element"></div> <div class="event-attendee-loading loading-element"></div> </div> </div> </div> ']);return j=function(){return e},e}function I(){var e=t([' <li @click="','"> '," </li> "]);return I=function(){return e},e}function M(){var e=t([' <ul class="agenda-list"> '," </ul> "]);return M=function(){return e},e}function L(){var e=t([""]);return L=function(){return e},e}function S(){var e=t([' <div class="header" aria-label="','">',"</div> "]);return S=function(){return e},e}function A(){var e=t([' <div class="group"> '," "," </div> "]);return A=function(){return e},e}function _(){var e=t([' <div class="agenda grouped ','"> '," </div> "]);return _=function(){return e},e}function B(){var e=t([' <div class="agenda ','"> '," </div> "]);return B=function(){return e},e}var F=function(e,t,a,i){var o,r=arguments.length,d=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,a):i;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)d=Reflect.decorate(e,t,a,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(d=(r<3?o(d):r>3?o(t,a,d):o(t,a))||d);return r>3&&d&&Object.defineProperty(t,a,d),d},N=function(e,t,n,a){return new(n||(n=Promise))(function(i,o){function r(e){try{s(a.next(e))}catch(e){o(e)}}function d(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,d)}s((a=a.apply(e,t||[])).next())})},R=function(e){function t(){var e;return i(this,t),(e=o(this,r(t).call(this))).groupByDay=!1,e.days=3,e._firstUpdated=!1,e._loading=!0,e.onResize=e.onResize.bind(d(e)),e}return a(t,w),s(t,[{key:"firstUpdated",value:function(){var e=this;this._firstUpdated=!0,h.onProviderUpdated(function(){return e.loadData()}),this.loadData()}},{key:"connectedCallback",value:function(){this._isNarrow=this.offsetWidth<600,l(r(t.prototype),"connectedCallback",this).call(this),window.addEventListener("resize",this.onResize)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("resize",this.onResize),l(r(t.prototype),"disconnectedCallback",this).call(this)}},{key:"attributeChangedCallback",value:function(e,n,a){n===a||"date"!==e&&"days"!==e&&"group-id"!==e||(this.events=null,this.loadData()),l(r(t.prototype),"attributeChangedCallback",this).call(this,e,n,a)}},{key:"render",value:function(){return this._isNarrow=this.offsetWidth<600,c(B(),this._isNarrow?"narrow":"",this.renderAgenda())}},{key:"onResize",value:function(){this._isNarrow=this.offsetWidth<600}},{key:"loadData",value:function(){return N(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,a,i,o,r,d,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.events){e.next=2;break}return e.abrupt("return");case 2:if(this._firstUpdated){e.next=4;break}return e.abrupt("return");case 4:if(!(t=h.globalProvider)||t.state!==f.SignedIn){e.next=40;break}if(this._loading=!0,!this.eventQuery){e.next=25;break}return e.prev=8,(n=this.eventQuery.split("|")).length>1?(i=n[0].trim(),a=n[1].trim()):i=this.eventQuery,e.next=13,t.graph.client.api(i);case 13:return o=e.sent,a&&(o=o.middlewareOptions(x(a))),e.next=17,o.get();case 17:(r=e.sent)&&r.value&&(this.events=r.value),e.next=23;break;case 21:e.prev=21,e.t0=e.catch(8);case 23:e.next=37;break;case 25:return(d=this.date?new Date(this.date):new Date).setHours(0,0,0,0),(s=new Date(d.getTime())).setDate(d.getDate()+this.days),e.prev=29,e.next=32,t.graph.getEvents(d,s,this.groupId);case 32:this.events=e.sent,e.next=37;break;case 35:e.prev=35,e.t1=e.catch(29);case 37:this._loading=!1,e.next=41;break;case 40:t&&t.state===f.Loading?this._loading=!0:this._loading=!1;case 41:case"end":return e.stop()}},e,this,[[8,21],[29,35]])}))}},{key:"renderAgenda",value:function(){var e=this;if(this._loading)return this.renderTemplate("loading",null)||this.renderLoading();if(this.events){var t=this.showMax&&this.showMax>0?this.events.slice(0,this.showMax):this.events,n=this.renderTemplate("default",{events:t});if(n)return n;if(this.groupByDay){for(var a={},i=0;i<t.length;i++){var o=this.getDateHeaderFromDateTimeString(t[i].start.dateTime);a[o]=a[o]||[],a[o].push(t[i])}return c(_(),this._isNarrow?"narrow":"",Object.keys(a).map(function(t){return c(A(),e.renderTemplate("header",{header:t},"header-"+t)||c(S(),t,t),e.renderListOfEvents(a[t]))}))}return this.renderListOfEvents(t)}return this.renderTemplate("no-data",null)||c(L())}},{key:"renderListOfEvents",value:function(e){var t=this;return c(M(),e.map(function(e){return c(I(),function(){return t.eventClicked(e)},t.renderTemplate("event",{event:e},e.id)||t.renderEvent(e))}))}},{key:"renderLoading",value:function(){return c(j())}},{key:"renderEvent",value:function(e){return c(C(),this.getEventTimeString(e),this.getEventTimeString(e),e.subject,this.renderLocation(e),this.renderAttendies(e),this.templates["event-other"]?c(E(),this.renderTemplate("event-other",{event:e},e.id+"-other")):"")}},{key:"renderLocation",value:function(e){return e.location.displayName?c(T(),e.location.displayName,e.location.displayName):null}},{key:"renderAttendies",value:function(e){return e.attendees.length?c(z(),e.attendees.map(function(e){return{displayName:e.emailAddress.name,emailAddresses:[e.emailAddress]}})):null}},{key:"eventClicked",value:function(e){this.fireCustomEvent("eventClick",{event:e})}},{key:"getEventTimeString",value:function(e){if(e.isAllDay)return"ALL DAY";var t=this.prettyPrintTimeFromDateTime(new Date(e.start.dateTime)),n=this.prettyPrintTimeFromDateTime(new Date(e.end.dateTime));return"".concat(t," - ").concat(n)}},{key:"prettyPrintTimeFromDateTime",value:function(e){e.setMinutes(e.getMinutes()-e.getTimezoneOffset());var t=e.getHours(),n=e.getMinutes(),a=t>=12?"PM":"AM",i=n<10?"0"+n:n;return"".concat(t=(t%=12)||12,":").concat(i," ").concat(a)}},{key:"getDateHeaderFromDateTimeString",value:function(e){var t=new Date(e);t.setMinutes(t.getMinutes()-t.getTimezoneOffset());var n=t.getDay(),a=t.getMonth(),i=t.getDate(),o=t.getFullYear();return"".concat(y(n),", ").concat(b(a)," ").concat(i,", ").concat(o)}},{key:"getEventDuration",value:function(e){var t=new Date(e.start.dateTime),n=new Date(e.end.dateTime),a=new Date,i="";a>t&&(t=a);var o=n.getTime()-t.getTime(),r=Math.round(o/6e4);if(r>1440||e.isAllDay)i=Math.ceil(r/1440)+"d";else if(r>60){i=Math.round(r/60)+"h";var d=r%60;d&&(i+=d+"m")}else i=r+"m";return i}}],[{key:"styles",get:function(){return D}}]),t}();function U(){var e=t([' <mgt-mock-provider></mgt-mock-provider> <mgt-agenda> <template data-type="event"> <button class="eventButton"> <div class="event-subject">{{ event.subject }}</div> <div data-for="attendee in event.attendees"> <mgt-person person-query="{{ attendee.emailAddress.name }}" show-name show-email> </mgt-person> </div> </button> </template> <template data-type="no-data"> There are no events found! </template> </mgt-agenda> ']);return U=function(){return e},e}function O(){var e=t([' <mgt-mock-provider></mgt-mock-provider> <mgt-agenda group-by-day date="May 7, 2019" days="3"></mgt-agenda> ']);return O=function(){return e},e}function P(){var e=t([' <mgt-mock-provider></mgt-mock-provider> <mgt-agenda event-query="/me/events?orderby=start/dateTime"></mgt-agenda> ']);return P=function(){return e},e}function W(){var e=t([" <mgt-mock-provider></mgt-mock-provider> <mgt-agenda></mgt-agenda> "]);return W=function(){return e},e}F([m({attribute:"events"})],R.prototype,"events",void 0),F([m({attribute:"group-by-day",reflect:!0,type:Boolean})],R.prototype,"groupByDay",void 0),F([m({attribute:"date",reflect:!0,type:String})],R.prototype,"date",void 0),F([m({attribute:"days",reflect:!0,type:Number})],R.prototype,"days",void 0),F([m({attribute:"event-query",type:String})],R.prototype,"eventQuery",void 0),F([m({attribute:"show-max",type:Number})],R.prototype,"showMax",void 0),F([m({attribute:"group-id",type:String})],R.prototype,"groupId",void 0),F([m({attribute:!1})],R.prototype,"_isNarrow",void 0),F([m({attribute:!1})],R.prototype,"_loading",void 0),R=F([p("mgt-agenda")],R);e("default",{title:"Mock Provider|mgt-agenda",component:"mgt-agenda",decorators:[v,g]}),e("simple",function(){return c(W())}),e("getByEventQuery",function(){return c(P())}),e("getByDate",function(){return c(O())}),e("getByEventTemplate",function(){return c(U())})}}});
//# sourceMappingURL=agenda.stories-17936b80.js.map
