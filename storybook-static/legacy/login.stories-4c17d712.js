System.register(["./lit-html-de476c62.js","./index-14c7f544.js","./Graph-edc653e3.js","./mgt-login-a17b7ce8.js"],function(e){"use strict";var t,n,r,o,i,a,s,c,u,l,d,h,p,f,g,m,y,v,w,I,k,b;return{setters:[function(e){t=e.a,n=e.b,r=e.c,o=e.d,i=e.e,a=e._,s=e.f,c=e.u,u=e.v},function(e){l=e.e,d=e.f},function(e){h=e._,p=e.m,f=e.n,g=e.b,m=e.o,y=e.G,v=e.I,w=e.p,I=e.f,k=e.a,b=e.P},function(){}],execute:function(){var S=function(){function e(){}return e.createNewGuid=function(){var t=window.crypto;if(t&&t.getRandomValues){var n=new Uint8Array(16);return t.getRandomValues(n),n[6]|=64,n[6]&=79,n[8]|=128,n[8]&=191,e.decimalToHex(n[0])+e.decimalToHex(n[1])+e.decimalToHex(n[2])+e.decimalToHex(n[3])+"-"+e.decimalToHex(n[4])+e.decimalToHex(n[5])+"-"+e.decimalToHex(n[6])+e.decimalToHex(n[7])+"-"+e.decimalToHex(n[8])+e.decimalToHex(n[9])+"-"+e.decimalToHex(n[10])+e.decimalToHex(n[11])+e.decimalToHex(n[12])+e.decimalToHex(n[13])+e.decimalToHex(n[14])+e.decimalToHex(n[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",o="0123456789abcdef",i=0,a="",s=0;s<36;s++)"-"!==r[s]&&"4"!==r[s]&&(i=16*Math.random()|0),"x"===r[s]?a+=o[i]:"y"===r[s]?(i&=3,a+=o[i|=8]):a+=r[s];return a},e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e.base64Encode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(Number("0x"+t))}))},e.base64Decode=function(e){return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))},e.deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,o=function(e){return decodeURIComponent(e.replace(n," "))},i={};for(t=r.exec(e);t;)i[o(t[1])]=o(t[2]),t=r.exec(e);return i},e}(),T=function(){function e(){}return Object.defineProperty(e,"errorDescription",{get:function(){return"error_description"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"error",{get:function(){return"error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"scope",{get:function(){return"scope"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientInfo",{get:function(){return"client_info"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientId",{get:function(){return"clientId"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"idToken",{get:function(){return"id_token"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"adalIdToken",{get:function(){return"adal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"accessToken",{get:function(){return"access_token"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"expiresIn",{get:function(){return"expires_in"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"sessionState",{get:function(){return"session_state"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"claims",{get:function(){return"claims"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalClientInfo",{get:function(){return"msal.client.info"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalError",{get:function(){return"msal.error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalErrorDescription",{get:function(){return"msal.error.description"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msalSessionState",{get:function(){return"msal.session.state"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenKeys",{get:function(){return"msal.token.keys"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"accessTokenKey",{get:function(){return"msal.access.token.key"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"expirationKey",{get:function(){return"msal.expiration.key"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateLogin",{get:function(){return"msal.state.login"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateAcquireToken",{get:function(){return"msal.state.acquireToken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"stateRenew",{get:function(){return"msal.state.renew"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"nonceIdToken",{get:function(){return"msal.nonce.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"userName",{get:function(){return"msal.username"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"idTokenKey",{get:function(){return"msal.idtoken"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginRequest",{get:function(){return"msal.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginError",{get:function(){return"msal.login.error"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewStatus",{get:function(){return"msal.token.renew.status"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"urlHash",{get:function(){return"msal.urlHash"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"angularLoginRequest",{get:function(){return"msal.angular.login.request"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"msal",{get:function(){return"msal"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"no_account",{get:function(){return"NO_ACCOUNT"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"consumersUtid",{get:function(){return"9188040d-6c67-4c5b-b112-36a304b66dad"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"upn",{get:function(){return"upn"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_select_account",{get:function(){return"&prompt=select_account"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt_none",{get:function(){return"&prompt=none"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prompt",{get:function(){return"prompt"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"response_mode_fragment",{get:function(){return"&response_mode=fragment"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"resourceDelimiter",{get:function(){return"|"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusCancelled",{get:function(){return"Canceled"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusCompleted",{get:function(){return"Completed"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"tokenRenewStatusInProgress",{get:function(){return"In Progress"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpWidth",{get:function(){return this._popUpWidth},set:function(e){this._popUpWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"popUpHeight",{get:function(){return this._popUpHeight},set:function(e){this._popUpHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"login",{get:function(){return"LOGIN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"renewToken",{get:function(){return"RENEW_TOKEN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return"UNKNOWN"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"homeAccountIdentifier",{get:function(){return"homeAccountIdentifier"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"common",{get:function(){return"common"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"openidScope",{get:function(){return"openid"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"profileScope",{get:function(){return"profile"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheLocationLocal",{get:function(){return"localStorage"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cacheLocationSession",{get:function(){return"sessionStorage"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypeRedirect",{get:function(){return"redirectInteraction"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"interactionTypePopup",{get:function(){return"popupInteraction"},enumerable:!0,configurable:!0}),e._popUpWidth=483,e._popUpHeight=600,e}(),C="msal.authority",E="msal.acquireTokenAccount",A={"login.windows.net":"login.windows.net","login.chinacloudapi.cn":"login.chinacloudapi.cn","login.cloudgovapi.us":"login.cloudgovapi.us","login.microsoftonline.com":"login.microsoftonline.com","login.microsoftonline.de":"login.microsoftonline.de","login.microsoftonline.us":"login.microsoftonline.us"},P="sid",R="login_hint",O="id_token",_="domain_hint",x="organizations",q="consumers",U="homeAccountIdentifier",j="login_req",L="domain_req",N=[P,R],M={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};var H=function(){function e(){}return e.isIntersectingScopes=function(e,t){e=this.convertToLowerCase(e);for(var n=0;n<t.length;n++)if(e.indexOf(t[n].toLowerCase())>-1)return!0;return!1},e.containsScope=function(e,t){return e=this.convertToLowerCase(e),t.every(function(t){return e.indexOf(t.toString().toLowerCase())>=0})},e.convertToLowerCase=function(e){return e.map(function(e){return e.toLowerCase()})},e.removeElement=function(e,t){return e.filter(function(e){return e!==t})},e.parseScope=function(e){var t="";if(e)for(var n=0;n<e.length;++n)t+=n!==e.length-1?e[n]+" ":e[n];return t},e}(),D=function(){function e(){}return e.isEmpty=function(e){return void 0===e||!e||0===e.length},e}(),K=function(){function e(){}return e.createNavigateUrl=function(e){var t=this.createNavigationUrlString(e),n=e.authorityInstance.AuthorizationEndpoint;return n.indexOf("?")<0?n+="?":n+="&",""+n+t.join("&")},e.createNavigationUrlString=function(e){var t=e.scopes;-1===t.indexOf(e.clientId)&&t.push(e.clientId);var n=[];return n.push("response_type="+e.responseType),this.translateclientIdUsedInScope(t,e.clientId),n.push("scope="+encodeURIComponent(H.parseScope(t))),n.push("client_id="+encodeURIComponent(e.clientId)),n.push("redirect_uri="+encodeURIComponent(e.redirectUri)),n.push("state="+encodeURIComponent(e.state)),n.push("nonce="+encodeURIComponent(e.nonce)),n.push("client_info=1"),n.push("x-client-SKU="+e.xClientSku),n.push("x-client-Ver="+e.xClientVer),e.promptValue&&n.push("prompt="+encodeURIComponent(e.promptValue)),e.claimsValue&&n.push("claims="+encodeURIComponent(e.claimsValue)),e.queryParameters&&n.push(e.queryParameters),e.extraQueryParameters&&n.push(e.extraQueryParameters),n.push("client-request-id="+encodeURIComponent(e.correlationId)),n},e.translateclientIdUsedInScope=function(e,t){var n=e.indexOf(t);n>=0&&(e.splice(n,1),-1===e.indexOf("openid")&&e.push("openid"),-1===e.indexOf("profile")&&e.push("profile"))},e.getDefaultRedirectUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.replaceTenantPath=function(e,t){e=e.toLowerCase();var n=this.GetUrlComponents(e),r=n.PathSegments;return!t||0===r.length||r[0]!==T.common&&r[0]!==x||(r[0]=t),this.constructAuthorityUriFromObject(n,r)},e.constructAuthorityUriFromObject=function(e,t){return this.CanonicalizeUri(e.Protocol+"//"+e.HostNameAndPort+"/"+t.join("/"))},e.GetUrlComponents=function(e){if(!e)throw"Url required";var t=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),n=e.match(t);if(!n||n.length<6)throw"Valid url required";var r={Protocol:n[1],HostNameAndPort:n[4],AbsolutePath:n[5]},o=r.AbsolutePath.split("/");return o=o.filter(function(e){return e&&e.length>0}),r.PathSegments=o,r},e.CanonicalizeUri=function(t){return t&&(t=t.toLowerCase()),t&&!e.endsWith(t,"/")&&(t+="/"),t},e.endsWith=function(e,t){return!(!e||!t)&&-1!==e.indexOf(t,e.length-t.length)},e.urlRemoveQueryStringParameter=function(e,t){if(D.isEmpty(e))return e;var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e=e.replace(n,"")},e.getHashFromUrl=function(e){var t=e.indexOf("#"),n=e.indexOf("#/");return n>-1?e.substring(n+2):t>-1?e.substring(t+1):e},e}(),F=function(){return function(e,t,n,r,o){this.authority=K.CanonicalizeUri(e),this.clientId=t,this.scopes=n,this.homeAccountIdentifier=S.base64Encode(r)+"."+S.base64Encode(o)}}(),W=function(){return function(e,t,n,r){this.accessToken=e,this.idToken=t,this.expiresIn=n,this.homeAccountIdentifier=r}}(),G={code:"unexpected_error",desc:"Unexpected error in authentication."},V=function(e){function t(n,r){var o=e.call(this,r)||this;return Object.setPrototypeOf(o,t.prototype),o.errorCode=n,o.errorMessage=r,o.name="AuthError",o}return h(t,e),t.createUnexpectedError=function(e){return new t(G.code,G.desc+": "+e)},t}(Error),z={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements like authority."},J={code:"multiple_authorities",desc:"Multiple authorities found in the cache. Pass authority in the API overload."},B={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},Q={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},X={code:"token_renewal_error",desc:"Token renewal operation failed due to timeout."},Y={code:"invalid_id_token",desc:"Invalid ID token format."},$={code:"invalid_state_error",desc:"Invalid state."},Z={code:"nonce_mismatch_error",desc:"Nonce is not matching, Nonce received: "},ee={code:"login_progress_error",desc:"Login_In_Progress: Error during login call - login is already in progress."},te={code:"acquiretoken_progress_error",desc:"AcquireToken_In_Progress: Error during login call - login is already in progress."},ne={code:"user_cancelled",desc:"User cancelled the flow."},re={code:"callback_error",desc:"Error occurred in token received callback function."},oe={code:"user_login_error",desc:"User login is required."},ie={code:"user_non_existent",desc:"User object does not exist. Please call a login API."},ae={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},se={code:"client_info_not_populated_error",desc:"The service did not populate client_info in the response, Please verify with the service team"},ce={code:"null_or_empty_id_token",desc:"The idToken is null or empty. Please review the trace to determine the root cause."},ue={code:"id_token_parsing_error",desc:"ID token cannot be parsed. Please review stack trace to determine root cause."},le={code:"token_encoding_error",desc:"The token to be decoded is not encoded correctly."},de={code:"invalid_interaction_type",desc:"The interaction type passed to the handler was incorrect or unknown"},he=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return h(t,e),t.createEndpointResolutionError=function(e){var n=B.desc;return e&&!D.isEmpty(e)&&(n+=" Details: "+e),new t(B.code,n)},t.createMultipleMatchingTokensInCacheError=function(e){return new t(z.code,"Cache error for scope "+e+": "+z.desc+".")},t.createMultipleAuthoritiesInCacheError=function(e){return new t(J.code,"Cache error for scope "+e+": "+J.desc+".")},t.createPopupWindowError=function(e){var n=Q.desc;return e&&!D.isEmpty(e)&&(n+=" Details: "+e),new t(Q.code,n)},t.createTokenRenewalTimeoutError=function(){return new t(X.code,X.desc)},t.createInvalidIdTokenError=function(e){return new t(Y.code,Y.desc+" Given token: "+e)},t.createInvalidStateError=function(e,n){return new t($.code,$.desc+" "+e+", state expected : "+n+".")},t.createNonceMismatchError=function(e,n){return new t(Z.code,Z.desc+" "+e+", nonce expected : "+n+".")},t.createLoginInProgressError=function(){return new t(ee.code,ee.desc)},t.createAcquireTokenInProgressError=function(){return new t(te.code,te.desc)},t.createUserCancelledError=function(){return new t(ne.code,ne.desc)},t.createErrorInCallbackFunction=function(e){return new t(re.code,re.desc+" "+e+".")},t.createUserLoginRequiredError=function(){return new t(oe.code,oe.desc)},t.createUserDoesNotExistError=function(){return new t(ie.code,ie.desc)},t.createClientInfoDecodingError=function(e){return new t(ae.code,ae.desc+" Failed with error: "+e)},t.createClientInfoNotPopulatedError=function(e){return new t(se.code,se.desc+" Failed with error: "+e)},t.createIdTokenNullOrEmptyError=function(e){return new t(ce.code,ce.desc+" Raw ID Token Value: "+e)},t.createIdTokenParsingError=function(e){return new t(ue.code,ue.desc+" Failed with error: "+e)},t.createTokenEncodingError=function(e){return new t(le.code,le.desc+" Attempted to decode: "+e)},t.createInvalidInteractionTypeError=function(){return new t(de.code,de.desc)},t}(V),pe={configurationNotSet:{code:"no_config_set",desc:"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object."},invalidCacheLocation:{code:"invalid_cache_location",desc:"The cache location provided is not valid."},noStorageSupported:{code:"browser_storage_not_supported",desc:"localStorage and sessionStorage are not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},scopesRequired:{code:"scopes_required",desc:"Scopes are required to obtain an access token."},emptyScopes:{code:"empty_input_scopes_error",desc:"Scopes cannot be passed as empty array."},nonArrayScopes:{code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},clientScope:{code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},invalidPrompt:{code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'"},invalidAuthorityType:{code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>."},authorityUriInsecure:{code:"authority_uri_insecure",desc:"Authority URIs must use https."},authorityUriInvalidPath:{code:"authority_uri_invalid_path",desc:"Given authority URI is invalid."},unsupportedAuthorityValidation:{code:"unsupported_authority_validation",desc:"The authority validation is not supported for this authority type."},b2cAuthorityUriInvalidPath:{code:"b2c_authority_uri_invalid_path",desc:"The given URI for the B2C authority is invalid."},claimsRequestParsingError:{code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},emptyRequestError:{code:"empty_request_error",desc:"Request object is required."},telemetryConfigError:{code:"telemetry_config_error",desc:"Telemetry config is not configured with required values"}},fe=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return h(t,e),t.createNoSetConfigurationError=function(){return new t(pe.configurationNotSet.code,""+pe.configurationNotSet.desc)},t.createInvalidCacheLocationConfigError=function(e){return new t(pe.invalidCacheLocation.code,pe.invalidCacheLocation.desc+" Provided value: "+e+". Possible values are: "+T.cacheLocationLocal+", "+T.cacheLocationSession+".")},t.createNoStorageSupportedError=function(){return new t(pe.noStorageSupported.code,pe.noStorageSupported.desc)},t.createRedirectCallbacksNotSetError=function(){return new t(pe.noRedirectCallbacksSet.code,pe.noRedirectCallbacksSet.desc)},t.createInvalidCallbackObjectError=function(e){return new t(pe.invalidCallbackObject.code,pe.invalidCallbackObject.desc+" Given value for callback function: "+e)},t.createEmptyScopesArrayError=function(e){return new t(pe.emptyScopes.code,pe.emptyScopes.desc+" Given value: "+e+".")},t.createScopesNonArrayError=function(e){return new t(pe.nonArrayScopes.code,pe.nonArrayScopes.desc+" Given value: "+e+".")},t.createClientIdSingleScopeError=function(e){return new t(pe.clientScope.code,pe.clientScope.desc+" Given value: "+e+".")},t.createScopesRequiredError=function(e){return new t(pe.scopesRequired.code,pe.scopesRequired.desc+" Given value: "+e)},t.createInvalidPromptError=function(e){return new t(pe.invalidPrompt.code,pe.invalidPrompt.desc+" Given value: "+e)},t.createClaimsRequestParsingError=function(e){return new t(pe.claimsRequestParsingError.code,pe.claimsRequestParsingError.desc+" Given value: "+e)},t.createEmptyRequestError=function(){var e=pe.emptyRequestError;return new t(e.code,e.desc)},t.createTelemetryConfigError=function(e){var n=pe.telemetryConfigError,r=n.code,o=n.desc,i={applicationName:"string",applicationVersion:"string",telemetryEmitter:"function"};return new t(r,o+" mising values: "+Object.keys(i).reduce(function(t,n){return e[n]?t:t.concat([n+" ("+i[n]+")"])},[]).join(","))},t}(he);var ge,me=function(){function e(e,t,n,r,o,i){this.authorityInstance=e,this.clientId=t,this.scopes=n?n.slice():[t],this.nonce=S.createNewGuid(),this.state=i&&!D.isEmpty(i)?S.createNewGuid()+"|"+i:S.createNewGuid(),this.correlationId=S.createNewGuid(),this.xClientSku="MSAL.JS",this.xClientVer="1.1.3",this.responseType=r,this.redirectUri=o}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance?this.authorityInstance.CanonicalAuthority:null},enumerable:!0,configurable:!0}),e.prototype.populateQueryParams=function(t,n,r){var o,i={};n&&(n.prompt&&(this.validatePromptParameter(n.prompt),this.promptValue=n.prompt),n.claimsRequest&&(!function(e){if(e.claimsRequest)try{JSON.parse(e.claimsRequest)}catch(e){throw fe.createClaimsRequestParsingError(e)}}(n),this.claimsValue=n.claimsRequest),e.isSSOParam(n)&&(i=this.constructUnifiedCacheQueryParameter(n,null))),r&&(i=this.constructUnifiedCacheQueryParameter(null,r)),i=this.addHintParameters(t,i),n&&(o=this.sanitizeEQParams(n)),this.queryParameters=e.generateQueryParametersString(i),this.extraQueryParameters=e.generateQueryParametersString(o)},e.prototype.validatePromptParameter=function(e){if(!([M.LOGIN,M.SELECT_ACCOUNT,M.CONSENT,M.NONE].indexOf(e)>=0))throw fe.createInvalidPromptError(e)},e.prototype.constructUnifiedCacheQueryParameter=function(e,t){var n,r,o={};if(e)if(e.account){var i=e.account;i.sid?(n=P,r=i.sid):i.userName&&(n=R,r=i.userName)}else e.sid?(n=P,r=e.sid):e.loginHint&&(n=R,r=e.loginHint);else t&&(t.hasOwnProperty(T.upn)?(n=O,r=t.upn):(n=x,r=null));return o=this.addSSOParameter(n,r),e&&e.account&&e.account.homeAccountIdentifier&&(o=this.addSSOParameter(U,e.account.homeAccountIdentifier,o)),o},e.prototype.addHintParameters=function(e,t){if(e&&!t[P]){if(!t[R]&&e.sid&&this.promptValue===M.NONE)t=this.addSSOParameter(P,e.sid,t);else!t[R]&&e.userName&&!D.isEmpty(e.userName)&&(t=this.addSSOParameter(R,e.userName,t));!t[L]&&!t[j]&&(t=this.addSSOParameter(U,e.homeAccountIdentifier,t))}return t},e.prototype.addSSOParameter=function(e,t,n){if(n||(n={}),!t)return n;switch(e){case P:n[P]=t;break;case O:n[R]=t,n[_]=x;break;case R:n[R]=t;break;case x:n[_]=x;break;case q:n[_]=q;break;case U:var r=t.split("."),o=S.base64Decode(r[0]),i=S.base64Decode(r[1]);n[j]=o,n[L]=i,i===T.consumersUtid?n[_]=q:n[_]=x;break;case j:n[j]=t;break;case L:n[L]=t}return n},e.prototype.sanitizeEQParams=function(e){var t=e.extraQueryParameters;return t?(e.claimsRequest&&delete t[T.claims],N.forEach(function(e){t[e]&&delete t[e]}),t):null},e.generateQueryParametersString=function(e){var t=null;return e&&Object.keys(e).forEach(function(n){null==t?t=n+"="+encodeURIComponent(e[n]):t+="&"+n+"="+encodeURIComponent(e[n])}),t},e.isSSOParam=function(e){return e&&(e.account||e.sid||e.loginHint)},e}(),ye=function(){function e(e){if(!e||D.isEmpty(e))return this.uid="",void(this.utid="");try{var t=S.base64Decode(e),n=JSON.parse(t);n&&(n.hasOwnProperty("uid")&&(this.uid=n.uid),n.hasOwnProperty("utid")&&(this.utid=n.utid))}catch(e){throw he.createClientInfoDecodingError(e)}}return Object.defineProperty(e.prototype,"uid",{get:function(){return this._uid?this._uid:""},set:function(e){this._uid=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utid",{get:function(){return this._utid?this._utid:""},set:function(e){this._utid=e},enumerable:!0,configurable:!0}),e}(),ve=function(){function e(){}return e.decodeJwt=function(e){if(D.isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?null:{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},e.extractIdToken=function(e){var t=this.decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=S.base64Decode(n);return r?JSON.parse(r):null}catch(e){}return null},e}(),we=function(){return function(e){if(D.isEmpty(e))throw he.createIdTokenNullOrEmptyError(e);try{this.rawIdToken=e,this.claims=ve.extractIdToken(e),this.claims&&(this.claims.hasOwnProperty("iss")&&(this.issuer=this.claims.iss),this.claims.hasOwnProperty("oid")&&(this.objectId=this.claims.oid),this.claims.hasOwnProperty("sub")&&(this.subject=this.claims.sub),this.claims.hasOwnProperty("tid")&&(this.tenantId=this.claims.tid),this.claims.hasOwnProperty("ver")&&(this.version=this.claims.ver),this.claims.hasOwnProperty("preferred_username")&&(this.preferredName=this.claims.preferred_username),this.claims.hasOwnProperty("name")&&(this.name=this.claims.name),this.claims.hasOwnProperty("nonce")&&(this.nonce=this.claims.nonce),this.claims.hasOwnProperty("exp")&&(this.expiration=this.claims.exp),this.claims.hasOwnProperty("home_oid")&&(this.homeObjectId=this.claims.home_oid),this.claims.hasOwnProperty("sid")&&(this.sid=this.claims.sid))}catch(e){throw he.createIdTokenParsingError(e)}}}(),Ie=function(){return function(e,t){this.key=e,this.value=t}}(),ke=function(){function e(t){if(e.instance)return e.instance;if(this.cacheLocation=t,this.localStorageSupported=void 0!==window[this.cacheLocation]&&null!=window[this.cacheLocation],this.sessionStorageSupported=void 0!==window[t]&&null!=window[t],e.instance=this,!this.localStorageSupported&&!this.sessionStorageSupported)throw fe.createNoStorageSupportedError();return e.instance}return e.prototype.setItem=function(e,t,n){window[this.cacheLocation]&&window[this.cacheLocation].setItem(e,t),n&&this.setItemCookie(e,t)},e.prototype.getItem=function(e,t){return t&&this.getItemCookie(e)?this.getItemCookie(e):window[this.cacheLocation]?window[this.cacheLocation].getItem(e):null},e.prototype.removeItem=function(e){if(window[this.cacheLocation])return window[this.cacheLocation].removeItem(e)},e.prototype.clear=function(){if(window[this.cacheLocation])return window[this.cacheLocation].clear()},e.prototype.getAllAccessTokens=function(e,t){var n,r=[],o=window[this.cacheLocation];if(o){var i=void 0;for(i in o)if(o.hasOwnProperty(i)&&i.match(e)&&i.match(t)){var a=this.getItem(i);a&&(n=new Ie(JSON.parse(i),JSON.parse(a)),r.push(n))}}return r},e.prototype.removeAcquireTokenEntries=function(e){var t=window[this.cacheLocation];if(t){var n=void 0;for(n in t)if(t.hasOwnProperty(n)&&!(-1===n.indexOf(C)&&1===n.indexOf(E)||e&&-1===n.indexOf(e))){var r=n.split(T.resourceDelimiter),o=void 0;r.length>1&&(o=r[1]),o&&!this.tokenRenewalInProgress(o)&&(this.removeItem(n),this.removeItem(T.renewStatus+o),this.removeItem(T.stateLogin),this.removeItem(T.stateAcquireToken),this.setItemCookie(n,"",-1))}}this.clearCookie()},e.prototype.tokenRenewalInProgress=function(e){var t=window[this.cacheLocation][T.renewStatus+e];return!(!t||t!==T.tokenRenewStatusInProgress)},e.prototype.resetCacheItems=function(){var e=window[this.cacheLocation];if(e){var t=void 0;for(t in e)e.hasOwnProperty(t)&&-1!==t.indexOf(T.msal)&&this.removeItem(t);this.removeAcquireTokenEntries()}},e.prototype.setItemCookie=function(e,t,n){var r=e+"="+t+";";n&&(r+="expires="+this.getCookieExpirationTime(n)+";");document.cookie=r},e.prototype.getItemCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},e.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3).toUTCString()},e.prototype.clearCookie=function(){this.setItemCookie(T.nonceIdToken,"",-1),this.setItemCookie(T.stateLogin,"",-1),this.setItemCookie(T.loginRequest,"",-1),this.setItemCookie(T.stateAcquireToken,"",-1)},e.generateAcquireTokenAccountKey=function(e,t){return E+T.resourceDelimiter+""+e+T.resourceDelimiter+t},e.generateAuthorityKey=function(e){return C+T.resourceDelimiter+""+e},e}(),be=function(){function e(e,t,n,r,o,i,a){this.accountIdentifier=e,this.homeAccountIdentifier=t,this.userName=n,this.name=r,this.idToken=o,this.idTokenClaims=o,this.sid=i,this.environment=a}return e.createAccount=function(t,n){var r,o=t.objectId||t.subject,i=n?n.uid:"",a=n?n.utid:"";return D.isEmpty(i)||D.isEmpty(a)||(r=S.base64Encode(i)+"."+S.base64Encode(a)),new e(o,r,t.preferredName,t.name,t.claims,t.sid,t.issuer)},e.compareAccounts=function(e,t){return!(!e||!t)&&!(!e.homeAccountIdentifier||!t.homeAccountIdentifier||e.homeAccountIdentifier!==t.homeAccountIdentifier)},e}(),Se=function(){function e(){}return e.parseExpiresIn=function(e){return e||(e="3599"),parseInt(e,10)},e.now=function(){return Math.round((new Date).getTime()/1e3)},e}(),Te=function(){function e(){}return e.setResponseIdToken=function(e,t){if(!e)return null;if(!t)return e;var n=Number(t.expiration);return n&&!e.expiresOn&&(e.expiresOn=new Date(1e3*n)),p({},e,{idToken:t,idTokenClaims:t.claims,uniqueId:t.objectId||t.subject,tenantId:t.tenantId})},e}(),Ce=function(){function e(){}return e.prototype.sendRequestAsync=function(e,t,n){var r=this;return new Promise(function(n,o){var i=new XMLHttpRequest;if(i.open(t,e,!0),i.onload=function(e){(i.status<200||i.status>=300)&&o(r.handleError(i.responseText));try{var t=JSON.parse(i.responseText)}catch(e){o(r.handleError(i.responseText))}n(t)},i.onerror=function(e){o(i.status)},"GET"!==t)throw"not implemented";i.send()})},e.prototype.handleError=function(e){var t;try{if((t=JSON.parse(e)).error)return t.error;throw e}catch(t){return e}},e}();!function(e){e[e.Aad=0]="Aad",e[e.Adfs=1]="Adfs",e[e.B2C=2]="B2C"}(ge||(ge={}));var Ee,Ae=function(e){function t(t,n){return e.call(this,t,n)||this}return h(t,e),Object.defineProperty(t.prototype,"AadInstanceDiscoveryEndpointUrl",{get:function(){return t.AadInstanceDiscoveryEndpoint+"?api-version=1.0&authorization_endpoint="+this.CanonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return ge.Aad},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){var e=this,t=new Promise(function(t,n){return t(e.DefaultOpenIdConfigurationEndpoint)});if(!this.IsValidationEnabled)return t;var n=this.CanonicalAuthorityUrlComponents.HostNameAndPort;return this.IsInTrustedHostList(n)?t:(new Ce).sendRequestAsync(this.AadInstanceDiscoveryEndpointUrl,"GET",!0).then(function(e){return e.tenant_discovery_endpoint})},t.prototype.IsInTrustedHostList=function(e){return A[e.toLowerCase()]},t.AadInstanceDiscoveryEndpoint="https://login.microsoftonline.com/common/discovery/instance",t}(function(){function e(e,t){this.IsValidationEnabled=t,this.CanonicalAuthority=e,this.validateAsUri()}return Object.defineProperty(e.prototype,"Tenant",{get:function(){return this.CanonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"AuthorizationEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.AuthorizationEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndSessionEndpoint",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.EndSessionEndpoint.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SelfSignedJwtAudience",{get:function(){return this.validateResolved(),this.tenantDiscoveryResponse.Issuer.replace("{tenant}",this.Tenant)},enumerable:!0,configurable:!0}),e.prototype.validateResolved=function(){if(!this.tenantDiscoveryResponse)throw"Please call ResolveEndpointsAsync first"},Object.defineProperty(e.prototype,"CanonicalAuthority",{get:function(){return this.canonicalAuthority},set:function(e){this.canonicalAuthority=K.CanonicalizeUri(e),this.canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanonicalAuthorityUrlComponents",{get:function(){return this.canonicalAuthorityUrlComponents||(this.canonicalAuthorityUrlComponents=K.GetUrlComponents(this.CanonicalAuthority)),this.canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DefaultOpenIdConfigurationEndpoint",{get:function(){return this.CanonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),e.prototype.validateAsUri=function(){var e;try{e=this.CanonicalAuthorityUrlComponents}catch(e){throw pe.invalidAuthorityType}if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw pe.authorityUriInsecure;if(!e.PathSegments||e.PathSegments.length<1)throw pe.authorityUriInvalidPath},e.prototype.DiscoverEndpoints=function(e){return(new Ce).sendRequestAsync(e,"GET",!0).then(function(e){return{AuthorizationEndpoint:e.authorization_endpoint,EndSessionEndpoint:e.end_session_endpoint,Issuer:e.issuer}})},e.prototype.resolveEndpointsAsync=function(){var e=this,t="";return this.GetOpenIdConfigurationEndpointAsync().then(function(n){return t=n,e.DiscoverEndpoints(t)}).then(function(t){return e.tenantDiscoveryResponse=t,e})},e}()),Pe=function(e){function t(t,n){var r=e.call(this,t,n)||this,o=K.GetUrlComponents(t),i=o.PathSegments;if(i.length<3)throw pe.b2cAuthorityUriInvalidPath;return r.CanonicalAuthority="https://"+o.HostNameAndPort+"/"+i[0]+"/"+i[1]+"/"+i[2]+"/",r}return h(t,e),Object.defineProperty(t.prototype,"AuthorityType",{get:function(){return ge.B2C},enumerable:!0,configurable:!0}),t.prototype.GetOpenIdConfigurationEndpointAsync=function(){var e=this,t=new Promise(function(t,n){return t(e.DefaultOpenIdConfigurationEndpoint)});return this.IsValidationEnabled?this.IsInTrustedHostList(this.CanonicalAuthorityUrlComponents.HostNameAndPort)?t:new Promise(function(e,t){return t(pe.unsupportedAuthorityValidation)}):t},t.B2C_PREFIX="tfp",t}(Ae),Re=function(){function e(){}return e.DetectAuthorityFromUrl=function(e){switch(e=K.CanonicalizeUri(e),K.GetUrlComponents(e).PathSegments[0]){case"tfp":return ge.B2C;case"adfs":return ge.Adfs;default:return ge.Aad}},e.CreateInstance=function(t,n){if(D.isEmpty(t))return null;switch(e.DetectAuthorityFromUrl(t)){case ge.B2C:return new Pe(t,n);case ge.Aad:return new Ae(t,n);default:throw pe.invalidAuthorityType}},e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(Ee||(Ee={}));var Oe=function(){function e(e,t){void 0===t&&(t={}),this.level=Ee.Info;var n=t.correlationId,r=void 0===n?"":n,o=t.level,i=void 0===o?Ee.Info:o,a=t.piiLoggingEnabled,s=void 0!==a&&a;this.localCallback=e,this.correlationId=r,this.level=i,this.piiLoggingEnabled=s}return e.prototype.logMessage=function(e,t,n){if(!(e>this.level||!this.piiLoggingEnabled&&n)){var r,o=(new Date).toUTCString();r=D.isEmpty(this.correlationId)?o+":1.1.3-"+Ee[e]+" "+t:o+":"+this.correlationId+"-1.1.3-"+Ee[e]+" "+t,this.executeCallback(e,r,n)}},e.prototype.executeCallback=function(e,t,n){this.localCallback&&this.localCallback(e,t,n)},e.prototype.error=function(e){this.logMessage(Ee.Error,e,!1)},e.prototype.errorPii=function(e){this.logMessage(Ee.Error,e,!0)},e.prototype.warning=function(e){this.logMessage(Ee.Warning,e,!1)},e.prototype.warningPii=function(e){this.logMessage(Ee.Warning,e,!0)},e.prototype.info=function(e){this.logMessage(Ee.Info,e,!1)},e.prototype.infoPii=function(e){this.logMessage(Ee.Info,e,!0)},e.prototype.verbose=function(e){this.logMessage(Ee.Verbose,e,!1)},e.prototype.verbosePii=function(e){this.logMessage(Ee.Verbose,e,!0)},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled},e}(),_e={clientId:"",authority:null,validateAuthority:!0,redirectUri:function(){return K.getDefaultRedirectUri()},postLogoutRedirectUri:function(){return K.getDefaultRedirectUri()},navigateToLoginRequestUrl:!0},xe={cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},qe={logger:new Oe(null),loadFrameTimeout:6e3,tokenRenewalOffsetSeconds:300,navigateFrameWait:500},Ue={isAngular:!1,unprotectedResources:new Array,protectedResourceMap:new Map};var je={code:"server_unavailable",desc:"Server is temporarily unavailable."},Le={code:"unknown_server_error"},Ne=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.name="ServerError",Object.setPrototypeOf(o,t.prototype),o}return h(t,e),t.createServerUnavailableError=function(){return new t(je.code,je.desc)},t.createUnknownServerError=function(e){return new t(Le.code,e)},t}(V),Me={code:"interaction_required"},He={code:"consent_required"},De={code:"login_required"},Ke=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.name="InteractionRequiredAuthError",Object.setPrototypeOf(o,t.prototype),o}return h(t,e),t.isInteractionRequiredError=function(e){var t=[Me.code,He.code,De.code];return e&&t.indexOf(e)>-1},t.createLoginRequiredAuthError=function(e){return new t(De.code,e)},t.createInteractionRequiredAuthError=function(e){return new t(Me.code,e)},t.createConsentRequiredAuthError=function(e){return new t(He.code,e)},t}(Ne);function Fe(e){return{uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:"",scopes:null,expiresOn:null,account:null,accountState:e}}var We="event_name",Ge="start_time",Ve="elapsed_time",ze={MsalCorrelationIdConstStrKey:"Microsoft.MSAL.correlation_id",ApiTelemIdConstStrKey:"msal.api_telem_id",ApiIdConstStrKey:"msal.api_id",BrokerAppConstStrKey:"Microsoft_MSAL_broker_app",CacheEventCountConstStrKey:"Microsoft_MSAL_cache_event_count",HttpEventCountTelemetryBatchKey:"Microsoft_MSAL_http_event_count",IdpConstStrKey:"Microsoft_MSAL_idp",IsSilentTelemetryBatchKey:"",IsSuccessfulConstStrKey:"Microsoft_MSAL_is_successful",ResponseTimeConstStrKey:"Microsoft_MSAL_response_time",TenantIdConstStrKey:"Microsoft_MSAL_tenant_id",UiEventCountTelemetryBatchKey:"Microsoft_MSAL_ui_event_count"},Je=function(e){return"msal."+(e||"")},Be=function(e){function t(t,n,r,o){var i=e.call(this,Je("default_event"),n)||this;return i.event[Je("client_id")]=r,i.event[Je("sdk_plaform")]=t.sdk,i.event[Je("sdk_version")]=t.sdkVersion,i.event[Je("application_name")]=t.applicationName,i.event[Je("application_version")]=t.applicationVersion,i.event[""+ze.UiEventCountTelemetryBatchKey]=i.getEventCount(Je("ui_event"),o),i.event[""+ze.HttpEventCountTelemetryBatchKey]=i.getEventCount(Je("http_event"),o),i.event[""+ze.CacheEventCountConstStrKey]=i.getEventCount(Je("cache_event"),o),i}return h(t,e),t.prototype.getEventCount=function(e,t){return t[e]?t[e]:0},t}(function(){function e(e,t){var n;this.startTimestamp=Date.now(),this.eventId=S.createNewGuid(),this.event=((n={})[Je(We)]=e,n[Je(Ge)]=this.startTimestamp,n[Je(Ve)]=-1,n[""+ze.MsalCorrelationIdConstStrKey]=t,n)}return e.prototype.setElapsedTime=function(e){this.event[Je(Ve)]=e},e.prototype.stop=function(){this.setElapsedTime(+Date.now()-+this.startTimestamp)},Object.defineProperty(e.prototype,"telemetryCorrelationId",{get:function(){return this.event[""+ze.MsalCorrelationIdConstStrKey]},set:function(e){this.event[""+ze.MsalCorrelationIdConstStrKey]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventName",{get:function(){return this.event[Je(We)]},enumerable:!0,configurable:!0}),e.prototype.get=function(){return p({},this.event,{eventId:this.eventId})},e}()),Qe=function(e){return e.telemetryCorrelationId+"-"+e.eventId+"-"+e.eventName},Xe=function(){function e(e,t){this.completedEvents={},this.inProgressEvents={},this.eventCountByCorrelationId={},this.onlySendFailureTelemetry=!1,this.telemetryPlatform=e.platform,this.clientId=e.clientId,this.onlySendFailureTelemetry=e.onlySendFailureTelemetry,this.telemetryEmitter=t}return e.prototype.startEvent=function(e){if(this.telemetryEmitter){var t=Qe(e);this.inProgressEvents[t]=e}},e.prototype.stopEvent=function(e){var t=Qe(e);if(this.telemetryEmitter&&this.inProgressEvents[t]){e.stop(),this.incrementEventCount(e);var n=this.completedEvents[e.telemetryCorrelationId];this.completedEvents[e.telemetryCorrelationId]=(n||[]).concat([e]),delete this.inProgressEvents[t]}},e.prototype.flush=function(e){var t=this;if(this.telemetryEmitter&&this.completedEvents[e]){var n=this.getOrphanedEvents(e);n.forEach(function(e){return t.incrementEventCount(e)});var r=this.completedEvents[e].concat(n);delete this.completedEvents[e];var o=this.eventCountByCorrelationId[e];if(delete this.eventCountByCorrelationId[e],r&&r.length){var i=new Be(this.telemetryPlatform,e,this.clientId,o),a=r.concat([i]);this.telemetryEmitter(a.map(function(e){return e.get()}))}}},e.prototype.incrementEventCount=function(e){var t,n=e.eventName,r=this.eventCountByCorrelationId[e.telemetryCorrelationId];r?r[n]=r[n]?r[n]+1:1:this.eventCountByCorrelationId[e.telemetryCorrelationId]=((t={})[n]=1,t)},e.prototype.getOrphanedEvents=function(e){var t=this;return Object.keys(this.inProgressEvents).reduce(function(n,r){if(-1!==r.indexOf(e)){var o=t.inProgressEvents[r];return delete t.inProgressEvents[r],n.concat([o])}return n},[])},e}(),Ye="https://login.microsoftonline.com/common",$e="id_token",Ze="token",et="id_token token",tt=function(e,t,n){var r=n.value;return n.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.isInIframe()?new Promise(function(){}):r.apply(this,e)},n},nt=function(){function e(e){var t,n,r,o,i,a,s,c;this.authResponseCallback=null,this.tokenReceivedCallback=null,this.errorReceivedCallback=null,this.config=(n=(t=e).auth,r=t.cache,o=void 0===r?{}:r,i=t.system,a=void 0===i?{}:i,s=t.framework,c=void 0===s?{}:s,{auth:p({},_e,n),cache:p({},xe,o),system:p({},qe,a),framework:p({},Ue,c)}),this.redirectCallbacksSet=!1,this.logger=this.config.system.logger,this.clientId=this.config.auth.clientId,this.inCookie=this.config.cache.storeAuthStateInCookie,this.telemetryManager=this.getTelemetryManagerFromConfig(this.config.system.telemetry,this.clientId),this.authority=this.config.auth.authority||Ye,this.loginInProgress=!1,this.acquireTokenInProgress=!1;try{this.cacheStorage=new ke(this.config.cache.cacheLocation)}catch(e){throw fe.createInvalidCacheLocationConfigError(this.config.cache.cacheLocation)}window.openedWindows=[],window.activeRenewals={},window.renewStates=[],window.callbackMappedToRenewStates={},window.promiseMappedToRenewStates={},window.msal=this;var u=window.location.hash,l=this.urlContainsHash(u);this.config.framework.isAngular||l&&this.handleAuthenticationResponse(u)}return Object.defineProperty(e.prototype,"authority",{get:function(){return this.authorityInstance.CanonicalAuthority},set:function(e){this.authorityInstance=Re.CreateInstance(e,this.config.auth.validateAuthority)},enumerable:!0,configurable:!0}),e.prototype.getAuthorityInstance=function(){return this.authorityInstance},e.prototype.handleRedirectCallback=function(e,t){if(!e)throw this.redirectCallbacksSet=!1,fe.createInvalidCallbackObjectError(e);if(t?(this.tokenReceivedCallback=e,this.errorReceivedCallback=t,this.logger.warning("This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).")):this.authResponseCallback=e,this.redirectCallbacksSet=!0,!this.config.framework.isAngular){var n=this.cacheStorage.getItem(T.urlHash);n&&this.processCallBack(n,null)}},e.prototype.authResponseHandler=function(e,t,n){if(e===T.interactionTypeRedirect)this.errorReceivedCallback?this.tokenReceivedCallback(t):this.authResponseCallback&&this.authResponseCallback(null,t);else{if(e!==T.interactionTypePopup)throw he.createInvalidInteractionTypeError();n(t)}},e.prototype.authErrorHandler=function(e,t,n,r){if(e===T.interactionTypeRedirect)this.errorReceivedCallback?this.errorReceivedCallback(t,n.accountState):this.authResponseCallback(t,n);else{if(e!==T.interactionTypePopup)throw he.createInvalidInteractionTypeError();r(t)}},e.prototype.loginRedirect=function(e){if(!this.redirectCallbacksSet)throw fe.createRedirectCallbacksNotSetError();this.acquireTokenInteractive(T.interactionTypeRedirect,!0,e)},e.prototype.acquireTokenRedirect=function(e){if(!e)throw fe.createEmptyRequestError();if(!this.redirectCallbacksSet)throw fe.createRedirectCallbacksNotSetError();this.acquireTokenInteractive(T.interactionTypeRedirect,!1,e)},e.prototype.loginPopup=function(e){var t=this;return new Promise(function(n,r){t.acquireTokenInteractive(T.interactionTypePopup,!0,e,n,r)})},e.prototype.acquireTokenPopup=function(e){var t=this;if(!e)throw fe.createEmptyRequestError();return new Promise(function(n,r){t.acquireTokenInteractive(T.interactionTypePopup,!1,e,n,r)})},e.prototype.acquireTokenInteractive=function(e,t,n,r,o){var i=this;if(this.loginInProgress||this.acquireTokenInProgress){var a=this.loginInProgress?he.createLoginInProgressError():he.createAcquireTokenInProgressError(),s=Fe(this.getAccountState(n&&n.state));this.authErrorHandler(e,a,s,o)}else{var c=t?this.appendScopes(n):n.scopes;this.validateInputScope(c,!t);var u=n&&n.account&&!t?n.account:this.getAccount();if(u||me.isSSOParam(n))this.acquireTokenHelper(u,e,t,n,c,r,o);else{if(!t)throw this.logger.info("User login is required"),he.createUserLoginRequiredError();if(this.extractADALIdToken()&&!c){this.logger.info("ADAL's idToken exists. Extracting login information from ADAL's idToken ");var l=this.buildIDTokenRequest(n);this.silentLogin=!0,this.acquireTokenSilent(l).then(function(t){i.silentLogin=!1,i.logger.info("Unified cache call is successful"),i.authResponseHandler(e,t,r)},function(a){i.silentLogin=!1,i.logger.error("Error occurred during unified cache ATS: "+a),i.acquireTokenHelper(null,e,t,n,c,r,o)})}else this.acquireTokenHelper(null,e,t,n,c,r,o)}}},e.prototype.acquireTokenHelper=function(e,t,n,r,o,i,a){var s=this;n?this.loginInProgress=!0:this.acquireTokenInProgress=!0;var c,u,l=o?o.join(" ").toLowerCase():this.clientId.toLowerCase(),d=!n&&r&&r.authority?Re.CreateInstance(r.authority,this.config.auth.validateAuthority):this.authorityInstance;(t!==T.interactionTypePopup||(u=this.openWindow("about:blank","_blank",1,this,i,a)))&&d.resolveEndpointsAsync().then(function(){var h,p=n?$e:s.getTokenType(e,o,!1);n&&((h=s.cacheStorage.getItem(T.angularLoginRequest))&&""!==h?s.cacheStorage.setItem(T.angularLoginRequest,""):h=window.location.href),c=new me(d,s.clientId,o,p,s.getRedirectUri(),r&&r.state),s.updateCacheEntries(c,e,h),c.populateQueryParams(e,r);var f=K.createNavigateUrl(c)+T.response_mode_fragment;if(t===T.interactionTypeRedirect)n||s.cacheStorage.setItem(T.stateAcquireToken,c.state,s.inCookie);else{if(t!==T.interactionTypePopup)throw he.createInvalidInteractionTypeError();window.renewStates.push(c.state),window.requestType=n?T.login:T.renewToken,s.registerCallback(c.state,l,i,a)}s.navigateWindow(f,u)}).catch(function(e){s.logger.warning("could not resolve endpoints"),s.authErrorHandler(t,he.createEndpointResolutionError(e.toString),Fe(r.state),a),u&&u.close()})},e.prototype.acquireTokenSilent=function(e){var t=this;if(!e)throw fe.createEmptyRequestError();return new Promise(function(n,r){t.validateInputScope(e.scopes,!0);var o=e.scopes.join(" ").toLowerCase(),i=e.account||t.getAccount(),a=t.cacheStorage.getItem(T.adalIdToken);if(!i&&!e.sid&&!e.loginHint&&D.isEmpty(a))return t.logger.info("User login is required"),r(he.createUserLoginRequiredError());var s=t.getTokenType(i,e.scopes,!0),c=new me(Re.CreateInstance(e.authority,t.config.auth.validateAuthority),t.clientId,e.scopes,s,t.getRedirectUri(),e&&e.state);if(me.isSSOParam(e)||i)c.populateQueryParams(i,e);else if(!i&&!D.isEmpty(a)){var u=ve.extractIdToken(a);t.logger.verbose("ADAL's idToken exists. Extracting login information from ADAL's idToken "),c.populateQueryParams(i,null,u)}var l,d,h=e.claimsRequest||c.claimsValue;if(!h&&!e.forceRefresh)try{d=t.getCachedToken(c,i)}catch(e){l=e}if(d)return t.logger.info("Token is already in cache for scope:"+o),n(d),null;if(l)return t.logger.infoPii(l.errorCode+":"+l.errorMessage),r(l),null;var p=void 0;return p=h?"Skipped cache lookup since claims were given.":e.forceRefresh?"Skipped cache lookup since request.forceRefresh option was set to true":"Token is not in cache for scope:"+o,t.logger.verbose(p),c.authorityInstance||(c.authorityInstance=e.authority?Re.CreateInstance(e.authority,t.config.auth.validateAuthority):t.authorityInstance),c.authorityInstance.resolveEndpointsAsync().then(function(){window.activeRenewals[o]?(t.logger.verbose("Renew token for scope: "+o+" is in progress. Registering callback"),t.registerCallback(window.activeRenewals[o],o,n,r)):e.scopes&&e.scopes.indexOf(t.clientId)>-1&&1===e.scopes.length?(t.logger.verbose("renewing idToken"),t.silentLogin=!0,t.renewIdToken(e.scopes,n,r,i,c)):(t.logger.verbose("renewing accesstoken"),t.renewToken(e.scopes,n,r,i,c))}).catch(function(e){return t.logger.warning("could not resolve endpoints"),r(he.createEndpointResolutionError(e.toString())),null})})},e.prototype.openWindow=function(e,t,n,r,o,i){var a,s=this;try{a=this.openPopup(e,t,T.popUpWidth,T.popUpHeight)}catch(e){return r.loginInProgress=!1,r.acquireTokenInProgress=!1,this.logger.info(Q.code+":"+Q.desc),this.cacheStorage.setItem(T.msalError,Q.code),this.cacheStorage.setItem(T.msalErrorDescription,Q.desc),i&&i(he.createPopupWindowError()),null}window.openedWindows.push(a);var c=window.setInterval(function(){if(a&&a.closed&&(r.loginInProgress||r.acquireTokenInProgress)){if(i&&i(he.createUserCancelledError()),window.clearInterval(c),s.config.framework.isAngular)return void s.broadcast("msal:popUpClosed",ne.code+T.resourceDelimiter+ne.desc);r.loginInProgress=!1,r.acquireTokenInProgress=!1}try{var e=a.location;if(-1!==e.href.indexOf(s.getRedirectUri())&&(window.clearInterval(c),r.loginInProgress=!1,r.acquireTokenInProgress=!1,s.logger.info("Closing popup window"),s.config.framework.isAngular)){s.broadcast("msal:popUpHashChanged",e.hash);for(var t=0;t<window.openedWindows.length;t++)window.openedWindows[t].close()}}catch(e){}},n);return a},e.prototype.openPopup=function(e,t,n,r){try{var o=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=a/2-n/2+o,u=s/2-r/2+i,l=window.open(e,t,"width="+n+", height="+r+", top="+u+", left="+c);if(!l)throw he.createPopupWindowError();return l.focus&&l.focus(),l}catch(e){throw this.logger.error("error opening popup "+e.message),this.loginInProgress=!1,this.acquireTokenInProgress=!1,he.createPopupWindowError(e.toString())}},e.prototype.isInIframe=function(){return window.parent!==window},e.prototype.parentIsMsal=function(){return window.parent!==window&&window.parent.msal},e.prototype.loadIframeTimeout=function(e,t,n){var r=this,o=window.activeRenewals[n];this.logger.verbose("Set loading state to pending for: "+n+":"+o),this.cacheStorage.setItem(T.renewStatus+o,T.tokenRenewStatusInProgress),this.loadFrame(e,t),setTimeout(function(){r.cacheStorage.getItem(T.renewStatus+o)===T.tokenRenewStatusInProgress&&(r.logger.verbose("Loading frame has timed out after: "+r.config.system.loadFrameTimeout/1e3+" seconds for scope "+n+":"+o),o&&window.callbackMappedToRenewStates[o]&&window.callbackMappedToRenewStates[o](null,he.createTokenRenewalTimeoutError()),r.cacheStorage.setItem(T.renewStatus+o,T.tokenRenewStatusCancelled))},this.config.system.loadFrameTimeout)},e.prototype.loadFrame=function(e,t){var n=this;this.logger.info("LoadFrame: "+t);var r=t;setTimeout(function(){var o=n.addHiddenIFrame(r);""!==o.src&&"about:blank"!==o.src||(o.src=e,n.logger.infoPii("Frame Name : "+t+" Navigated to: "+e))},this.config.system.navigateFrameWait)},e.prototype.addHiddenIFrame=function(e){if(void 0===e)return null;this.logger.info("Add msal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&-1===window.navigator.userAgent.indexOf("MSIE 5.0")){var n=document.createElement("iframe");n.setAttribute("id",e),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeend","<iframe name='"+e+"' id='"+e+"' style='display:none'></iframe>");window.frames&&window.frames[e]&&(t=window.frames[e])}return t},e.prototype.navigateWindow=function(e,t){if(!e||D.isEmpty(e))throw this.logger.info("Navigate url is empty"),V.createUnexpectedError("Navigate url is empty");var n=t||window,r=t?"Navigated Popup window to:"+e:"Navigate to:"+e;this.logger.infoPii(r),n.location.replace(e)},e.prototype.registerCallback=function(e,t,n,r){var o=this;window.activeRenewals[t]=e,window.promiseMappedToRenewStates[e]||(window.promiseMappedToRenewStates[e]=[]),window.promiseMappedToRenewStates[e].push({resolve:n,reject:r}),window.callbackMappedToRenewStates[e]||(window.callbackMappedToRenewStates[e]=function(n,r){window.activeRenewals[t]=null;for(var i=0;i<window.promiseMappedToRenewStates[e].length;++i)try{if(r)window.promiseMappedToRenewStates[e][i].reject(r);else{if(!n)throw V.createUnexpectedError("Error and response are both null");window.promiseMappedToRenewStates[e][i].resolve(n)}}catch(e){o.logger.warning(e)}window.promiseMappedToRenewStates[e]=null,window.callbackMappedToRenewStates[e]=null})},e.prototype.logout=function(){var e=this;this.clearCache(),this.account=null;var t="";this.getPostLogoutRedirectUri()&&(t="post_logout_redirect_uri="+encodeURIComponent(this.getPostLogoutRedirectUri())),this.authorityInstance.resolveEndpointsAsync().then(function(n){var r=n.EndSessionEndpoint?n.EndSessionEndpoint+"?"+t:e.authority+"oauth2/v2.0/logout?"+t;e.navigateWindow(r)})},e.prototype.clearCache=function(){window.renewStates=[];for(var e=this.cacheStorage.getAllAccessTokens(T.clientId,T.homeAccountIdentifier),t=0;t<e.length;t++)this.cacheStorage.removeItem(JSON.stringify(e[t].key));this.cacheStorage.resetCacheItems(),this.cacheStorage.clearCookie()},e.prototype.clearCacheForScope=function(e){for(var t=this.cacheStorage.getAllAccessTokens(T.clientId,T.homeAccountIdentifier),n=0;n<t.length;n++){var r=t[n];r.value.accessToken===e&&this.cacheStorage.removeItem(JSON.stringify(r.key))}},e.prototype.isCallback=function(e){return this.logger.info("isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0."),this.urlContainsHash(e)},e.prototype.urlContainsHash=function(e){var t=this.deserializeHash(e);return t.hasOwnProperty(T.errorDescription)||t.hasOwnProperty(T.error)||t.hasOwnProperty(T.accessToken)||t.hasOwnProperty(T.idToken)},e.prototype.processCallBack=function(e,t,n){var r,o;this.logger.info("Processing the callback from redirect response"),t||(t=this.getResponseState(e));try{r=this.saveTokenFromHash(e,t)}catch(e){o=e}this.cacheStorage.removeItem(T.urlHash);try{this.cacheStorage.clearCookie();var i=this.getAccountState(t.state);if(r){if(t.requestType===T.renewToken||r.accessToken?(window.parent!==window?this.logger.verbose("Window is in iframe, acquiring token silently"):this.logger.verbose("acquiring token interactive in progress"),r.tokenType=T.accessToken):t.requestType===T.login&&(r.tokenType=T.idToken),!n)return void this.authResponseHandler(T.interactionTypeRedirect,r)}else if(!n)return void this.authErrorHandler(T.interactionTypeRedirect,o,Fe(i));n(r,o)}catch(e){throw this.logger.error("Error occurred in token received callback function: "+e),he.createErrorInCallbackFunction(e.toString())}},e.prototype.handleAuthenticationResponse=function(e){null==e&&(e=window.location.hash);var t=null,n=!1,r=!1;try{r=window.opener&&window.opener.msal&&window.opener.msal!==window.msal}catch(e){r=!1}r?(t=window.opener.msal,n=!0):window.parent&&window.parent.msal&&(t=window.parent.msal);var o=t.getResponseState(e),i=null;if(t.logger.info("Returned from redirect url"),this.parentIsMsal())i=window.parent.callbackMappedToRenewStates[o.state];else if(r)i=window.opener.callbackMappedToRenewStates[o.state];else{if(i=null,t.config.auth.navigateToLoginRequestUrl)return t.cacheStorage.setItem(T.urlHash,e),void(window.parent!==window||n||(window.location.href=t.cacheStorage.getItem(T.loginRequest,t.inCookie)));if(window.location.hash="",!this.redirectCallbacksSet)return void t.cacheStorage.setItem(T.urlHash,e)}if(t.processCallBack(e,o,i),r)for(var a=0;a<window.opener.openedWindows.length;a++)window.opener.openedWindows[a].close()},e.prototype.deserializeHash=function(e){var t=K.getHashFromUrl(e);return S.deserialize(t)},e.prototype.getResponseState=function(e){var t,n=this.deserializeHash(e);if(!n)throw V.createUnexpectedError("Hash was not parsed correctly.");if(!n.hasOwnProperty("state"))throw V.createUnexpectedError("Hash does not contain state.");if((t={requestType:T.unknown,state:n.state,stateMatch:!1}).state===this.cacheStorage.getItem(T.stateLogin,this.inCookie)||t.state===this.silentAuthenticationState)return t.requestType=T.login,t.stateMatch=!0,t;if(t.state===this.cacheStorage.getItem(T.stateAcquireToken,this.inCookie))return t.requestType=T.renewToken,t.stateMatch=!0,t;if(!t.stateMatch){t.requestType=window.requestType;for(var r=window.renewStates,o=0;o<r.length;o++)if(r[o]===t.state){t.stateMatch=!0;break}}return t},e.prototype.getCachedToken=function(e,t){var n=null,r=e.scopes,o=this.cacheStorage.getAllAccessTokens(this.clientId,t?t.homeAccountIdentifier:null);if(0===o.length)return null;var i=[];if(e.authority){for(a=0;a<o.length;a++){c=(s=o[a]).key.scopes.split(" ");H.containsScope(c,r)&&K.CanonicalizeUri(s.key.authority)===e.authority&&i.push(s)}if(0===i.length)return null;if(1!==i.length)throw he.createMultipleMatchingTokensInCacheError(r.toString());n=i[0]}else{for(var a=0;a<o.length;a++){var s,c=(s=o[a]).key.scopes.split(" ");H.containsScope(c,r)&&i.push(s)}if(1===i.length)n=i[0],e.authorityInstance=Re.CreateInstance(n.key.authority,this.config.auth.validateAuthority);else{if(i.length>1)throw he.createMultipleMatchingTokensInCacheError(r.toString());var u=this.getUniqueAuthority(o,"authority");if(u.length>1)throw he.createMultipleAuthoritiesInCacheError(r.toString());e.authorityInstance=Re.CreateInstance(u[0],this.config.auth.validateAuthority)}}if(null!=n){var l=Number(n.value.expiresIn),d=this.config.system.tokenRenewalOffsetSeconds||300;if(l&&l>Se.now()+d){var h=new we(n.value.idToken);if(!t&&!(t=this.getAccount()))throw V.createUnexpectedError("Account should not be null here.");var p=this.getAccountState(e.state),f={uniqueId:"",tenantId:"",tokenType:n.value.idToken===n.value.accessToken?T.idToken:T.accessToken,idToken:h,idTokenClaims:h.claims,accessToken:n.value.accessToken,scopes:n.key.scopes.split(" "),expiresOn:new Date(1e3*l),account:t,accountState:p};return Te.setResponseIdToken(f,h),f}return this.cacheStorage.removeItem(JSON.stringify(i[0].key)),null}return null},e.prototype.getUniqueAuthority=function(e,t){var n=[],r=[];return e.forEach(function(e){e.key.hasOwnProperty(t)&&-1===r.indexOf(e.key[t])&&(r.push(e.key[t]),n.push(e.key[t]))}),n},e.prototype.extractADALIdToken=function(){var e=this.cacheStorage.getItem(T.adalIdToken);return D.isEmpty(e)?null:ve.extractIdToken(e)},e.prototype.renewToken=function(e,t,n,r,o){var i=e.join(" ").toLowerCase();this.logger.verbose("renewToken is called for scope:"+i);var a=this.addHiddenIFrame("msalRenewFrame"+i);this.updateCacheEntries(o,r),this.logger.verbose("Renew token Expected state: "+o.state);var s=K.urlRemoveQueryStringParameter(K.createNavigateUrl(o),T.prompt)+T.prompt_none;window.renewStates.push(o.state),window.requestType=T.renewToken,this.registerCallback(o.state,i,t,n),this.logger.infoPii("Navigate to:"+s),a.src="about:blank",this.loadIframeTimeout(s,"msalRenewFrame"+i,i)},e.prototype.renewIdToken=function(e,t,n,r,o){this.logger.info("renewidToken is called");var i=this.addHiddenIFrame("msalIdTokenFrame");this.updateCacheEntries(o,r),this.logger.verbose("Renew Idtoken Expected state: "+o.state);var a=K.urlRemoveQueryStringParameter(K.createNavigateUrl(o),T.prompt)+T.prompt_none;this.silentLogin?(window.requestType=T.login,this.silentAuthenticationState=o.state):(window.requestType=T.renewToken,window.renewStates.push(o.state)),this.registerCallback(o.state,this.clientId,t,n),this.logger.infoPii("Navigate to:"+a),i.src="about:blank",this.loadIframeTimeout(a,"msalIdTokenFrame",this.clientId)},e.prototype.saveAccessToken=function(e,t,n,r,o){var i,a,s=p({},e),c=new ye(r);if(n.hasOwnProperty("scope")){for(var u=(i=n.scope).split(" "),l=this.cacheStorage.getAllAccessTokens(this.clientId,t),d=0;d<l.length;d++){var h=l[d];if(h.key.homeAccountIdentifier===e.account.homeAccountIdentifier){var f=h.key.scopes.split(" ");H.isIntersectingScopes(f,u)&&this.cacheStorage.removeItem(JSON.stringify(h.key))}}var g=Se.parseExpiresIn(n[T.expiresIn]);a=Se.now()+g;var m=new F(t,this.clientId,i,c.uid,c.utid),y=new W(n[T.accessToken],o.rawIdToken,a.toString(),r);this.cacheStorage.setItem(JSON.stringify(m),JSON.stringify(y)),s.accessToken=n[T.accessToken],s.scopes=u}else{i=this.clientId;m=new F(t,this.clientId,i,c.uid,c.utid);a=Number(o.expiration);y=new W(n[T.idToken],n[T.idToken],a.toString(),r);this.cacheStorage.setItem(JSON.stringify(m),JSON.stringify(y)),s.scopes=[i],s.accessToken=n[T.idToken]}return a?s.expiresOn=new Date(1e3*a):this.logger.error("Could not parse expiresIn parameter"),s},e.prototype.saveTokenFromHash=function(e,t){this.logger.info("State status:"+t.stateMatch+"; Request type:"+t.requestType),this.cacheStorage.setItem(T.msalError,""),this.cacheStorage.setItem(T.msalErrorDescription,"");var n,r={uniqueId:"",tenantId:"",tokenType:"",idToken:null,idTokenClaims:null,accessToken:null,scopes:[],expiresOn:null,account:null,accountState:""},o=this.deserializeHash(e),i="",a="",s=null;if(o.hasOwnProperty(T.errorDescription)||o.hasOwnProperty(T.error)){if(this.logger.infoPii("Error :"+o[T.error]+"; Error description:"+o[T.errorDescription]),this.cacheStorage.setItem(T.msalError,o[T.error]),this.cacheStorage.setItem(T.msalErrorDescription,o[T.errorDescription]),t.requestType===T.login&&(this.loginInProgress=!1,this.cacheStorage.setItem(T.loginError,o[T.errorDescription]+":"+o[T.error]),i=ke.generateAuthorityKey(t.state)),t.requestType===T.renewToken){this.acquireTokenInProgress=!1,i=ke.generateAuthorityKey(t.state);var c=this.getAccount(),u=void 0;u=c&&!D.isEmpty(c.homeAccountIdentifier)?c.homeAccountIdentifier:T.no_account,a=ke.generateAcquireTokenAccountKey(u,t.state)}var l=o[T.error],d=o[T.errorDescription];n=Ke.isInteractionRequiredError(l)||Ke.isInteractionRequiredError(d)?new Ke(o[T.error],o[T.errorDescription]):new Ne(o[T.error],o[T.errorDescription])}else if(t.stateMatch){this.logger.info("State is right"),o.hasOwnProperty(T.sessionState)&&this.cacheStorage.setItem(T.msalSessionState,o[T.sessionState]),r.accountState=this.getAccountState(t.state);var h="";if(o.hasOwnProperty(T.accessToken)){this.logger.info("Fragment has access token"),this.acquireTokenInProgress=!1,o.hasOwnProperty(T.idToken)?(s=new we(o[T.idToken]),r.idToken=s,r.idTokenClaims=s.claims):(s=new we(this.cacheStorage.getItem(T.idTokenKey)),r=Te.setResponseIdToken(r,s));var p=ke.generateAuthorityKey(t.state),f=this.cacheStorage.getItem(p,this.inCookie);if(D.isEmpty(f)||(f=K.replaceTenantPath(f,r.tenantId)),!o.hasOwnProperty(T.clientInfo))throw this.logger.warning("ClientInfo not received in the response from AAD"),he.createClientInfoNotPopulatedError("ClientInfo not received in the response from the server");h=o[T.clientInfo],r.account=be.createAccount(s,new ye(h));var g=void 0;g=r.account&&!D.isEmpty(r.account.homeAccountIdentifier)?r.account.homeAccountIdentifier:T.no_account,a=ke.generateAcquireTokenAccountKey(g,t.state);var m=ke.generateAcquireTokenAccountKey(T.no_account,t.state),y=this.cacheStorage.getItem(a),v=void 0;D.isEmpty(y)?D.isEmpty(this.cacheStorage.getItem(m))||(r=this.saveAccessToken(r,f,o,h,s)):(v=JSON.parse(y),r.account&&v&&be.compareAccounts(r.account,v)?(r=this.saveAccessToken(r,f,o,h,s),this.logger.info("The user object received in the response is the same as the one passed in the acquireToken request")):this.logger.warning("The account object created from the response is not the same as the one passed in the acquireToken request"))}if(o.hasOwnProperty(T.idToken)){this.logger.info("Fragment has id token"),this.loginInProgress=!1,s=new we(o[T.idToken]),r=Te.setResponseIdToken(r,s),o.hasOwnProperty(T.clientInfo)?h=o[T.clientInfo]:this.logger.warning("ClientInfo not received in the response from AAD"),i=ke.generateAuthorityKey(t.state);f=this.cacheStorage.getItem(i,this.inCookie);D.isEmpty(f)||(f=K.replaceTenantPath(f,s.tenantId)),this.account=be.createAccount(s,new ye(h)),r.account=this.account,s&&s.nonce?s.nonce!==this.cacheStorage.getItem(T.nonceIdToken,this.inCookie)?(this.account=null,this.cacheStorage.setItem(T.loginError,"Nonce Mismatch. Expected Nonce: "+this.cacheStorage.getItem(T.nonceIdToken,this.inCookie)+",Actual Nonce: "+s.nonce),this.logger.error("Nonce Mismatch.Expected Nonce: "+this.cacheStorage.getItem(T.nonceIdToken,this.inCookie)+",Actual Nonce: "+s.nonce),n=he.createNonceMismatchError(this.cacheStorage.getItem(T.nonceIdToken,this.inCookie),s.nonce)):(this.cacheStorage.setItem(T.idTokenKey,o[T.idToken]),this.cacheStorage.setItem(T.msalClientInfo,h),this.saveAccessToken(r,f,o,h,s)):(i=t.state,a=t.state,this.logger.error("Invalid id_token received in the response"),n=he.createInvalidIdTokenError(s),this.cacheStorage.setItem(T.msalError,n.errorCode),this.cacheStorage.setItem(T.msalErrorDescription,n.errorMessage))}}else{i=t.state,a=t.state;var w=this.cacheStorage.getItem(T.stateLogin,this.inCookie);this.logger.error("State Mismatch.Expected State: "+w+",Actual State: "+t.state),n=he.createInvalidStateError(t.state,w),this.cacheStorage.setItem(T.msalError,n.errorCode),this.cacheStorage.setItem(T.msalErrorDescription,n.errorMessage)}if(this.cacheStorage.setItem(T.renewStatus+t.state,T.tokenRenewStatusCompleted),this.cacheStorage.removeAcquireTokenEntries(t.state),this.inCookie&&(this.cacheStorage.setItemCookie(i,"",-1),this.cacheStorage.clearCookie()),n)throw n;if(!r)throw V.createUnexpectedError("Response is null");return r},e.prototype.getAccount=function(){if(this.account)return this.account;var e=this.cacheStorage.getItem(T.idTokenKey),t=this.cacheStorage.getItem(T.msalClientInfo);if(!D.isEmpty(e)&&!D.isEmpty(t)){var n=new we(e),r=new ye(t);return this.account=be.createAccount(n,r),this.account}return null},e.prototype.getAccountState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return e},e.prototype.getAllAccounts=function(){for(var e=[],t=this.cacheStorage.getAllAccessTokens(T.clientId,T.homeAccountIdentifier),n=0;n<t.length;n++){var r=new we(t[n].value.idToken),o=new ye(t[n].value.homeAccountIdentifier),i=be.createAccount(r,o);e.push(i)}return this.getUniqueAccounts(e)},e.prototype.getUniqueAccounts=function(e){if(!e||e.length<=1)return e;for(var t=[],n=[],r=0;r<e.length;++r)e[r].homeAccountIdentifier&&-1===t.indexOf(e[r].homeAccountIdentifier)&&(t.push(e[r].homeAccountIdentifier),n.push(e[r]));return n},e.prototype.validateInputScope=function(e,t){if(e){if(!Array.isArray(e))throw fe.createScopesNonArrayError(e);if(e.length<1)throw fe.createEmptyScopesArrayError(e.toString());if(e.indexOf(this.clientId)>-1&&e.length>1)throw fe.createClientIdSingleScopeError(e.toString())}else if(t)throw fe.createScopesRequiredError(e)},e.prototype.getScopeFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},e.prototype.appendScopes=function(e){var t;return e&&e.scopes&&(t=e.extraScopesToConsent?e.scopes.concat(e.extraScopesToConsent):e.scopes),t},e.prototype.broadcast=function(e,t){var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},e.prototype.getCachedTokenInternal=function(e,t,n){var r=t||this.getAccount();if(!r)return null;var o=this.authorityInstance?this.authorityInstance:Re.CreateInstance(this.authority,this.config.auth.validateAuthority),i=this.getTokenType(r,e,!0),a=new me(o,this.clientId,e,i,this.getRedirectUri(),n);return this.getCachedToken(a,t)},e.prototype.getScopesForEndpoint=function(e){if(this.config.framework.unprotectedResources.length>0)for(var t=0;t<this.config.framework.unprotectedResources.length;t++)if(e.indexOf(this.config.framework.unprotectedResources[t])>-1)return null;if(this.config.framework.protectedResourceMap.size>0)for(var n=0,r=Array.from(this.config.framework.protectedResourceMap.keys());n<r.length;n++){var o=r[n];if(e.indexOf(o)>-1)return this.config.framework.protectedResourceMap.get(o)}return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this.getHostFromUri(e)===this.getHostFromUri(this.getRedirectUri())?new Array(this.clientId):null:new Array(this.clientId)},e.prototype.getLoginInProgress=function(){return!!this.cacheStorage.getItem(T.urlHash)||this.loginInProgress},e.prototype.setloginInProgress=function(e){this.loginInProgress=e},e.prototype.getAcquireTokenInProgress=function(){return this.acquireTokenInProgress},e.prototype.setAcquireTokenInProgress=function(e){this.acquireTokenInProgress=e},e.prototype.getLogger=function(){return this.config.system.logger},e.prototype.getRedirectUri=function(){return"function"==typeof this.config.auth.redirectUri?this.config.auth.redirectUri():this.config.auth.redirectUri},e.prototype.getPostLogoutRedirectUri=function(){return"function"==typeof this.config.auth.postLogoutRedirectUri?this.config.auth.postLogoutRedirectUri():this.config.auth.postLogoutRedirectUri},e.prototype.getCurrentConfiguration=function(){if(!this.config)throw fe.createNoSetConfigurationError();return this.config},e.prototype.getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t=t.split("/")[0]},e.prototype.getTokenType=function(e,t,n){return n?be.compareAccounts(e,this.getAccount())?t.indexOf(this.config.auth.clientId)>-1?$e:Ze:t.indexOf(this.config.auth.clientId)>-1?$e:et:be.compareAccounts(e,this.getAccount())?t.indexOf(this.clientId)>-1?$e:Ze:et},e.prototype.setAccountCache=function(e,t){var n=e?this.getAccountId(e):T.no_account,r=ke.generateAcquireTokenAccountKey(n,t);this.cacheStorage.setItem(r,JSON.stringify(e))},e.prototype.setAuthorityCache=function(e,t){var n=ke.generateAuthorityKey(e);this.cacheStorage.setItem(n,K.CanonicalizeUri(t),this.inCookie)},e.prototype.updateCacheEntries=function(e,t,n){n?(this.cacheStorage.setItem(T.loginRequest,n,this.inCookie),this.cacheStorage.setItem(T.loginError,""),this.cacheStorage.setItem(T.stateLogin,e.state,this.inCookie),this.cacheStorage.setItem(T.msalError,""),this.cacheStorage.setItem(T.msalErrorDescription,"")):this.setAccountCache(t,e.state),this.setAuthorityCache(e.state,e.authority),this.cacheStorage.setItem(T.nonceIdToken,e.nonce,this.inCookie)},e.prototype.getAccountId=function(e){return D.isEmpty(e.homeAccountIdentifier)?T.no_account:e.homeAccountIdentifier},e.prototype.buildIDTokenRequest=function(e){return{scopes:[this.clientId],authority:this.authority,account:this.getAccount(),extraQueryParameters:e.extraQueryParameters}},e.prototype.getTelemetryManagerFromConfig=function(e,t){if(!e)return null;var n=e.applicationName,r=e.applicationVersion,o=e.telemetryEmitter;if(!n||!r||!o)throw fe.createTelemetryConfigError(e);return new Xe({platform:{sdk:"msal.js",sdkVersion:"1.1.3",applicationName:n,applicationVersion:r},clientId:t},o)},f([tt],e.prototype,"acquireTokenSilent",null),e}(),rt=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})},ot=function(e){function a(e){var t;return n(this,a),(t=r(this,o(a).call(this))).sessionStorageRequestedScopesKey="mgt-requested-scopes",t.sessionStorageDeniedScopesKey="mgt-denied-scopes",t.initProvider(e),t}return t(a,v),i(a,[{key:"trySilentSignIn",value:function(){return rt(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this._userAgentApplication.isCallback(window.location.hash)){e.next=3;break}return e.abrupt("return");case 3:if(e.t0=this._userAgentApplication.getAccount(),!e.t0){e.next=8;break}return e.next=7,this.getAccessToken(null);case 7:e.t0=e.sent;case 8:if(!e.t0){e.next=12;break}this.setState(g.SignedIn),e.next=13;break;case 12:this.setState(g.SignedOut);case 13:e.next=18;break;case 15:e.prev=15,e.t1=e.catch(0),this.setState(g.SignedOut);case 18:case"end":return e.stop()}},e,this,[[0,15]])}))}},{key:"login",value:function(e){return rt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e||{loginHint:this._loginHint,prompt:"select_account",scopes:this.scopes},this._loginType!==m.Popup){t.next=8;break}return t.next=4,this._userAgentApplication.loginPopup(n);case 4:r=t.sent,this.setState(r.account?g.SignedIn:g.SignedOut),t.next=9;break;case 8:this._userAgentApplication.loginRedirect(n);case 9:case"end":return t.stop()}},t,this)}))}},{key:"logout",value:function(){return rt(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._userAgentApplication.logout(),this.setState(g.SignedOut);case 2:case"end":return e.stop()}},e,this)}))}},{key:"getAccessToken",value:function(e){return rt(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e&&e.scopes||this.scopes,r={loginHint:this._loginHint,scopes:n},t.prev=2,t.next=5,this._userAgentApplication.acquireTokenSilent(r);case 5:return o=t.sent,t.abrupt("return",o.accessToken);case 9:if(t.prev=9,t.t0=t.catch(2),!this.requiresInteraction(t.t0)){t.next=33;break}if(this._loginType!==m.Redirect){t.next=21;break}if(this.areScopesDenied(n)){t.next=18;break}this.setRequestedScopes(n),this._userAgentApplication.acquireTokenRedirect(r),t.next=19;break;case 18:throw t.t0;case 19:t.next=31;break;case 21:return t.prev=21,t.next=24,this._userAgentApplication.acquireTokenPopup(r);case 24:return i=t.sent,t.abrupt("return",i.accessToken);case 28:throw t.prev=28,t.t1=t.catch(21),t.t1;case 31:t.next=35;break;case 33:throw this.setState(g.SignedOut),t.t0;case 35:throw null;case 36:case"end":return t.stop()}},t,this,[[2,9],[21,28]])}))}},{key:"updateScopes",value:function(e){this.scopes=e}},{key:"requiresInteraction",value:function(e){return!(!e||!e.errorCode)&&(-1!==e.errorCode.indexOf("consent_required")||-1!==e.errorCode.indexOf("interaction_required")||-1!==e.errorCode.indexOf("login_required"))}},{key:"setRequestedScopes",value:function(e){e&&sessionStorage.setItem(this.sessionStorageRequestedScopesKey,JSON.stringify(e))}},{key:"getRequestedScopes",value:function(){var e=sessionStorage.getItem(this.sessionStorageRequestedScopesKey);return e?JSON.parse(e):null}},{key:"clearRequestedScopes",value:function(){sessionStorage.removeItem(this.sessionStorageRequestedScopesKey)}},{key:"addDeniedScopes",value:function(e){if(e){var t=this.getDeniedScopes()||[],n=(t=t.concat(e)).indexOf("openid");-1!==n&&t.splice(n,1),-1!==(n=t.indexOf("profile"))&&t.splice(n,1),sessionStorage.setItem(this.sessionStorageDeniedScopesKey,JSON.stringify(t))}}},{key:"getDeniedScopes",value:function(){var e=sessionStorage.getItem(this.sessionStorageDeniedScopesKey);return e?JSON.parse(e):null}},{key:"areScopesDenied",value:function(e){if(e){var t=this.getDeniedScopes();if(t&&t.filter(function(t){return-1!==e.indexOf(t)}).length>0)return!0}return!1}},{key:"initProvider",value:function(e){var t=this;this.scopes=void 0!==e.scopes?e.scopes:["user.read"],this._loginType=void 0!==e.loginType?e.loginType:m.Redirect,this._loginHint=e.loginHint;var n=function(e){t.tokenReceivedCallback(e)}.bind(this),r=function(e,n){t.errorReceivedCallback(e,status)}.bind(this);if(!e.clientId)throw new Error("clientId must be provided");var o=e.options||{auth:{clientId:e.clientId}};o.auth.clientId=e.clientId,o.cache=o.cache||{},o.cache.cacheLocation=o.cache.cacheLocation||"localStorage",o.cache.storeAuthStateInCookie=o.cache.storeAuthStateInCookie||!0,e.authority&&(o.auth.authority=e.authority),this.clientId=e.clientId,this._userAgentApplication=new nt(o),this._userAgentApplication.handleRedirectCallback(n,r),this.graph=new y(this),this.trySilentSignIn()}},{key:"tokenReceivedCallback",value:function(e){"id_token"===e.tokenType&&this.setState(g.SignedIn),this.clearRequestedScopes()}},{key:"errorReceivedCallback",value:function(e,t){var n=this.getRequestedScopes();n&&this.addDeniedScopes(n),this.clearRequestedScopes()}}]),a}(),it=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},at=function(e){function a(){return n(this,a),r(this,o(a).apply(this,arguments))}return t(a,I),i(a,[{key:"firstUpdated",value:function(e){s(o(a.prototype),"firstUpdated",this).call(this,e);var t=!1;if(this.dependsOn)for(var n=this.dependsOn;n;){if(n.isAvailable){t=!0;break}n=n.dependsOn}!t&&this.isAvailable&&this.initializeProvider()}},{key:"initializeProvider",value:function(){}},{key:"stateChangedHandler",value:function(){this.fireCustomEvent("onStateChanged",this.provider.state)}},{key:"provider",get:function(){return this._provider},set:function(e){var t=this;this._provider&&this.provider.removeStateChangedHandler(function(){return t.stateChangedHandler}),this._provider=e,this._provider&&this.provider.onStateChanged(function(){return t.stateChangedHandler})}},{key:"isAvailable",get:function(){return!0}}]),a}();it([w({attribute:"depends-on",converter:function(e){return document.querySelector(e)},type:String})],at.prototype,"dependsOn",void 0);var st=function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},ct=function(e){function a(){var e;return n(this,a),(e=r(this,o(a).apply(this,arguments))).clientId="",e}return t(a,at),i(a,[{key:"initializeProvider",value:function(){if(this.clientId){var e={clientId:this.clientId};if(this.loginType&&this.loginType.length>1){var t=this.loginType.toLowerCase();t=t[0].toUpperCase()+t.slice(1);var n=m[t];e.loginType=n}if(this.authority&&(e.authority=this.authority),this.scopes){var r=this.scopes.split(",");r&&r.length>0&&(e.scopes=r)}this.provider=new ot(e),b.globalProvider=this.provider}}},{key:"isAvailable",get:function(){return!0}}]),a}();function ut(){var e=u([' <mgt-msal-provider client-id="ac77046c-156c-40f0-8507-3b5a58034582" login-type="popup" scopes="user.read,people.read" authority=""></mgt-msal-provider> <mgt-login></mgt-login> ']);return ut=function(){return e},e}st([w({attribute:"client-id",type:String})],ct.prototype,"clientId",void 0),st([w({attribute:"login-type",type:String})],ct.prototype,"loginType",void 0),st([w()],ct.prototype,"authority",void 0),st([w({attribute:"scopes",type:String})],ct.prototype,"scopes",void 0),ct=st([k("mgt-msal-provider")],ct);e("default",{title:"MSAL Provider|mgt-login",component:"mgt-login",decorators:[l,d]}),e("msalLogin",function(){return c(ut())})}}});
//# sourceMappingURL=login.stories-4c17d712.js.map
