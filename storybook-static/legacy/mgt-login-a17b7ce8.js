System.register(["./lit-html-de476c62.js","./Graph-edc653e3.js"],function(){"use strict";var o,t,n,e,i,r,a,s,p,l,u,c,g,d;return{setters:[function(p){o=p.v,t=p._,n=p.a,e=p.b,i=p.c,r=p.d,a=p.e,s=p.u},function(o){p=o.c,l=o.p,u=o.a,c=o.P,g=o.b,d=o.f}],execute:function(){function m(){var t=o([':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\E70D"}.ms-Icon--ChevronUp::before{content:"\\E70E"}.ms-Icon--Contact::before{content:"\\E77B"}.ms-Icon--AddFriend::before{content:"\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\EB6D"}:host,mgt-login{--font-size:14px;--font-weight:600;--width:\'100%\';--height:\'100%\';--margin:0;--padding:12px 20px;--color:#201f1e;--background-color:transparent;--background-color--hover:#edebe9;--popup-content-background-color:white;--popup-command-font-size:12px;--popup-command-margin:16px 0 0;--popup-padding:24px 48px 16px 24px}:host .root,mgt-login .root{position:relative;display:inline-block}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);padding:var(--padding);color:var(--color);background-color:var(--background-color);border:none;cursor:pointer;transition:color .3s,background-color .3s}:host .login-button:hover,mgt-login .login-button:hover{color:var(--theme-primary-color);background-color:var(--background-color--hover)}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-icon + span,mgt-login .login-icon + span{margin-left:6px}:host .popup,mgt-login .popup{display:none;position:absolute;animation-duration:.3s;font-family:var(--default-font-family);background:var(--popup-content-background-color);box-shadow:0 12px 40px 2px rgba(0,0,0,.08);min-width:240px;z-index:1}:host .popup.show-menu,mgt-login .popup.show-menu{display:inline-block;animation-name:fade-in}:host .popup.open-left,mgt-login .popup.open-left{right:0}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding)}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);font-weight:var(--font-weight);color:var(--theme-primary-color);background-color:transparent;border:none;padding:0;cursor:pointer;transition:color .3s}:host .popup-command:hover,mgt-login .popup-command:hover{color:var(--theme-dark-color)}@keyframes fade-in{from{opacity:0}to{opacity:1}}'],[':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\\\\E70E"}.ms-Icon--Contact::before{content:"\\\\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\\\\EB6D"}:host,mgt-login{--font-size:14px;--font-weight:600;--width:\'100%\';--height:\'100%\';--margin:0;--padding:12px 20px;--color:#201f1e;--background-color:transparent;--background-color--hover:#edebe9;--popup-content-background-color:white;--popup-command-font-size:12px;--popup-command-margin:16px 0 0;--popup-padding:24px 48px 16px 24px}:host .root,mgt-login .root{position:relative;display:inline-block}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);padding:var(--padding);color:var(--color);background-color:var(--background-color);border:none;cursor:pointer;transition:color .3s,background-color .3s}:host .login-button:hover,mgt-login .login-button:hover{color:var(--theme-primary-color);background-color:var(--background-color--hover)}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-icon + span,mgt-login .login-icon + span{margin-left:6px}:host .popup,mgt-login .popup{display:none;position:absolute;animation-duration:.3s;font-family:var(--default-font-family);background:var(--popup-content-background-color);box-shadow:0 12px 40px 2px rgba(0,0,0,.08);min-width:240px;z-index:1}:host .popup.show-menu,mgt-login .popup.show-menu{display:inline-block;animation-name:fade-in}:host .popup.open-left,mgt-login .popup.open-left{right:0}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding)}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);font-weight:var(--font-weight);color:var(--theme-primary-color);background-color:transparent;border:none;padding:0;cursor:pointer;transition:color .3s}:host .popup-command:hover,mgt-login .popup-command:hover{color:var(--theme-dark-color)}@keyframes fade-in{from{opacity:0}to{opacity:1}}']);return m=function(){return t},t}var h=[p(m())];function f(){var t=o([' <div class="popup '," ",'"> <div class="popup-content"> <div> ',' </div> <div class="popup-commands"> <ul> <li> <button class="popup-command" @click="','" aria-label="Sign Out"> Sign Out </button> </li> </ul> </div> </div> </div> ']);return f=function(){return t},t}function v(){var t=o([' <mgt-person .personDetails="','" .personImage="','" show-name show-email> ']);return v=function(){return t},t}function b(){var t=o([' <mgt-person .personDetails="','" .personImage="','" show-name> ']);return b=function(){return t},t}function y(){var t=o([' <i class="login-icon ms-Icon ms-Icon--Contact"></i> <span aria-label="Sign In"> Sign In </span> ']);return y=function(){return t},t}function k(){var t=o([' <div class="root"> <button ?disabled="','" class="login-button" @click="','" role="button"> '," </button> "," </div> "]);return k=function(){return t},t}var x=function(o,n,e,i){var r,a=arguments.length,s=a<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"===("undefined"==typeof Reflect?"undefined":t(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(o,n,e,i);else for(var p=o.length-1;p>=0;p--)(r=o[p])&&(s=(a<3?r(s):a>3?r(n,e,s):r(n,e))||s);return a>3&&s&&Object.defineProperty(n,e,s),s},w=function(o,t,n,e){return new(n||(n=Promise))(function(i,r){function a(o){try{p(e.next(o))}catch(o){r(o)}}function s(o){try{p(e.throw(o))}catch(o){r(o)}}function p(o){var t;o.done?i(o.value):(t=o.value,t instanceof n?t:new n(function(o){o(t)})).then(a,s)}p((e=e.apply(o,t||[])).next())})},I=function(o){function t(){var o;return e(this,t),(o=i(this,r(t).call(this)))._openLeft=!1,o._showMenu=!1,o._loading=!0,c.onProviderUpdated(function(){return o.loadState()}),o.loadState(),o}return n(t,d),a(t,[{key:"login",value:function(){return w(this,void 0,void 0,regeneratorRuntime.mark(function o(){var t;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!this.userDetails){o.next=2;break}return o.abrupt("return");case 2:if(!(t=c.globalProvider)||!t.login){o.next=9;break}return o.next=6,t.login();case 6:return t.state===g.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"),o.next=9,this.loadState();case 9:case"end":return o.stop()}},o,this)}))}},{key:"logout",value:function(){return w(this,void 0,void 0,regeneratorRuntime.mark(function o(){var t;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.fireCustomEvent("logoutInitiated")){o.next=2;break}return o.abrupt("return");case 2:if(!(t=c.globalProvider)||!t.logout){o.next=7;break}return o.next=6,t.logout();case 6:this.fireCustomEvent("logoutCompleted");case 7:this.userDetails=null,this._showMenu=!1;case 9:case"end":return o.stop()}},o,this)}))}},{key:"updated",value:function(o){if(!1===o.get("_showMenu")){var t=this.renderRoot.querySelector(".popup");if(t&&t.animate){this._popupRect=t.getBoundingClientRect();var n=this._loginButtonRect.left-this._popupRect.left,e=this._loginButtonRect.top-this._popupRect.top,i=this._loginButtonRect.width/this._popupRect.width,r=this._loginButtonRect.height/this._popupRect.height;t.animate([{backgroundColor:"#eaeaea",transform:"\n              translate(".concat(n,"px, ").concat(e,"px)\n              scale(").concat(i,", ").concat(r,")\n              "),transformOrigin:"top left"},{backgroundColor:"white",transform:"none",transformOrigin:"top left"}],{duration:100,easing:"ease-in-out",fill:"both"})}}}},{key:"firstUpdated",value:function(){var o=this;window.addEventListener("click",function(t){var n=o.renderRoot.querySelector(".popup");n&&(o._popupRect=n.getBoundingClientRect(),o._showMenu=!1)})}},{key:"render",value:function(){var o=this.userDetails?this.renderLoggedIn():this.renderLogIn();return s(k(),this._loading,this.onClick,o,this.renderMenu())}},{key:"renderLogIn",value:function(){return s(y())}},{key:"renderLoggedIn",value:function(){return this.userDetails?s(b(),this.userDetails,this._image):this.renderLogIn()}},{key:"renderMenu",value:function(){if(this.userDetails){var o=s(v(),this.userDetails,this._image);return s(f(),this._openLeft?"open-left":"",this._showMenu?"show-menu":"",o,this.logout)}}},{key:"loadState",value:function(){return w(this,void 0,void 0,regeneratorRuntime.mark(function o(){var t,n,e;return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!(t=c.globalProvider)){o.next=20;break}if(this._loading=!0,t.state!==g.SignedIn){o.next=14;break}return(n=t.graph.createBatch()).get("me","me",["user.read"]),n.get("photo","me/photo/$value",["user.read"]),o.next=9,n.execute();case 9:e=o.sent,this._image=e.photo,this.userDetails=e.me,o.next=20;break;case 14:if(t.state!==g.SignedOut){o.next=18;break}this.userDetails=null,o.next=20;break;case 18:return this._showMenu=!1,o.abrupt("return");case 20:this._loading=!1;case 21:case"end":return o.stop()}},o,this)}))}},{key:"onClick",value:function(o){if(o.stopPropagation(),this.userDetails){var t=this.renderRoot.querySelector(".login-button");if(t){this._loginButtonRect=t.getBoundingClientRect();var n=this._loginButtonRect.left,e=(window.innerWidth||document.documentElement.clientWidth)-this._loginButtonRect.right;this._openLeft=e<n,this._showMenu=!this._showMenu}}else this.fireCustomEvent("loginInitiated")&&this.login()}}],[{key:"styles",get:function(){return h}}]),t}();x([l({attribute:"user-details",type:Object})],I.prototype,"userDetails",void 0),x([l({attribute:!1})],I.prototype,"_showMenu",void 0),x([l({attribute:!1})],I.prototype,"_loading",void 0),I=x([u("mgt-login")],I)}}});
//# sourceMappingURL=mgt-login-a17b7ce8.js.map
