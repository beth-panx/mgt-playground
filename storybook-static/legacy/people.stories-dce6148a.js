System.register(["./lit-html-de476c62.js","./index-14c7f544.js","./Graph-edc653e3.js","./mgt-mock-provider-ad9c32b1.js"],function(e){"use strict";var t,n,o,r,i,a,s,p,l,c,u,f,d,m,h,g,v;return{setters:[function(e){t=e.v,n=e._,o=e.a,r=e.b,i=e.c,a=e.d,s=e.e,p=e.u},function(e){l=e.e,c=e.f},function(e){u=e.c,f=e.p,d=e.a,m=e.h,h=e.P,g=e.b,v=e.M},function(){}],execute:function(){function y(){var e=t([':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\E70D"}.ms-Icon--ChevronUp::before{content:"\\E70E"}.ms-Icon--Contact::before{content:"\\E77B"}.ms-Icon--AddFriend::before{content:"\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\EB6D"}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle}'],[':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\\\\E70E"}.ms-Icon--Contact::before{content:"\\\\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\\\\EB6D"}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle}']);return y=function(){return e},e}var x=[u(y())];function b(){var e=t([' <mgt-person .personDetails="','" .personImage="','" .personCardInteraction="','"></mgt-person> ']);return b=function(){return e},e}function I(){var e=t([""]);return I=function(){return e},e}function w(){var e=t([""]);return w=function(){return e},e}function k(){var e=t([' <li class="overflow"><span>+',"<span></span></span></li> "]);return k=function(){return e},e}function P(){var e=t([' <li class="people-person"> '," </li> "]);return P=function(){return e},e}function U(){var e=t([' <ul class="people-list"> '," "," </ul> "]);return U=function(){return e},e}var E=function(e,t,o,r){var i,a=arguments.length,s=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,r);else for(var p=e.length-1;p>=0;p--)(i=e[p])&&(s=(a<3?i(s):a>3?i(t,o,s):i(t,o))||s);return a>3&&s&&Object.defineProperty(t,o,s),s},M=function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{p(o.next(e))}catch(e){i(e)}}function s(e){try{p(o.throw(e))}catch(e){i(e)}}function p(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}p((o=o.apply(e,t||[])).next())})},S=function(e){function t(){var e;return r(this,t),(e=i(this,a(t).apply(this,arguments))).people=null,e.showMax=3,e.personCardInteraction=m.hover,e._firstUpdated=!1,e}return o(t,v),s(t,[{key:"firstUpdated",value:function(){var e=this;this._firstUpdated=!0,h.onProviderUpdated(function(){return e.loadPeople()}),this.loadPeople()}},{key:"render",value:function(){var e=this;return this.people?this.people.length?this.renderTemplate("default",{people:this.people})||p(U(),this.people.slice(0,this.showMax).map(function(t){return p(P(),e.renderTemplate("person",{person:t},t.displayName)||e.renderPerson(t))}),this.people.length>this.showMax?this.renderTemplate("overflow",{extra:this.people.length-this.showMax,max:this.showMax,people:this.people})||p(k(),this.people.length-this.showMax):null):this.renderTemplate("no-people",null)||p(w()):this.renderTemplate("no-data",null)||p(I())}},{key:"loadPeople",value:function(){return M(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._firstUpdated){e.next=2;break}return e.abrupt("return");case 2:if(this.people){e.next=21;break}if(!(t=h.globalProvider)||t.state!==g.SignedIn){e.next=21;break}if(n=h.globalProvider.graph,!this.groupId){e.next=12;break}return e.next=9,n.getPeopleFromGroup(this.groupId);case 9:this.people=e.sent,e.next=21;break;case 12:if(!this.userIds){e.next=18;break}return e.next=15,Promise.all(this.userIds.map(function(e){return M(o,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.getUser(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t)}))}));case 15:this.people=e.sent,e.next=21;break;case 18:return e.next=20,n.getPeople();case 20:this.people=e.sent;case 21:case"end":return e.stop()}},e,this)}))}},{key:"renderPerson",value:function(e){return p(b(),e,"@",this.personCardInteraction)}}],[{key:"styles",get:function(){return x}}]),t}();function C(){var e=t([' <mgt-mock-provider></mgt-mock-provider> <mgt-people show-max="5"></mgt-people> ']);return C=function(){return e},e}E([f({attribute:"people",type:Object})],S.prototype,"people",void 0),E([f({attribute:"show-max",type:Number})],S.prototype,"showMax",void 0),E([f({attribute:"group-id",type:String})],S.prototype,"groupId",void 0),E([f({attribute:"user-ids",converter:function(e,t){return e.split(",")}})],S.prototype,"userIds",void 0),E([f({attribute:"person-card",converter:function(e,t){return e=e.toLowerCase(),void 0===m[e]?m.hover:m[e]}})],S.prototype,"personCardInteraction",void 0),S=E([d("mgt-people")],S);e("default",{title:"Mock Provider|mgt-people",component:"mgt-people",decorators:[l,c]}),e("people",function(){return p(C())})}}});
//# sourceMappingURL=people.stories-dce6148a.js.map
