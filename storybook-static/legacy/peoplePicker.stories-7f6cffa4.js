System.register(["./lit-html-de476c62.js","./index-14c7f544.js","./Graph-edc653e3.js","./mgt-mock-provider-ad9c32b1.js","./repeat-c6afd687.js"],function(e){"use strict";var t,o,r,n,i,p,s,l,a,c,h,d,u,g,f,m,x,v,k;return{setters:[function(e){t=e.v,o=e._,r=e.a,n=e.b,i=e.c,p=e.d,s=e.e,l=e.f,a=e.u},function(e){c=e.e,h=e.f},function(e){d=e.c,u=e.p,g=e.a,f=e.P,m=e.b,x=e.i,v=e.M},function(){},function(e){k=e.r}],execute:function(){function y(){var e=t([':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\E70D"}.ms-Icon--ChevronUp::before{content:"\\E70E"}.ms-Icon--Contact::before{content:"\\E77B"}.ms-Icon--AddFriend::before{content:"\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\EB6D"}:host{border-radius:2px}:host .root,mgt-people-picker .root{display:block}:host .people-picker,mgt-people-picker .people-picker{position:relative;margin:7px 0 0 0;background-color:#fff;padding-bottom:8px}:host .people-list,mgt-people-picker .people-list{position:absolute;margin:7px 0 0 0;padding:0;box-shadow:0 1.3289px 2.65781px rgba(180,180,180,.182),0 1.3289px 2.65781px rgba(68,68,68,.3);border-radius:2px;background-color:var(--people-list-background-color,#fff);z-index:1;width:100%;text-align:left;list-style-type:none;font-family:Segoe UI;font-style:normal;font-weight:400}:host .people-list li,mgt-people-picker .people-list li{cursor:pointer}:host .people-list-separator,mgt-people-picker .people-list-separator{margin:var(--separator-margin,0 0 0 0);height:2px;background:var(--accent-color,#0078d4);margin-top:5px;text-align:center}:host .people-chosen-input,mgt-people-picker .people-chosen-input{position:relative;border:none;line-height:normal;outline:0;font-family:Segoe UI;font-style:normal;font-weight:400;font-size:14px;line-height:19px}:host .people-chosen-list,mgt-people-picker .people-chosen-list{display:flex;flex-wrap:wrap;vertical-align:middle;margin:0 0 0 0;list-style-type:none;padding-left:10px;font-family:Segoe UI;font-style:normal;font-weight:400}.CloseIcon,mgt-people-picker .CloseIcon{line-height:normal;font-family:FabricMDL2Icons;padding-right:8px;padding-left:4px;margin-top:0;cursor:pointer}:host .SearchIcon,mgt-people-picker .SearchIcon{font-family:FabricMDL2Icons;color:var(--accent-color,#0078d4)}:host .people-person,mgt-people-picker .people-person{display:flex;margin:4px 5px 0 0;align-items:center;background-color:rgba(196,196,196,.24);border-radius:15px;height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .list-person,mgt-people-picker .list-person{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;padding:12px;font-family:Segoe UI;font-style:normal;font-weight:600;font-size:14px}:host .list-person:hover,mgt-people-picker .list-person:hover{background-color:#f1f1f1dd}:host .people-person-list-fill,mgt-people-picker .people-person-list-fill{background-color:#f1f1f1}:host .people-person-text,mgt-people-picker .people-person-text{font-size:14px;font-weight:400;margin:0;padding:0}:host .input-search,mgt-people-picker .input-search{margin:7px 2px 0 3px}:host .input-search-start,mgt-people-picker .input-search-start{margin:7px 0 0 0;line-height:normal;margin-inline-start:0;margin-inline-end:0}:host .people-picker-input,mgt-people-picker .people-picker-input{display:flex;order:2;background-color:#fff;margin:var(--avatar-margin,0 4px 0 0);font-size:14px;line-height:19px;cursor:text}:host .duplicate-person,mgt-people-picker .duplicate-person{text-decoration:none;border-bottom:1px solid red}:host .remove-person-button,mgt-people-picker .remove-person-button{background:#767676;transform:matrix(-.71,-.71,.71,-.71,0,0)}:host .remove-person-button-secondary,mgt-people-picker .remove-person-button-secondary{background:#767676;transform:matrix(.71,-.71,.71,.71,0,0)}:host .person-display-name,mgt-people-picker .person-display-name{max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-left:8px;font-family:Segoe UI;font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:#000}mgt-person{--avatar-size-s:32px;margin-left:12px}.chosen-person{--avatar-size-s:24px;margin-left:0}:host .search-error-text,:host .loading-text,mgt-people-picker .search-error-text,mgt-people-picker .loading-text{font-family:Segoe UI;font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:#232222}:host .SearchErrorIcon,mgt-people-picker .SearchErrorIcon{display:inline-block;font-family:FabricMDL2Icons;color:#cf0000}:host .message-parent,mgt-people-picker .message-parent{margin-top:30px;margin-bottom:30px;display:flex;align-items:center;justify-content:center;vertical-align:middle}:host .highlight-search-text,mgt-people-picker .highlight-search-text{font-weight:700}:host .people-person-job-title,mgt-people-picker .people-person-job-title{flex:100%;order:3;font-weight:400;font-size:12px;text-transform:uppercase}:host .people-person-text-area,mgt-people-picker .people-person-text-area{margin-left:13px;flex:1 1 0;max-height:40px}'],[':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\\\\E70E"}.ms-Icon--Contact::before{content:"\\\\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\\\\EB6D"}:host{border-radius:2px}:host .root,mgt-people-picker .root{display:block}:host .people-picker,mgt-people-picker .people-picker{position:relative;margin:7px 0 0 0;background-color:#fff;padding-bottom:8px}:host .people-list,mgt-people-picker .people-list{position:absolute;margin:7px 0 0 0;padding:0;box-shadow:0 1.3289px 2.65781px rgba(180,180,180,.182),0 1.3289px 2.65781px rgba(68,68,68,.3);border-radius:2px;background-color:var(--people-list-background-color,#fff);z-index:1;width:100%;text-align:left;list-style-type:none;font-family:Segoe UI;font-style:normal;font-weight:400}:host .people-list li,mgt-people-picker .people-list li{cursor:pointer}:host .people-list-separator,mgt-people-picker .people-list-separator{margin:var(--separator-margin,0 0 0 0);height:2px;background:var(--accent-color,#0078d4);margin-top:5px;text-align:center}:host .people-chosen-input,mgt-people-picker .people-chosen-input{position:relative;border:none;line-height:normal;outline:0;font-family:Segoe UI;font-style:normal;font-weight:400;font-size:14px;line-height:19px}:host .people-chosen-list,mgt-people-picker .people-chosen-list{display:flex;flex-wrap:wrap;vertical-align:middle;margin:0 0 0 0;list-style-type:none;padding-left:10px;font-family:Segoe UI;font-style:normal;font-weight:400}.CloseIcon,mgt-people-picker .CloseIcon{line-height:normal;font-family:FabricMDL2Icons;padding-right:8px;padding-left:4px;margin-top:0;cursor:pointer}:host .SearchIcon,mgt-people-picker .SearchIcon{font-family:FabricMDL2Icons;color:var(--accent-color,#0078d4)}:host .people-person,mgt-people-picker .people-person{display:flex;margin:4px 5px 0 0;align-items:center;background-color:rgba(196,196,196,.24);border-radius:15px;height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}:host .list-person,mgt-people-picker .list-person{display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;padding:12px;font-family:Segoe UI;font-style:normal;font-weight:600;font-size:14px}:host .list-person:hover,mgt-people-picker .list-person:hover{background-color:#f1f1f1dd}:host .people-person-list-fill,mgt-people-picker .people-person-list-fill{background-color:#f1f1f1}:host .people-person-text,mgt-people-picker .people-person-text{font-size:14px;font-weight:400;margin:0;padding:0}:host .input-search,mgt-people-picker .input-search{margin:7px 2px 0 3px}:host .input-search-start,mgt-people-picker .input-search-start{margin:7px 0 0 0;line-height:normal;margin-inline-start:0;margin-inline-end:0}:host .people-picker-input,mgt-people-picker .people-picker-input{display:flex;order:2;background-color:#fff;margin:var(--avatar-margin,0 4px 0 0);font-size:14px;line-height:19px;cursor:text}:host .duplicate-person,mgt-people-picker .duplicate-person{text-decoration:none;border-bottom:1px solid red}:host .remove-person-button,mgt-people-picker .remove-person-button{background:#767676;transform:matrix(-.71,-.71,.71,-.71,0,0)}:host .remove-person-button-secondary,mgt-people-picker .remove-person-button-secondary{background:#767676;transform:matrix(.71,-.71,.71,.71,0,0)}:host .person-display-name,mgt-people-picker .person-display-name{max-width:100px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-left:8px;font-family:Segoe UI;font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:#000}mgt-person{--avatar-size-s:32px;margin-left:12px}.chosen-person{--avatar-size-s:24px;margin-left:0}:host .search-error-text,:host .loading-text,mgt-people-picker .search-error-text,mgt-people-picker .loading-text{font-family:Segoe UI;font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:#232222}:host .SearchErrorIcon,mgt-people-picker .SearchErrorIcon{display:inline-block;font-family:FabricMDL2Icons;color:#cf0000}:host .message-parent,mgt-people-picker .message-parent{margin-top:30px;margin-bottom:30px;display:flex;align-items:center;justify-content:center;vertical-align:middle}:host .highlight-search-text,mgt-people-picker .highlight-search-text{font-weight:700}:host .people-person-job-title,mgt-people-picker .people-person-job-title{flex:100%;order:3;font-weight:400;font-size:12px;text-transform:uppercase}:host .people-person-text-area,mgt-people-picker .people-person-text-area{margin-left:13px;flex:1 1 0;max-height:40px}']);return y=function(){return e},e}var b=[d(y())];function w(){var e=t([' <mgt-person class="chosen-person" .personDetails="','" .personImage="','" show-name></mgt-person> ']);return w=function(){return e},e}function I(){var e=t([' <mgt-person .personDetails="','" .personImage="','"></mgt-person> ']);return I=function(){return e},e}function S(){var e=t([' <li class="list-person ','" @click="','"> ',' <div class="people-person-text-area" id="','"> ',' <span class="people-person-job-title">',"</span> </div> </li> "]);return S=function(){return e},e}function P(){var e=t([" "," "]);return P=function(){return e},e}function C(){var e=t([' <div class="people-list"> '," </div> "]);return C=function(){return e},e}function U(){var e=t([' <div> <span class="people-person-text">','</span><span class="people-person-text highlight-search-text">','</span><span class="people-person-text">',"</span> </div> "]);return U=function(){return e},e}function E(){var e=t([' <div class="people-chosen-list"> ',' <div class="','"> <input id="people-picker-input" class="people-chosen-input" type="text" placeholder="Start typing a name" label="people-picker-input" aria-label="people-picker-input" role="input" .value="','" @keydown="','" @keyup="','"> </div> </div> ']);return E=function(){return e},e}function z(){var e=t([' <li class="people-person"> ',' <div class="CloseIcon" @click="','"></div> </li> '],[' <li class="people-person"> ',' <div class="CloseIcon" @click="','">\\uE711</div> </li> ']);return z=function(){return e},e}function L(){var e=t([" "," "]);return L=function(){return e},e}function D(){var e=t([' <div class="message-parent"> <div label="search-error-text" aria-label="loading" class="loading-text"> ...... </div> </div> ']);return D=function(){return e},e}function F(){var e=t([' <div class="message-parent"> <div label="search-error-text" aria-label="We didn\'t find any matches." class="search-error-text"> We didn\'t find any matches. </div> </div> ']);return F=function(){return e},e}function M(){var e=t([' <div class="people-picker" @blur="','"> <div class="people-picker-input" @click="','"> ',' </div> <div class="people-list-separator"></div> '," </div> "]);return M=function(){return e},e}var N=function(e,t,r,n){var i,p=arguments.length,s=p<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===("undefined"==typeof Reflect?"undefined":o(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(s=(p<3?i(s):p>3?i(t,r,s):i(t,r))||s);return p>3&&s&&Object.defineProperty(t,r,s),s},R=function(e,t,o,r){return new(o||(o=Promise))(function(n,i){function p(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(p,s)}l((r=r.apply(e,t||[])).next())})},_=function(e){function t(){var e;return n(this,t),(e=i(this,p(t).call(this))).people=null,e.showMax=6,e.selectedPeople=[],e._userInput="",e.arrowSelectionCount=0,e.isLoading=!1,e}return r(t,v),s(t,[{key:"attributeChangedCallback",value:function(e,o,r){l(p(t.prototype),"attributeChangedCallback",this).call(this,e,o,r),"group-id"===e&&o!==r&&this.findGroup()}},{key:"firstUpdated",value:function(){var e=this;this.groupId&&(f.onProviderUpdated(function(){return e.findGroup()}),this.findGroup())}},{key:"render",value:function(){return this.renderTemplate("default",{people:this.people})||a(M(),this.lostFocus,this.gainedFocus,this.renderChosenPeople(),this.renderPeopleList())}},{key:"focus",value:function(e){var t=this.renderRoot.querySelector(".people-chosen-input");t&&t.focus(e)}},{key:"selectUsersById",value:function(e){return R(this,void 0,void 0,regeneratorRuntime.mark(function t(){var o,r,n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=f.globalProvider,r=f.globalProvider.graph,!o||o.state!==m.SignedIn){t.next=17;break}t.t0=regeneratorRuntime.keys(e);case 4:if((t.t1=t.t0()).done){t.next=17;break}return n=t.t1.value,t.prev=6,t.next=9,r.getUser(e[n]);case 9:i=t.sent,this.addPerson(i),t.next=15;break;case 13:t.prev=13,t.t2=t.catch(6);case 15:t.next=4;break;case 17:case"end":return t.stop()}},t,this,[[6,13]])}))}},{key:"onUserKeyUp",value:function(e){if(40!==e.keyCode&&38!==e.keyCode){var t=e.target;return"Escape"===e.code?(t.value="",this._userInput="",void(this.people=[])):"Backspace"===e.code&&0===this._userInput.length&&this.selectedPeople.length>0?(t.value="",this._userInput="",this.selectedPeople=this.selectedPeople.splice(0,this.selectedPeople.length-1),void this.fireCustomEvent("selectionChanged",this.selectedPeople)):void this.handleUserSearch(t)}}},{key:"findGroup",value:function(){return R(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=f.globalProvider)||t.state!==m.SignedIn){e.next=6;break}return o=f.globalProvider.graph,e.next=5,o.getPeopleFromGroup(this.groupId);case 5:this.groupPeople=e.sent;case 6:case"end":return e.stop()}},e,this)}))}},{key:"handleUserSearch",value:function(e){var t=this;this.debouncedSearch||(this.debouncedSearch=x(function(){t._userInput!==e.value&&(t._userInput=e.value,t.loadPersonSearch(t._userInput),t.arrowSelectionCount=0)},200)),this.debouncedSearch()}},{key:"onUserKeyDown",value:function(e){40!==e.keyCode&&38!==e.keyCode||(this.handleArrowSelection(e),this._userInput.length>0&&e.preventDefault()),"Tab"!==e.code&&"Enter"!==e.code||(this.people.length&&e.preventDefault(),this.addPerson(this.people[this.arrowSelectionCount]),e.target.value="")}},{key:"handleArrowSelection",value:function(e){if(this.people.length){38===e.keyCode&&(this.arrowSelectionCount>0?this.arrowSelectionCount--:this.arrowSelectionCount=0),40===e.keyCode&&(this.arrowSelectionCount+1!==this.people.length&&this.arrowSelectionCount+1<this.showMax?this.arrowSelectionCount++:this.arrowSelectionCount=0);for(var t=this.renderRoot.querySelector(".people-list"),o=0;o<t.children.length;o++)t.children[o].setAttribute("class","list-person people-person-list");t.children[this.arrowSelectionCount].setAttribute("class","list-person people-person-list-fill")}}},{key:"addPerson",value:function(e){e&&(this._userInput="",0===this.selectedPeople.filter(function(t){return t.id===e.id}).length&&(this.selectedPeople.push(e),this.fireCustomEvent("selectionChanged",this.selectedPeople),this.people=[]));this.gainedFocus()}},{key:"loadPersonSearch",value:function(e){return R(this,void 0,void 0,regeneratorRuntime.mark(function t(){var o,r,n,i,p;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.length){t.next=21;break}if(e=e.toLowerCase(),!(o=f.globalProvider)||o.state!==m.SignedIn){t.next=19;break}if(n=this,i=!0,setTimeout(function(){i&&(n.isLoading=!0)},400),p=f.globalProvider.graph,!this.groupId){t.next=12;break}r=this.groupPeople,t.next=15;break;case 12:return t.next=14,p.findPerson(e);case 14:r=t.sent;case 15:r&&(r=r.filter(function(t){return-1!==t.displayName.toLowerCase().indexOf(e)})),this.people=this.filterPeople(r),i=!1,this.isLoading=!1;case 19:t.next=22;break;case 21:this.people=[];case 22:case"end":return t.stop()}},t,this)}))}},{key:"filterPeople",value:function(e){if(e){var t=this.selectedPeople.map(function(e){return e.id});return e.filter(function(e){return-1===t.indexOf(e.id)})}}},{key:"removePerson",value:function(e){var t=e,o=this.selectedPeople.filter(function(e){return e.id!==t.id});this.selectedPeople=o,this.fireCustomEvent("selectionChanged",this.selectedPeople)}},{key:"renderErrorMessage",value:function(){return a(F())}},{key:"renderLoadingMessage",value:function(){return a(D())}},{key:"renderChosenPeople",value:function(){var e,t=this,o="input-search-start";return this.selectedPeople.length>0?(o="input-search",e=a(L(),this.selectedPeople.slice(0,this.selectedPeople.length).map(function(e){return a(z(),t.renderTemplate("person",{person:e},e.displayName)||t.renderChosenPerson(e),function(){return t.removePerson(e)})}))):e=null,a(E(),e,o,this._userInput,this.onUserKeyDown,this.onUserKeyUp)}},{key:"gainedFocus",value:function(){var e=this.renderRoot.querySelector(".people-list"),t=this.renderRoot.querySelector(".people-chosen-input");t.focus(),t.select(),e&&e.setAttribute("style","display:block")}},{key:"lostFocus",value:function(){var e=this.renderRoot.querySelector(".people-list");e&&e.setAttribute("style","display:none")}},{key:"renderHighlightText",value:function(e){var t=e,o=t.displayName.toLowerCase().indexOf(this._userInput.toLowerCase());return-1!==o&&(0===o?(t.first="",t.highlight=t.displayName.slice(0,this._userInput.length),t.last=t.displayName.slice(this._userInput.length,t.displayName.length)):o===t.displayName.length?(t.first=t.displayName.slice(0,o),t.highlight=t.displayName.slice(o,t.displayName.length),t.last=""):(t.first=t.displayName.slice(0,o),t.highlight=t.displayName.slice(o,o+this._userInput.length),t.last=t.displayName.slice(o+this._userInput.length,t.displayName.length))),a(U(),t.first,t.highlight,t.last)}},{key:"renderPeopleList",value:function(){var e,t=this.people;return t&&(t=t.slice(0,this.showMax),this.isLoading?e=this.renderTemplate("loading",null,"loading")||this.renderLoadingMessage():0===t.length&&this._userInput.length>0?e=this.renderTemplate("error",null,"error")||this.renderErrorMessage():(t[0]&&(t[0].isSelected="fill"),e=this.renderPeople(t))),a(C(),e)}},{key:"renderPeople",value:function(e){var t=this;return a(P(),k(e,function(e){return e.id},function(e){return a(S(),"fill"===e.isSelected?"people-person-list-fill":"people-person-list",function(){return t.addPerson(e)},t.renderTemplate("person",{person:e},e.displayName)||t.renderPerson(e),e.displayName,t.renderHighlightText(e),e.jobTitle)}))}},{key:"renderPerson",value:function(e){return a(I(),e,"@")}},{key:"renderChosenPerson",value:function(e){return a(w(),e,"@")}}],[{key:"styles",get:function(){return b}}]),t}();function j(){var e=t([" <mgt-mock-provider></mgt-mock-provider> <mgt-people-picker></mgt-people-picker> "]);return j=function(){return e},e}N([u({attribute:"people",type:Object})],_.prototype,"people",void 0),N([u({attribute:"show-max",type:Number})],_.prototype,"showMax",void 0),N([u({attribute:"group-id",type:String})],_.prototype,"groupId",void 0),N([u({attribute:"selected-people",type:Array})],_.prototype,"selectedPeople",void 0),N([u()],_.prototype,"_userInput",void 0),_=N([g("mgt-people-picker")],_);e("default",{title:"Mock Provider|mgt-people-picker",component:"mgt-people-picker",decorators:[c,h]}),e("peoplePicker",function(){return a(j())})}}});
//# sourceMappingURL=peoplePicker.stories-7f6cffa4.js.map
