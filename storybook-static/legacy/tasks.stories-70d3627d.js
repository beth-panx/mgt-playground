System.register(["./lit-html-de476c62.js","./index-14c7f544.js","./Graph-edc653e3.js","./mgt-mock-provider-ad9c32b1.js","./repeat-c6afd687.js"],function(e){"use strict";var t,n,a,s,r,o,i,l,k,c,u,d,p,T,h,f,g,m,v,C,w,x,D,b;return{setters:[function(e){t=e.v,n=e.a,a=e.b,s=e.c,r=e.d,o=e.e,i=e._,l=e.f,k=e.u,c=e.h,u=e.q},function(e){d=e.e,p=e.f},function(e){T=e.c,h=e.p,f=e.a,g=e.k,m=e.f,v=e.P,C=e.b,w=e.h,x=e.l,D=e.M},function(){},function(e){b=e.r}],execute:function(){function y(){var e=t([':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\E70D"}.ms-Icon--ChevronUp::before{content:"\\E70E"}.ms-Icon--Contact::before{content:"\\E77B"}.ms-Icon--AddFriend::before{content:"\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\EB6D"}mgt-tasks,:host{font-family:var(--default-font-family, "Segoe UI");display:flex;flex-direction:column}mgt-tasks .TaskIcon,:host .TaskIcon{font-family:FabricMDL2Icons;text-align:center;justify-self:center;align-content:center;align-self:center;vertical-align:middle;user-select:none;-moz-user-select:none;-ms-user-select:none}mgt-tasks .Header,:host .Header{padding:var(--tasks-header-padding,0 10px 0 10px);margin:var(--tasks-header-margin,0 0 10px 0)}mgt-tasks .TaskIcon.Divider,:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}mgt-tasks .Header .PlannerTitle,:host .Header .PlannerTitle{padding:var(--tasks-title-padding,0 0 0 0);display:flex;align-items:center;align-content:center}mgt-tasks select,:host select{font-family:var(--default-font-family, "Segoe UI");border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}mgt-tasks select::-ms-expand,:host select::-ms-expand{display:none}mgt-tasks .PlannerTitle select,:host .PlannerTitle select,mgt-tasks .Header .PlannerTitle .PlanTitle,:host .Header .PlannerTitle .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}mgt-tasks .Header .AddBar,:host .Header .AddBar{display:flex}mgt-tasks .Header .AddBar .AddBarItem,:host .Header .AddBar .AddBarItem{flex:1 1 auto}mgt-tasks .Header .NewTaskDue,:host .Header .NewTaskDue{display:flex}mgt-tasks .Header .NewTaskDue input,:host .Header .NewTaskDue input{flex:1 1 auto}mgt-tasks .Header .TitleCont,:host .Header .TitleCont{flex:1 1 auto;height:var(--tasks-new-button-height,34px)}mgt-tasks .Header .NewTaskButton,:host .Header .NewTaskButton{flex:0 0 auto;display:inline-block;width:var(--task-new-button-width,90px);height:var(--tasks-new-button-height,32px);max-width:90px;min-width:90px;line-height:200%;text-align:center;align-content:center;align-self:center;vertical-align:middle;justify-self:flex-end;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}mgt-tasks .Header .NewTaskButton:hover,:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#0091ff)}mgt-tasks .Header .NewTaskButton:active,:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#00508d)}mgt-tasks .Task,:host .Task{margin:var(--task-margin,0 10px 10px 10px);padding:var(--task-padding,0 0 0 0);box-shadow:var(--task-box-shadow,0 2px 8px rgba(0,0,0,.092));background:var(--task-background,#fff);position:relative}mgt-tasks .Task .TaskContent,:host .Task .TaskContent{display:flex;flex-direction:row}mgt-tasks .Task .TaskContent .TaskDetailsContainer,:host .Task .TaskContent .TaskDetailsContainer{color:var(--task-detail-color,#767676);margin:20px 0 18px 0;display:flex;flex-direction:column;flex:1 1 auto}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskTitle,:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{flex:1 0 auto;color:#333;max-width:370px;width:100%;font-size:20px;font-weight:300}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;margin:10px 0 0 0;font-size:12px;font-weight:400;align-items:center;flex-wrap:wrap}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails svg,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails svg{vertical-align:middle;margin-right:4px}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails span,mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails select,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails span,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails select{vertical-align:middle}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskDetail,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskDetail{margin:0 20px 0 0}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskIcon,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskIcon{color:#333;margin:var(--task-detail-icon-margin 0 8px 0 0)}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails mgt-people,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails mgt-people{color:var(--task-detail-color,#000);font-size:16px}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails mgt-person,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails mgt-person{display:inline-block}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker{background-color:#fff;display:block;position:absolute;box-shadow:0 3px 7px rgba(0,0,0,.3);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:450px;color:var(--task-detail-color,#000);z-index:1}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker mgt-people-picker,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker.Hidden,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker.Hidden{display:none}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails input,mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails select,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails select{color:var(--task-detail-color,#767676);font-size:.9em}mgt-tasks .Task .TaskHeader,:host .Task .TaskHeader{display:flex;justify-content:center;color:var(--task-header-color,#333);margin:var(--task-header-margin,0 0 0 10px)}mgt-tasks .Task.ReadOnly .TaskCheckContainer,:host .Task.ReadOnly .TaskCheckContainer{cursor:default}mgt-tasks .Task.Complete,:host .Task.Complete{background:var(--task-complete-background,#f6f6f6);border-color:var(--task-complete-border,#e2e2e2)}mgt-tasks .Task.Complete .TaskHeader,:host .Task.Complete .TaskHeader{color:var(--task-complete-header-color,#959595)}mgt-tasks .Task.Complete .TaskDetails,:host .Task.Complete .TaskDetails{color:var(--task-complete-detail-color #b0b0b0)}mgt-tasks .Task.Complete .TaskDetails .TaskIcon,:host .Task.Complete .TaskDetails .TaskIcon{color:var(--task-compete-detail-icon-color,#959595)}mgt-tasks .Task.NewTask,:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 10px 10px 10px));display:flex;flex-direction:row}mgt-tasks .Task.NewTask .SelfAssign,:host .Task.NewTask .SelfAssign{display:none}mgt-tasks .Task.NewTask .AssignTo,:host .Task.NewTask .AssignTo{border:0;background:0 0}mgt-tasks .Task.NewTask .FakeCheckBox,:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}mgt-tasks .Task.NewTask .FakeCheckBox::after,:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:\'\'}mgt-tasks .Task.NewTask .FakeCheckBox ~ :checked,:host .Task.NewTask .FakeCheckBox ~ :checked{font-family:FabricMDL2Icons;content:\'\'}mgt-tasks .Task.NewTask .TaskContent,:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer,:host .Task.NewTask .TaskContent .TaskDetailsContainer{margin:0}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{max-width:none}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1 0 auto;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,16px 0 0 0);padding:var(--task-new-input-padding,7px);font-size:var(--task-new-input-font-size,1em);border:var(--task-new-border,none);width:100%}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border:var(--task-new-input-active-border,none)}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer hr,:host .Task.NewTask .TaskContent .TaskDetailsContainer hr{border:var(--task-new-line-border,solid 1px #d8d8d8);margin:0}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{flex:1 0 auto;margin:14px 0 14px 4px}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select,mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input{font-family:var(--default-font-family, "Segoe UI");border:var(--task-new-select-border,none);padding:0 10px}mgt-tasks .Task.NewTask .TaskAddButtonContainer,:host .Task.NewTask .TaskAddButtonContainer{flex:0 0 auto;display:flex;align-content:center;align-items:center}mgt-tasks .Task.NewTask .TaskAddButtonContainer .TaskAdd,mgt-tasks .Task.NewTask .TaskAddButtonContainer .TaskCancel,:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{height:100%;max-width:50px;min-width:50px;flex:1 1 auto;justify-content:center;align-items:center;display:flex;cursor:pointer;color:#fff}mgt-tasks .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{background:var(--task-new-add-button-background,#0078d4)}mgt-tasks .Task.NewTask .TaskAddButtonContainer .TaskCancel,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{font-family:var(--default-font-family, "Segoe UI");color:var(--task-new-cancel-button-color,gray);margin:0 20px 0 32px}mgt-tasks .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{background:var(--task-new-add-button-disabled-background,#eaeaea);cursor:default}mgt-tasks .Task .TaskCheckContainer,:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;width:24px;height:24px;text-align:center;border-radius:50%;flex:0 0 auto;color:#fff;cursor:pointer;display:flex;align-items:center;align-content:center;justify-items:center;justify-content:center;margin:20px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}mgt-tasks .Task .TaskCheckContainer.Complete .TaskCheck,:host .Task .TaskCheckContainer.Complete .TaskCheck{background:#00b294;border-color:#00b294;display:flex;align-items:center;align-content:center;justify-items:center;justify-content:center}mgt-tasks .Task .TaskCheck,:host .Task .TaskCheck{font-family:FabricMDL2Icons;display:inline-block;width:22px;height:22px;text-align:center;border-radius:50%;border:solid 1px #666;flex:0 0 auto;color:#fff;display:flex;align-items:center;align-content:center;justify-items:center;justify-content:center;user-select:none;-moz-user-select:none;-ms-user-select:none}mgt-tasks .Task .TaskCheck.Loading,:host .Task .TaskCheck.Loading{color:#000;animation:rotateIcon 2s infinite linear}mgt-tasks .Task.LoadingTask .TaskCheckContainer,:host .Task.LoadingTask .TaskCheckContainer{cursor:default}mgt-tasks .Task.LoadingTask .TaskCheck,:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}mgt-tasks .Task.LoadingTask .TaskHeader,:host .Task.LoadingTask .TaskHeader{justify-content:flex-start;justify-items:flex-start}mgt-tasks .Task.LoadingTask .TaskDetailIcon,:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}mgt-tasks .Task.LoadingTask .TaskTitle,:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;height:20px}mgt-tasks .Task.LoadingTask .TaskDetail,:host .Task.LoadingTask .TaskDetail{margin-right:8px;display:flex;flex-direction:row;align-items:center}mgt-tasks .Task.LoadingTask .TaskDetailName,:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}mgt-tasks .Task .TaskOptions,:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;position:absolute;top:0;right:0}mgt-tasks .LoadingHeader,:host .LoadingHeader{max-width:90px;width:100%;height:20px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}'],[':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\\\\E70E"}.ms-Icon--Contact::before{content:"\\\\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\\\\EB6D"}mgt-tasks,:host{font-family:var(--default-font-family, "Segoe UI");display:flex;flex-direction:column}mgt-tasks .TaskIcon,:host .TaskIcon{font-family:FabricMDL2Icons;text-align:center;justify-self:center;align-content:center;align-self:center;vertical-align:middle;user-select:none;-moz-user-select:none;-ms-user-select:none}mgt-tasks .Header,:host .Header{padding:var(--tasks-header-padding,0 10px 0 10px);margin:var(--tasks-header-margin,0 0 10px 0)}mgt-tasks .TaskIcon.Divider,:host .TaskIcon.Divider{vertical-align:initial;margin:0 12px;font-size:16px}mgt-tasks .Header .PlannerTitle,:host .Header .PlannerTitle{padding:var(--tasks-title-padding,0 0 0 0);display:flex;align-items:center;align-content:center}mgt-tasks select,:host select{font-family:var(--default-font-family, "Segoe UI");border:none;-moz-appearance:none;-webkit-appearance:none;cursor:pointer}mgt-tasks select::-ms-expand,:host select::-ms-expand{display:none}mgt-tasks .PlannerTitle select,:host .PlannerTitle select,mgt-tasks .Header .PlannerTitle .PlanTitle,:host .Header .PlannerTitle .PlanTitle{font-family:var(--default-font-family, "Segoe UI");font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}mgt-tasks .Header .AddBar,:host .Header .AddBar{display:flex}mgt-tasks .Header .AddBar .AddBarItem,:host .Header .AddBar .AddBarItem{flex:1 1 auto}mgt-tasks .Header .NewTaskDue,:host .Header .NewTaskDue{display:flex}mgt-tasks .Header .NewTaskDue input,:host .Header .NewTaskDue input{flex:1 1 auto}mgt-tasks .Header .TitleCont,:host .Header .TitleCont{flex:1 1 auto;height:var(--tasks-new-button-height,34px)}mgt-tasks .Header .NewTaskButton,:host .Header .NewTaskButton{flex:0 0 auto;display:inline-block;width:var(--task-new-button-width,90px);height:var(--tasks-new-button-height,32px);max-width:90px;min-width:90px;line-height:200%;text-align:center;align-content:center;align-self:center;vertical-align:middle;justify-self:flex-end;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;-moz-user-select:none;-ms-user-select:none;cursor:pointer}mgt-tasks .Header .NewTaskButton:hover,:host .Header .NewTaskButton:hover{background:var(--tasks-new-button-hover-background,#0091ff)}mgt-tasks .Header .NewTaskButton:active,:host .Header .NewTaskButton:active{background:var(--tasks-new-button-active-background,#00508d)}mgt-tasks .Task,:host .Task{margin:var(--task-margin,0 10px 10px 10px);padding:var(--task-padding,0 0 0 0);box-shadow:var(--task-box-shadow,0 2px 8px rgba(0,0,0,.092));background:var(--task-background,#fff);position:relative}mgt-tasks .Task .TaskContent,:host .Task .TaskContent{display:flex;flex-direction:row}mgt-tasks .Task .TaskContent .TaskDetailsContainer,:host .Task .TaskContent .TaskDetailsContainer{color:var(--task-detail-color,#767676);margin:20px 0 18px 0;display:flex;flex-direction:column;flex:1 1 auto}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskTitle,:host .Task .TaskContent .TaskDetailsContainer .TaskTitle{flex:1 0 auto;color:#333;max-width:370px;width:100%;font-size:20px;font-weight:300}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails{display:flex;margin:10px 0 0 0;font-size:12px;font-weight:400;align-items:center;flex-wrap:wrap}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails svg,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails svg{vertical-align:middle;margin-right:4px}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails span,mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails select,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails span,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails select{vertical-align:middle}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskDetail,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskDetail{margin:0 20px 0 0}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskIcon,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails .TaskIcon{color:#333;margin:var(--task-detail-icon-margin 0 8px 0 0)}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails mgt-people,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails mgt-people{color:var(--task-detail-color,#000);font-size:16px}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails mgt-person,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails mgt-person{display:inline-block}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker{background-color:#fff;display:block;position:absolute;box-shadow:0 3px 7px rgba(0,0,0,.3);-webkit-background-clip:padding-box;-moz-background-clip:padding-box;background-clip:padding-box;width:450px;color:var(--task-detail-color,#000);z-index:1}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker mgt-people-picker,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker mgt-people-picker{--separator-margin:0px 10px 0px 10px}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker.Hidden,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails .Picker.Hidden{display:none}mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails input,mgt-tasks .Task .TaskContent .TaskDetailsContainer .TaskDetails select,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task .TaskContent .TaskDetailsContainer .TaskDetails select{color:var(--task-detail-color,#767676);font-size:.9em}mgt-tasks .Task .TaskHeader,:host .Task .TaskHeader{display:flex;justify-content:center;color:var(--task-header-color,#333);margin:var(--task-header-margin,0 0 0 10px)}mgt-tasks .Task.ReadOnly .TaskCheckContainer,:host .Task.ReadOnly .TaskCheckContainer{cursor:default}mgt-tasks .Task.Complete,:host .Task.Complete{background:var(--task-complete-background,#f6f6f6);border-color:var(--task-complete-border,#e2e2e2)}mgt-tasks .Task.Complete .TaskHeader,:host .Task.Complete .TaskHeader{color:var(--task-complete-header-color,#959595)}mgt-tasks .Task.Complete .TaskDetails,:host .Task.Complete .TaskDetails{color:var(--task-complete-detail-color #b0b0b0)}mgt-tasks .Task.Complete .TaskDetails .TaskIcon,:host .Task.Complete .TaskDetails .TaskIcon{color:var(--task-compete-detail-icon-color,#959595)}mgt-tasks .Task.NewTask,:host .Task.NewTask{margin:var(--task-new-margin,var(--task-margin,0 10px 10px 10px));display:flex;flex-direction:row}mgt-tasks .Task.NewTask .SelfAssign,:host .Task.NewTask .SelfAssign{display:none}mgt-tasks .Task.NewTask .AssignTo,:host .Task.NewTask .AssignTo{border:0;background:0 0}mgt-tasks .Task.NewTask .FakeCheckBox,:host .Task.NewTask .FakeCheckBox{width:15px;height:15px;cursor:pointer;margin:0 5px 0 5px}mgt-tasks .Task.NewTask .FakeCheckBox::after,:host .Task.NewTask .FakeCheckBox::after{font-family:FabricMDL2Icons;content:\'\\uE739\'}mgt-tasks .Task.NewTask .FakeCheckBox ~ :checked,:host .Task.NewTask .FakeCheckBox ~ :checked{font-family:FabricMDL2Icons;content:\'\\uE73A\'}mgt-tasks .Task.NewTask .TaskContent,:host .Task.NewTask .TaskContent{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer,:host .Task.NewTask .TaskContent .TaskDetailsContainer{margin:0}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle{max-width:none}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input{flex:1 0 auto;font-family:var(--default-font-family, "Segoe UI");margin:var(--task-new-input-margin,16px 0 0 0);padding:var(--task-new-input-padding,7px);font-size:var(--task-new-input-font-size,1em);border:var(--task-new-border,none);width:100%}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskTitle input:active{border:var(--task-new-input-active-border,none)}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer hr,:host .Task.NewTask .TaskContent .TaskDetailsContainer hr{border:var(--task-new-line-border,solid 1px #d8d8d8);margin:0}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails{flex:1 0 auto;margin:14px 0 14px 4px}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails .TaskPeople label{display:flex;align-content:center;align-items:center}mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select,mgt-tasks .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails select,:host .Task.NewTask .TaskContent .TaskDetailsContainer .TaskDetails input{font-family:var(--default-font-family, "Segoe UI");border:var(--task-new-select-border,none);padding:0 10px}mgt-tasks .Task.NewTask .TaskAddButtonContainer,:host .Task.NewTask .TaskAddButtonContainer{flex:0 0 auto;display:flex;align-content:center;align-items:center}mgt-tasks .Task.NewTask .TaskAddButtonContainer .TaskAdd,mgt-tasks .Task.NewTask .TaskAddButtonContainer .TaskCancel,:host .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{height:100%;max-width:50px;min-width:50px;flex:1 1 auto;justify-content:center;align-items:center;display:flex;cursor:pointer;color:#fff}mgt-tasks .Task.NewTask .TaskAddButtonContainer .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer .TaskAdd{background:var(--task-new-add-button-background,#0078d4)}mgt-tasks .Task.NewTask .TaskAddButtonContainer .TaskCancel,:host .Task.NewTask .TaskAddButtonContainer .TaskCancel{font-family:var(--default-font-family, "Segoe UI");color:var(--task-new-cancel-button-color,gray);margin:0 20px 0 32px}mgt-tasks .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd,:host .Task.NewTask .TaskAddButtonContainer.Disabled .TaskAdd{background:var(--task-new-add-button-disabled-background,#eaeaea);cursor:default}mgt-tasks .Task .TaskCheckContainer,:host .Task .TaskCheckContainer{font-family:FabricMDL2Icons;display:inline-block;width:24px;height:24px;text-align:center;border-radius:50%;flex:0 0 auto;color:#fff;cursor:pointer;display:flex;align-items:center;align-content:center;justify-items:center;justify-content:center;margin:20px 10px 20px 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}mgt-tasks .Task .TaskCheckContainer.Complete .TaskCheck,:host .Task .TaskCheckContainer.Complete .TaskCheck{background:#00b294;border-color:#00b294;display:flex;align-items:center;align-content:center;justify-items:center;justify-content:center}mgt-tasks .Task .TaskCheck,:host .Task .TaskCheck{font-family:FabricMDL2Icons;display:inline-block;width:22px;height:22px;text-align:center;border-radius:50%;border:solid 1px #666;flex:0 0 auto;color:#fff;display:flex;align-items:center;align-content:center;justify-items:center;justify-content:center;user-select:none;-moz-user-select:none;-ms-user-select:none}mgt-tasks .Task .TaskCheck.Loading,:host .Task .TaskCheck.Loading{color:#000;animation:rotateIcon 2s infinite linear}mgt-tasks .Task.LoadingTask .TaskCheckContainer,:host .Task.LoadingTask .TaskCheckContainer{cursor:default}mgt-tasks .Task.LoadingTask .TaskCheck,:host .Task.LoadingTask .TaskCheck{background:#f2f2f2;border-color:#f2f2f2;cursor:default}mgt-tasks .Task.LoadingTask .TaskHeader,:host .Task.LoadingTask .TaskHeader{justify-content:flex-start;justify-items:flex-start}mgt-tasks .Task.LoadingTask .TaskDetailIcon,:host .Task.LoadingTask .TaskDetailIcon{width:16px;height:16px;margin:5px;background:#f2f2f2}mgt-tasks .Task.LoadingTask .TaskTitle,:host .Task.LoadingTask .TaskTitle{background:#f2f2f2;height:20px}mgt-tasks .Task.LoadingTask .TaskDetail,:host .Task.LoadingTask .TaskDetail{margin-right:8px;display:flex;flex-direction:row;align-items:center}mgt-tasks .Task.LoadingTask .TaskDetailName,:host .Task.LoadingTask .TaskDetailName{width:81px;height:10px;background:#f2f2f2}mgt-tasks .Task .TaskOptions,:host .Task .TaskOptions{cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;position:absolute;top:0;right:0}mgt-tasks .LoadingHeader,:host .LoadingHeader{max-width:90px;width:100%;height:20px;background:#f2f2f2}@keyframes rotateIcon{from{transform:rotate(0)}to{transform:rotate(360deg)}}']);return y=function(){return e},e}var I=[T(y())],_=function(e,t,n,a){return new(n||(n=Promise))(function(s,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((a=a.apply(e,t||[])).next())})},N=function e(t){a(this,e),this.graph=t},H=function(e){function t(){return a(this,t),s(this,r(t).apply(this,arguments))}return n(t,N),o(t,[{key:"getTaskGroups",value:function(){return _(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.graph.planner_getAllMyPlans();case 2:return t=e.sent,e.abrupt("return",t.map(function(e){return{id:e.id,title:e.title}}));case 4:case"end":return e.stop()}},e,this)}))}},{key:"getTaskGroupsForGroup",value:function(e){return _(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.graph.getPlansForGroup(e);case 2:return n=t.sent,t.abrupt("return",n.map(function(e){return{id:e.id,title:e.title}}));case 4:case"end":return t.stop()}},t,this)}))}},{key:"getTaskGroup",value:function(e){return _(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.graph.planner_getSinglePlan(e);case 2:return n=t.sent,t.abrupt("return",{id:n.id,title:n.title,_raw:n});case 4:case"end":return t.stop()}},t,this)}))}},{key:"getTaskFoldersForTaskGroup",value:function(e){return _(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.graph.planner_getBucketsForPlan(e);case 2:return n=t.sent,t.abrupt("return",n.map(function(e){return{_raw:e,id:e.id,name:e.name,parentId:e.planId}}));case 4:case"end":return t.stop()}},t,this)}))}},{key:"getTasksForTaskFolder",value:function(e){return _(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.graph.planner_getTasksForBucket(e);case 2:return n=t.sent,t.abrupt("return",n.map(function(e){return{_raw:e,assignments:e.assignments,completed:100===e.percentComplete,dueDate:e.dueDateTime&&new Date(e.dueDateTime),eTag:e["@odata.etag"],id:e.id,immediateParentId:e.bucketId,name:e.title,topParentId:e.planId}}));case 4:case"end":return t.stop()}},t,this)}))}},{key:"setTaskComplete",value:function(e,t){return _(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.graph.planner_setTaskComplete(e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"setTaskIncomplete",value:function(e,t){return _(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.graph.planner_setTaskIncomplete(e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"addTask",value:function(e){return _(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.graph.planner_addTask({assignments:e.assignments,bucketId:e.immediateParentId,dueDateTime:e.dueDate&&e.dueDate.toISOString(),planId:e.topParentId,title:e.name});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}))}},{key:"assignPeopleToTask",value:function(e,t,n){return _(this,void 0,void 0,regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.graph.planner_assignPeopleToTask(e,t,n);case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},a,this)}))}},{key:"removeTask",value:function(e,t){return _(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.graph.planner_removeTask(e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"isAssignedToMe",value:function(e,t){return Object.keys(e.assignments).includes(t)}}]),t}(),P=function(e){function t(){return a(this,t),s(this,r(t).apply(this,arguments))}return n(t,N),o(t,[{key:"getTaskGroups",value:function(){return _(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.graph.todo_getAllMyGroups();case 2:return t=e.sent,e.abrupt("return",t.map(function(e){return{_raw:e,id:e.id,secondaryId:e.groupKey,title:e.name}}));case 4:case"end":return e.stop()}},e,this)}))}},{key:"getTaskGroup",value:function(e){return _(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.graph.todo_getSingleGroup(e);case 2:return n=t.sent,t.abrupt("return",{id:n.id,secondaryId:n.groupKey,title:n.name,_raw:n});case 4:case"end":return t.stop()}},t,this)}))}},{key:"getTaskFoldersForTaskGroup",value:function(e){return _(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.graph.todo_getFoldersForGroup(e);case 2:return n=t.sent,t.abrupt("return",n.map(function(t){return{_raw:t,id:t.id,name:t.name,parentId:e}}));case 4:case"end":return t.stop()}},t,this)}))}},{key:"getTasksForTaskFolder",value:function(e,t){return _(this,void 0,void 0,regeneratorRuntime.mark(function n(){var a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.graph.todo_getAllTasksForFolder(e);case 2:return a=n.sent,n.abrupt("return",a.map(function(n){return{_raw:n,assignments:{},completed:!!n.completedDateTime,dueDate:n.dueDateTime&&new Date(n.dueDateTime.dateTime+"Z"),eTag:n["@odata.etag"],id:n.id,immediateParentId:e,name:n.subject,topParentId:t}}));case 4:case"end":return n.stop()}},n,this)}))}},{key:"setTaskComplete",value:function(e,t){return _(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.graph.todo_setTaskComplete(e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"assignPeopleToTask",value:function(e,t,n){return _(this,void 0,void 0,regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.graph.planner_assignPeopleToTask(e,t,n);case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},a,this)}))}},{key:"setTaskIncomplete",value:function(e,t){return _(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.graph.todo_setTaskIncomplete(e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"addTask",value:function(e){return _(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={parentFolderId:e.immediateParentId,subject:e.name},e.dueDate&&(n.dueDateTime={dateTime:e.dueDate.toISOString(),timeZone:"UTC"}),t.next=4,this.graph.todo_addTask(n);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t,this)}))}},{key:"removeTask",value:function(e,t){return _(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.graph.todo_removeTask(e,t);case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}))}},{key:"isAssignedToMe",value:function(e,t){return!0}},{key:"getTaskGroupsForGroup",value:function(e){return _(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}},e)}))}}]),t}();function S(){var e=t([":host,mgt-arrow-options{position:relative;font-family:'Segoe UI';margin:0 0 12px 0}:host .ArrowIcon,mgt-arrow-options .ArrowIcon{font-family:FabricMDL2Icons;margin:0 0 0 20px;user-select:none;-moz-user-select:none;-ms-user-select:none}:host .Header,mgt-arrow-options .Header{cursor:pointer}:host .Header:hover,mgt-arrow-options .Header:hover{color:var(--theme-primary-color);background-color:var(--background-color--hover)}:host .Menu,mgt-arrow-options .Menu{position:absolute;left:0;box-shadow:rgba(0,0,0,.08) 0 0 40px 5px;background:#fff;z-index:1;display:none;color:#000;white-space:nowrap}:host .Menu.Open,mgt-arrow-options .Menu.Open{display:block}:host .MenuOption,mgt-arrow-options .MenuOption{padding:20px;cursor:pointer;user-select:none;-moz-user-select:none;-ms-user-select:none;display:flex;align-items:center;justify-content:stretch;justify-items:stretch}:host .MenuOption:first,mgt-arrow-options .MenuOption:first{padding:12px 20px 20px 20px}:host .MenuOption:hover,mgt-arrow-options .MenuOption:hover{background:silver}:host .MenuOption:active,mgt-arrow-options .MenuOption:active{background:#d8d8d8}:host .MenuOptionCheck,mgt-arrow-options .MenuOptionCheck{font-family:FabricMDL2Icons;color:transparent;margin-right:10px}:host .MenuOptionCheck.CurrentValue,mgt-arrow-options .MenuOptionCheck.CurrentValue{color:#0078d4}"]);return S=function(){return e},e}var F=[T(S())];function A(){var e=t([' <div class="MenuOption" @click="','"> <span class="','">  </span> <span class="MenuOptionName">',"</span> </div> "],[' <div class="MenuOption" @click="','"> <span class="','"> \\uE73E </span> <span class="MenuOptionName">',"</span> </div> "]);return A=function(){return e},e}function B(){var e=t([' <span class="Header" @click="','"> <span class="CurrentValue">','</span> </span> <div class="','"> '," </div> "]);return B=function(){return e},e}var L=function(e,t,n,a){var s,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},M=function(e){function t(){var e;return a(this,t),(e=s(this,r(t).call(this))).open=!1,e.value="",e.options={},e._clickHandler=function(t){return e.open=!1},e}return n(t,m),o(t,[{key:"connectedCallback",value:function(){l(r(t.prototype),"connectedCallback",this).call(this),window.addEventListener("click",this._clickHandler)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("click",this._clickHandler),l(r(t.prototype),"disconnectedCallback",this).call(this)}},{key:"onHeaderClick",value:function(e){Object.keys(this.options).length>1&&(e.preventDefault(),e.stopPropagation(),this.open=!this.open)}},{key:"render",value:function(){var e=this;return k(B(),function(t){return e.onHeaderClick(t)},this.value,g({Menu:!0,Open:this.open,Closed:!this.open}),this.getMenuOptions())}},{key:"getMenuOptions",value:function(){var e=this,t=Object.keys(this.options),n=this.options;return t.map(function(t){return k(A(),function(a){e.open=!1,n[t](a)},g({MenuOptionCheck:!0,CurrentValue:e.value===t}),t)})}}],[{key:"styles",get:function(){return F}}]),t}();function V(){var e=t([':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\E70D"}.ms-Icon--ChevronUp::before{content:"\\E70E"}.ms-Icon--Contact::before{content:"\\E77B"}.ms-Icon--AddFriend::before{content:"\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\EB6D"}:host,mgt-dot-options{font-family:\'Segoe UI\'}:host .DotIcon,mgt-dot-options .DotIcon{display:inline-block;font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .Menu,mgt-dot-options .Menu{position:absolute;box-shadow:rgba(0,0,0,.08) 0 0 40px 5px;background:#fff;z-index:1;display:none;color:#000;white-space:nowrap;transform:translateX(-50px)}:host .DotMenu.Open .Menu,mgt-dot-options .DotMenu.Open .Menu{display:block}:host .DotMenu .DotItem,mgt-dot-options .DotMenu .DotItem{direction:ltr;text-align:left;padding:10px 10px 8px 10px}:host .DotMenu .DotItem:hover,mgt-dot-options .DotMenu .DotItem:hover{background:silver}:host .DotMenu .DotItem:active,mgt-dot-options .DotMenu .DotItem:active{background:#d8d8d8}:host .DotMenu .DotItemName,mgt-dot-options .DotMenu .DotItemName{direction:rtl}'],[':host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\\\\E70E"}.ms-Icon--Contact::before{content:"\\\\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\\\\EB6D"}:host,mgt-dot-options{font-family:\'Segoe UI\'}:host .DotIcon,mgt-dot-options .DotIcon{display:inline-block;font-family:FabricMDL2Icons;min-width:40px;min-height:30px;text-align:center;line-height:30px}:host .Menu,mgt-dot-options .Menu{position:absolute;box-shadow:rgba(0,0,0,.08) 0 0 40px 5px;background:#fff;z-index:1;display:none;color:#000;white-space:nowrap;transform:translateX(-50px)}:host .DotMenu.Open .Menu,mgt-dot-options .DotMenu.Open .Menu{display:block}:host .DotMenu .DotItem,mgt-dot-options .DotMenu .DotItem{direction:ltr;text-align:left;padding:10px 10px 8px 10px}:host .DotMenu .DotItem:hover,mgt-dot-options .DotMenu .DotItem:hover{background:silver}:host .DotMenu .DotItem:active,mgt-dot-options .DotMenu .DotItem:active{background:#d8d8d8}:host .DotMenu .DotItemName,mgt-dot-options .DotMenu .DotItemName{direction:rtl}']);return V=function(){return e},e}L([h({type:Boolean})],M.prototype,"open",void 0),L([h({type:String})],M.prototype,"value",void 0),L([h({type:Object})],M.prototype,"options",void 0),M=L([f("mgt-arrow-options")],M);var E=[T(V())];function O(){var e=t([' <div class="DotItem" @click="','"> <span class="DotItemName"> '," </span> </div> "]);return O=function(){return e},e}function R(){var e=t([' <div class="','" @click="','"> <span class="DotIcon"></span> <div class="Menu"> '," </div> </div> "],[' <div class="','" @click="','"> <span class="DotIcon">\\uE712</span> <div class="Menu"> '," </div> </div> "]);return R=function(){return e},e}var G=function(e,t,n,a){var s,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},U=function(e){function t(){var e;return a(this,t),(e=s(this,r(t).call(this))).open=!1,e.options=null,e._clickHandler=null,e._clickHandler=function(t){return e.open=!1},e}return n(t,m),o(t,[{key:"connectedCallback",value:function(){l(r(t.prototype),"connectedCallback",this).call(this),window.addEventListener("click",this._clickHandler)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("click",this._clickHandler),l(r(t.prototype),"disconnectedCallback",this).call(this)}},{key:"render",value:function(){var e=this;return k(R(),g({DotMenu:!0,Open:this.open}),function(t){return e.onDotClick(t)},Object.keys(this.options).map(function(t){return e.getMenuOption(t,e.options[t])}))}},{key:"getMenuOption",value:function(e,t){var n=this;return k(O(),function(e){e.preventDefault(),e.stopPropagation(),t(e),n.open=!1},e)}},{key:"onDotClick",value:function(e){e.preventDefault(),e.stopPropagation(),this.open=!this.open}}],[{key:"styles",get:function(){return E}}]),t}();function j(){var e=t([' <svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M12 7H11V8H12V7ZM9 13H8V14H9V13ZM6 7H5V8H6V7ZM9 7H8V8H9V7ZM12 9H11V10H12V9ZM15 9H14V10H15V9ZM6 9H5V10H6V9ZM9 9H8V10H9V9ZM12 11H11V12H12V11ZM15 11H14V12H15V11ZM6 11H5V12H6V11ZM9 11H8V12H9V11ZM12 13H11V14H12V13ZM15 13H14V14H15V13ZM2 2V16H18V2H15V1H14V2H6V1H5V2H2ZM17 3V5H3V3H5V4H6V3H14V4H15V3H17ZM3 15V6H17V15H3Z" fill="#3C3C3C"/> </svg> ']);return j=function(){return e},e}function z(){var e=t([' <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"> <path fill-rule="evenodd" clip-rule="evenodd" d="M14 2H2V4H3H5H6H10H11H13H14V2ZM10 5H6V6H10V5ZM5 5H3V14H13V5H11V6C11 6.55228 10.5523 7 10 7H6C5.44772 7 5 6.55228 5 6V5ZM1 5H2V14V15H3H13H14V14V5H15V4V2V1H14H2H1V2V4V5Z" fill="#3C3C3C"/> </svg> ']);return z=function(){return e},e}function Z(){var e=t([' <svg width="16" height="18" viewBox="0 0 16 18" fill="none" xmlns="http://www.w3.org/2000/svg"> <path fill-rule="evenodd" clip-rule="evenodd" d="M7.223 1.156C6.98 1.26 6.769 1.404 6.586 1.586C6.403 1.768 6.261 1.98 6.157 2.223C6.052 2.465 6 2.724 6 3H2V17H14V3H10C10 2.724 9.948 2.465 9.844 2.223C9.74 1.98 9.596 1.768 9.414 1.586C9.231 1.404 9.02 1.26 8.777 1.156C8.535 1.053 8.276 1 8 1C7.723 1 7.465 1.053 7.223 1.156ZM5 4H7V3C7 2.86 7.026 2.729 7.078 2.609C7.13 2.49 7.202 2.385 7.293 2.293C7.384 2.202 7.49 2.131 7.609 2.079C7.73 2.026 7.859 2 8 2C8.14 2 8.271 2.026 8.39 2.079C8.511 2.131 8.616 2.202 8.707 2.293C8.798 2.385 8.87 2.49 8.922 2.609C8.974 2.729 9 2.86 9 3V4H11V5H5V4ZM12 6V4H13V16H3V4H4V6H12Z" fill="#3C3C3C"/> <path fill-rule="evenodd" clip-rule="evenodd" d="M7.35156 12.3517L5.49956 14.2037L4.14856 12.8517L4.85156 12.1487L5.49956 12.7967L6.64856 11.6487L7.35156 12.3517Z" fill="#3C3C3C"/> <path fill-rule="evenodd" clip-rule="evenodd" d="M7.35156 8.35168L5.49956 10.2037L4.14856 8.85168L4.85156 8.14868L5.49956 8.79668L6.64856 7.64868L7.35156 8.35168Z" fill="#3C3C3C"/> <path fill-rule="evenodd" clip-rule="evenodd" d="M8 14H12.001V13H8V14Z" fill="#3C3C3C"/> <path fill-rule="evenodd" clip-rule="evenodd" d="M8 10H12.001V9H8V10Z" fill="#3C3C3C"/> </svg> ']);return Z=function(){return e},e}function K(){var e=t([' <div class="Task LoadingTask"> <div class="TaskContent"> <div class="TaskCheckContainer"> <div class="TaskCheck"></div> </div> <div class="TaskDetailsContainer"> <div class="TaskTitle"></div> <div class="TaskDetails"> <span class="TaskDetail"> <div class="TaskDetailIcon"></div> <div class="TaskDetailName"></div> </span> <span class="TaskDetail"> <div class="TaskDetailIcon"></div> <div class="TaskDetailName"></div> </span> <span class="TaskDetail"> <div class="TaskDetailIcon"></div> <div class="TaskDetailName"></div> </span> <span class="TaskDetail"> <div class="TaskDetailIcon"></div> <div class="TaskDetailName"></div> </span> </div> </div> </div> </div> ']);return K=function(){return e},e}function W(){var e=t([' <div class="','"> <div class="TaskContent" @click="','"> <span class="','" @click="','"> ',' </span> <div class="TaskDetailsContainer"> '," </div> </div> "," </div> "]);return W=function(){return e},e}function q(){var e=t([' <div class="TaskOptions"> <mgt-dot-options .options="','"></mgt-dot-options> </div> ']);return q=function(){return e},e}function X(){var e=t([' <div class="TaskTitle"> ',' </div> <div class="TaskDetails"> '," "," "," "," </div> "]);return X=function(){return e},e}function J(){var e=t([' <span class="TaskDetail TaskBucket" @click="','"> ',' <div class="','"> <mgt-people-picker class="picker-','" @click="','"></mgt-people-picker> </div> </span> ']);return J=function(){return e},e}function Q(){var e=t([' <mgt-people class="people-','" .userIds="','" .personCardInteraction="','">'," </mgt-people> "]);return Q=function(){return e},e}function Y(){var e=t([' <template data-type="no-people"> <i class="login-icon ms-Icon ms-Icon--Contact"></i> </template> ']);return Y=function(){return e},e}function $(){var e=t([' <span class="TaskDetail TaskDue"> '," <span>","</span> </span> "]);return $=function(){return e},e}function ee(){var e=t([' <span class="TaskDetail TaskBucket"> '," <span>","</span> </span> "]);return ee=function(){return e},e}function te(){var e=t([' <span class="TaskDetail TaskAssignee"> '," <span>","</span> </span> "]);return te=function(){return e},e}function ne(){var e=t([' <span class="','">',"</span> "]);return ne=function(){return e},e}function ae(){var e=t(["  "],[" \\uE73E "]);return ae=function(){return e},e}function se(){var e=t(["  "],[" \\uF16A "]);return se=function(){return e},e}function re(){var e=t([' <div class="Task NewTask Incomplete"> <div class="TaskContent"> <div class="TaskDetailsContainer"> <div class="TaskTitle"> ',' </div> <hr> <div class="TaskDetails"> '," "," "," "," </div> </div> </div> "," </div> "]);return re=function(){return e},e}function oe(){var e=t([' <div class="TaskAddButtonContainer ','"> <div class="TaskIcon TaskCancel" @click="','"> <span>Cancel</span> </div> <div class="TaskIcon TaskAdd" @click="','"> <span></span> </div> </div> '],[' <div class="TaskAddButtonContainer ','"> <div class="TaskIcon TaskCancel" @click="','"> <span>Cancel</span> </div> <div class="TaskIcon TaskAdd" @click="','"> <span>\\uE710</span> </div> </div> ']);return oe=function(){return e},e}function ie(){var e=t([' <div class="TaskAddButtonContainer"></div> ']);return ie=function(){return e},e}function le(){var e=t([' <span class="TaskDetail TaskPeople"> <span @click="','"> ',' <div class="','"> <mgt-people-picker class="picker-newTask" @click="','"></mgt-people-picker> </div> </span> </span> ']);return le=function(){return e},e}function ke(){var e=t([' <mgt-people class="people-newTask" .userIds="','" .personCardInteraction="','"> <template data-type="no-people"> <i class="login-icon ms-Icon ms-Icon--Contact"></i> </template> </mgt-people> ']);return ke=function(){return e},e}function ce(){var e=t([' <span class="TaskDetail TaskDue"> ',' <input type="date" label="new-taskDate-input" aria-label="new-taskDate-input" role="input" .value="','" @change="','"> </span> ']);return ce=function(){return e},e}function ue(){var e=t([' <option value="','">',"</option> "]);return ue=function(){return e},e}function de(){var e=t([' <span class="TaskDetail TaskBucket"> ',' <select .value="','" @change="','"> '," </select> </span> "]);return de=function(){return e},e}function pe(){var e=t([' <span class="TaskDetail TaskBucket"> '," <span>","</span> </span> "]);return pe=function(){return e},e}function Te(){var e=t([' <option value="','">',"</option> "]);return Te=function(){return e},e}function he(){var e=t([' <span class="TaskDetail TaskAssignee"> ',' <select .value="','" @change="','"> '," </select> </span> "]);return he=function(){return e},e}function fe(){var e=t([' <span class="TaskDetail TaskAssignee"> '," <span>","</span> </span> "]);return fe=function(){return e},e}function ge(){var e=t([' <input type="text" placeholder="Task..." .value="','" label="new-taskName-input" aria-label="new-taskName-input" role="input" @input="','"> ']);return ge=function(){return e},e}function me(){var e=t([' <span class="TitleCont"> '," </span> "," "]);return me=function(){return e},e}function ve(){var e=t([' <mgt-arrow-options .value="','" .options="','"></mgt-arrow-options> ']);return ve=function(){return e},e}function Ce(){var e=t([' <span class="PlanTitle"> '," </span> "]);return Ce=function(){return e},e}function we(){var e=t([' <span class="TitleCont"> '," "," "," </span> "," "]);return we=function(){return e},e}function xe(){var e=t([' <mgt-arrow-options .options="','" .value="','"></mgt-arrow-options> ']);return xe=function(){return e},e}function De(){var e=t([' <span class="PlanTitle"> '," </span> "]);return De=function(){return e},e}function be(){var e=t([' <span class="TaskIcon Divider">/</span> ']);return be=function(){return e},e}function ye(){var e=t([' <mgt-arrow-options .options="','" .value="','"></mgt-arrow-options> ']);return ye=function(){return e},e}function Ie(){var e=t([' <span class="AddBarItem NewTaskButton" @click="','"> <span class="TaskIcon"></span> <span>Add</span> </span> '],[' <span class="AddBarItem NewTaskButton" @click="','"> <span class="TaskIcon">\\uE710</span> <span>Add</span> </span> ']);return Ie=function(){return e},e}function _e(){var e=t([' <span class="LoadingHeader"></span> ']);return _e=function(){return e},e}function Ne(){var e=t([" ",' <div class="Tasks"> '," "," "," </div> "]);return Ne=function(){return e},e}function He(){var e=t([' <div class="Header"> <span class="PlannerTitle"> '," </span> </div> "]);return He=function(){return e},e}G([h({type:Boolean})],U.prototype,"open",void 0),G([h({type:Object})],U.prototype,"options",void 0),U=G([f("mgt-dot-options")],U);var Pe,Se=function(e,t,n,a){var s,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"===("undefined"==typeof Reflect?"undefined":i(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},Fe=function(e,t,n,a){return new(n||(n=Promise))(function(s,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function i(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((a=a.apply(e,t||[])).next())})};!function(e){e[e.planner=0]="planner",e[e.todo=1]="todo"}(Pe||(Pe={}));var Ae={BASE_SELF_ASSIGNED:"All Tasks",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Folder not found",PLANS_SELF_ASSIGNED:"All groups",PLAN_NOT_FOUND:"Group not found"},Be={BASE_SELF_ASSIGNED:"Assigned to Me",BUCKETS_SELF_ASSIGNED:"All Tasks",BUCKET_NOT_FOUND:"Bucket not found",PLANS_SELF_ASSIGNED:"All Plans",PLAN_NOT_FOUND:"Plan not found"},Le={"@odata.type":"microsoft.graph.plannerAssignment",orderHint:"string !"},Me=function(e){function t(){var e;return a(this,t),(e=s(this,r(t).call(this))).readOnly=!1,e.dataSource=Pe.planner,e.targetId=null,e.targetBucketId=null,e.initialId=null,e.initialBucketId=null,e.hideHeader=!1,e.groupId=null,e._isNewTaskVisible=!1,e._newTaskBeingAdded=!1,e._newTaskName="",e._newTaskDueDate=null,e._newTaskGroupId="",e._newTaskFolderId="",e._groups=[],e._folders=[],e._tasks=[],e._hiddenTasks=[],e._loadingTasks=[],e._inTaskLoad=!1,e._hasDoneInitialLoad=!1,e._todoDefaultSet=!1,e.isPeoplePickerVisible=!1,e._me=null,e.providerUpdateCallback=function(){return e.loadTasks()},e.handleWindowClick=function(){return e.hidePeoplePicker()},e}return n(t,D),o(t,[{key:"connectedCallback",value:function(){l(r(t.prototype),"connectedCallback",this).call(this),v.onProviderUpdated(this.providerUpdateCallback),window.addEventListener("click",this.handleWindowClick)}},{key:"disconnectedCallback",value:function(){v.removeProviderUpdatedListener(this.providerUpdateCallback),window.removeEventListener("click",this.handleWindowClick),l(r(t.prototype),"disconnectedCallback",this).call(this)}},{key:"attributeChangedCallback",value:function(e,n,a){l(r(t.prototype),"attributeChangedCallback",this).call(this,e,n,a),"data-source"===e&&(this.dataSource===Pe.planner?(this._currentGroup=this.initialId,this._currentFolder=this.initialBucketId):this.dataSource===Pe.todo&&(this._currentGroup=null,this._currentFolder=this.initialId),this._newTaskFolderId="",this._newTaskGroupId="",this._newTaskDueDate=null,this._newTaskName="",this._newTaskBeingAdded=!1,this._tasks=[],this._folders=[],this._groups=[],this._hasDoneInitialLoad=!1,this._inTaskLoad=!1,this._todoDefaultSet=!1,this.loadTasks())}},{key:"firstUpdated",value:function(){this.initialId&&!this._currentGroup&&(this.dataSource===Pe.planner?this._currentGroup=this.initialId:this.dataSource===Pe.todo&&(this._currentFolder=this.initialId)),this.dataSource===Pe.planner&&this.initialBucketId&&!this._currentFolder&&(this._currentFolder=this.initialBucketId),this.loadTasks()}},{key:"render",value:function(){var e,t=this,n=this._tasks.filter(function(e){return t.isTaskInSelectedGroupFilter(e)}).filter(function(e){return t.isTaskInSelectedFolderFilter(e)}).filter(function(e){return!t._hiddenTasks.includes(e.id)}),a=this._inTaskLoad&&!this._hasDoneInitialLoad?this.renderLoadingTask():null;return this.hideHeader||(e=k(He(),this.renderPlanOptions())),k(Ne(),e,this._isNewTaskVisible?this.renderNewTask():null,a,b(n,function(e){return e.id},function(e){return t.renderTask(e)}))}},{key:"loadTasks",value:function(){return Fe(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getTaskSource()){e.next=3;break}return e.abrupt("return");case 3:if((n=v.globalProvider)&&n.state===C.SignedIn){e.next=6;break}return e.abrupt("return");case 6:if(this._inTaskLoad=!0,this._me||(a=n.graph.getMe()),!this.groupId||this.dataSource!==Pe.planner){e.next=13;break}return e.next=11,this._loadTasksForGroup(t);case 11:e.next=25;break;case 13:if(!this.targetId){e.next=23;break}if(this.dataSource!==Pe.todo){e.next=19;break}return e.next=17,this._loadTargetTodoTasks(t);case 17:e.next=21;break;case 19:return e.next=21,this._loadTargetPlannerTasks(t);case 21:e.next=25;break;case 23:return e.next=25,this._loadAllTasks(t);case 25:if(!a){e.next=29;break}return e.next=28,a;case 28:this._me=e.sent;case 29:this._inTaskLoad=!1,this._hasDoneInitialLoad=!0;case 31:case"end":return e.stop()}},e,this)}))}},{key:"_loadTargetTodoTasks",value:function(e){return Fe(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTaskGroups();case 2:return n=t.sent,t.next=5,Promise.all(n.map(function(t){return e.getTaskFoldersForTaskGroup(t.id)}));case 5:return t.t0=function(e,t){return[].concat(c(e),c(t))},t.t1=[],a=t.sent.reduce(t.t0,t.t1),t.next=10,Promise.all(a.map(function(t){return e.getTasksForTaskFolder(t.id,t.parentId)}));case 10:t.t2=function(e,t){return[].concat(c(e),c(t))},t.t3=[],s=t.sent.reduce(t.t2,t.t3),this._tasks=s,this._folders=a,this._groups=n,this._currentGroup=null;case 17:case"end":return t.stop()}},t,this)}))}},{key:"_loadTargetPlannerTasks",value:function(e){return Fe(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,a,s,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTaskGroup(this.targetId);case 2:return n=t.sent,t.next=5,e.getTaskFoldersForTaskGroup(n.id);case 5:return a=t.sent,this.targetBucketId&&(a=a.filter(function(e){return e.id===r.targetBucketId})),t.next=9,Promise.all(a.map(function(t){return e.getTasksForTaskFolder(t.id,t.parentId)}));case 9:t.t0=function(e,t){return[].concat(c(e),c(t))},t.t1=[],s=t.sent.reduce(t.t0,t.t1),this._tasks=s,this._folders=a,this._groups=[n];case 15:case"end":return t.stop()}},t,this)}))}},{key:"_loadAllTasks",value:function(e){return Fe(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,a,s,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTaskGroups();case 2:return n=t.sent,t.next=5,Promise.all(n.map(function(t){return e.getTaskFoldersForTaskGroup(t.id)}));case 5:return t.t0=function(e,t){return[].concat(c(e),c(t))},t.t1=[],a=t.sent.reduce(t.t0,t.t1),this.initialId||this.dataSource!==Pe.todo||this._todoDefaultSet||(this._todoDefaultSet=!0,(s=a.find(function(e){return e._raw.isDefaultFolder}))&&(this._currentFolder=s.id)),t.next=11,Promise.all(a.map(function(t){return e.getTasksForTaskFolder(t.id,t.parentId)}));case 11:t.t2=function(e,t){return[].concat(c(e),c(t))},t.t3=[],r=t.sent.reduce(t.t2,t.t3),this._tasks=r,this._folders=a,this._groups=n;case 17:case"end":return t.stop()}},t,this)}))}},{key:"_loadTasksForGroup",value:function(e){return Fe(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,a,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getTaskGroupsForGroup(this.groupId);case 2:return n=t.sent,t.next=5,Promise.all(n.map(function(t){return e.getTaskFoldersForTaskGroup(t.id)}));case 5:return t.t0=function(e,t){return[].concat(c(e),c(t))},t.t1=[],a=t.sent.reduce(t.t0,t.t1),t.next=10,Promise.all(a.map(function(t){return e.getTasksForTaskFolder(t.id,t.parentId)}));case 10:t.t2=function(e,t){return[].concat(c(e),c(t))},t.t3=[],s=t.sent.reduce(t.t2,t.t3),this._tasks=s,this._folders=a,this._groups=n;case 16:case"end":return t.stop()}},t,this)}))}},{key:"addTask",value:function(e,t,n,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return Fe(this,void 0,void 0,regeneratorRuntime.mark(function r(){var o,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(o=this.getTaskSource()){r.next=3;break}return r.abrupt("return");case 3:return i={assignments:s,dueDate:t,immediateParentId:a,name:e,topParentId:n},this._newTaskBeingAdded=!0,r.next=7,o.addTask(i);case 7:return r.next=9,this.loadTasks();case 9:this._newTaskBeingAdded=!1,this.isNewTaskVisible=!1;case 11:case"end":return r.stop()}},r,this)}))}},{key:"completeTask",value:function(e){return Fe(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.getTaskSource()){t.next=3;break}return t.abrupt("return");case 3:return this._loadingTasks=[].concat(c(this._loadingTasks),[e.id]),t.next=6,n.setTaskComplete(e.id,e.eTag);case 6:return t.next=8,this.loadTasks();case 8:this._loadingTasks=this._loadingTasks.filter(function(t){return t!==e.id});case 9:case"end":return t.stop()}},t,this)}))}},{key:"uncompleteTask",value:function(e){return Fe(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.getTaskSource()){t.next=3;break}return t.abrupt("return");case 3:return this._loadingTasks=[].concat(c(this._loadingTasks),[e.id]),t.next=6,n.setTaskIncomplete(e.id,e.eTag);case 6:return t.next=8,this.loadTasks();case 8:this._loadingTasks=this._loadingTasks.filter(function(t){return t!==e.id});case 9:case"end":return t.stop()}},t,this)}))}},{key:"removeTask",value:function(e){return Fe(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.getTaskSource()){t.next=3;break}return t.abrupt("return");case 3:return this._hiddenTasks=[].concat(c(this._hiddenTasks),[e.id]),t.next=6,n.removeTask(e.id,e.eTag);case 6:return t.next=8,this.loadTasks();case 8:this._hiddenTasks=this._hiddenTasks.filter(function(t){return t!==e.id});case 9:case"end":return t.stop()}},t,this)}))}},{key:"assignPeople",value:function(e,t){return Fe(this,void 0,void 0,regeneratorRuntime.mark(function n(){var a,s,r,o,i,l,k,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=this.getTaskSource()){n.next=3;break}return n.abrupt("return");case 3:if(s=[],e&&e.assignments&&(s=Object.keys(e.assignments).sort()),r=t.map(function(e){return e.id}),!(r.length===s.length&&r.sort().every(function(e,t){return e===s[t]}))){n.next=9;break}return n.abrupt("return");case 9:if(o={},0===t.length)for(i=0;i<s.length;i++)o[s[i]]=null;if(!t){n.next=29;break}l=0;case 13:if(!(l<s.length)){n.next=28;break}k=0;case 15:if(!(k<t.length)){n.next=25;break}if(s[l]===t[k].id){n.next=21;break}return o[s[l]]=null,n.abrupt("break",25);case 21:o[s[l]]=Le;case 22:k++,n.next=15;break;case 25:l++,n.next=13;break;case 28:for(u=0;u<t.length;u++)o[t[u].id]=Le;case 29:if(!e){n.next=36;break}return this._loadingTasks=[].concat(c(this._loadingTasks),[e.id]),n.next=33,a.assignPeopleToTask(e.id,o,e.eTag);case 33:return n.next=35,this.loadTasks();case 35:this._loadingTasks=this._loadingTasks.filter(function(t){return t!==e.id});case 36:case"end":return n.stop()}},n,this)}))}},{key:"onAddTaskClick",value:function(e){var t=this.getPeoplePicker(null),n={};if(t){var a=!0,s=!1,r=void 0;try{for(var o,i=t.selectedPeople[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var l=o.value;t.selectedPeople.length&&(n[l.id]=Le)}}catch(e){s=!0,r=e}finally{try{a||null==i.return||i.return()}finally{if(s)throw r}}}!this._newTaskBeingAdded&&this._newTaskName&&(this._currentGroup||this._newTaskGroupId)&&this.addTask(this._newTaskName,this._newTaskDueDate,this._currentGroup?this._currentGroup:this._newTaskGroupId,this._currentFolder?this._currentFolder:this._newTaskFolderId,n)}},{key:"renderPlanOptions",value:function(){var e=this,t=v.globalProvider;if(!t||t.state!==C.SignedIn)return null;if(this._inTaskLoad&&!this._hasDoneInitialLoad)return k(_e());var n=this.readOnly||this._isNewTaskVisible?null:k(Ie(),function(){e.isNewTaskVisible=!e.isNewTaskVisible});if(this.dataSource===Pe.planner){var a=this._groups.find(function(t){return t.id===e._currentGroup})||{title:this.res.BASE_SELF_ASSIGNED},s=u({},this.res.BASE_SELF_ASSIGNED,function(t){e._currentGroup=null,e._currentFolder=null}),r=!0,o=!1,i=void 0;try{for(var l,c=function(){var t=l.value;s[t.title]=function(n){e._currentGroup=t.id,e._currentFolder=null}},d=this._groups[Symbol.iterator]();!(r=(l=d.next()).done);r=!0)c()}catch(e){o=!0,i=e}finally{try{r||null==d.return||d.return()}finally{if(o)throw i}}var p=k(ye(),s,a.title),T=this._currentGroup?k(be()):null,h=this._folders.find(function(t){return t.id===e._currentFolder})||{name:this.res.BUCKETS_SELF_ASSIGNED},f=u({},this.res.BUCKETS_SELF_ASSIGNED,function(t){e._currentFolder=null}),g=!0,m=!1,w=void 0;try{for(var x,D=function(){var t=x.value;f[t.name]=function(n){e._currentFolder=t.id}},b=this._folders.filter(function(t){return t.parentId===e._currentGroup})[Symbol.iterator]();!(g=(x=b.next()).done);g=!0)D()}catch(e){m=!0,w=e}finally{try{g||null==b.return||b.return()}finally{if(m)throw w}}var y=this.targetBucketId?k(De(),this._folders[0]&&this._folders[0].name):k(xe(),f,h.name);return k(we(),p,T,this._currentGroup?y:null,n)}var I=this._folders.find(function(t){return t.id===e.targetId})||{name:this.res.BUCKETS_SELF_ASSIGNED},_=this._folders.find(function(t){return t.id===e._currentFolder})||{name:this.res.BUCKETS_SELF_ASSIGNED},N={},H=!0,P=!1,S=void 0;try{for(var F,A=function(){var t=F.value;N[t.name]=function(){e._currentFolder=t.id}},B=this._folders[Symbol.iterator]();!(H=(F=B.next()).done);H=!0)A()}catch(e){P=!0,S=e}finally{try{H||null==B.return||B.return()}finally{if(P)throw S}}N[this.res.BUCKETS_SELF_ASSIGNED]=function(t){e._currentFolder=null};var L=this.targetId?k(Ce(),I.name):k(ve(),_.name,N);return k(me(),L,n)}},{key:"renderNewTask",value:function(){var e=this,t=k(ge(),this._newTaskName,function(t){e._newTaskName=t.target.value}),n=this._groups;n.length>0&&!this._newTaskGroupId&&(this._newTaskGroupId=n[0].id);var a=this.dataSource===Pe.todo?null:this._currentGroup?k(fe(),this.renderPlannerIcon(),this.getPlanTitle(this._currentGroup)):k(he(),this.renderPlannerIcon(),this._newTaskGroupId,function(t){e._newTaskGroupId=t.target.value},this._groups.map(function(e){return k(Te(),e.id,e.title)})),s=this._folders.filter(function(t){return e._currentGroup&&t.parentId===e._currentGroup||!e._currentGroup&&t.parentId===e._newTaskGroupId});s.length>0&&!this._newTaskFolderId&&(this._newTaskFolderId=s[0].id);var r=this._currentFolder?k(pe(),this.renderBucketIcon(),this.getFolderName(this._currentFolder)):k(de(),this.renderBucketIcon(),this._newTaskFolderId,function(t){e._newTaskFolderId=t.target.value},s.map(function(e){return k(ue(),e.id,e.name)})),o=k(ce(),this.renderCalendarIcon(),this.dateToInputValue(this._newTaskDueDate),function(t){var n=t.target.value;e._newTaskDueDate=n?new Date(n+"T17:00"):null}),i=k(ke(),[],this.isPeoplePickerVisible?w.none:w.hover),l=this.dataSource===Pe.todo?null:k(le(),function(t){t.stopPropagation(),e.showPeoplePicker(null)},i,g({Picker:!0,Hidden:!this.isPeoplePickerVisible||null!==this._currentTask}),function(e){return e.stopPropagation()}),c=this._newTaskBeingAdded?k(ie()):k(oe(),""===this._newTaskName?"Disabled":"",function(){return e.isNewTaskVisible=!1},this.onAddTaskClick);return k(re(),t,a,r,l,o,c)}},{key:"showPeoplePicker",value:function(e){if(this.isPeoplePickerVisible&&e===this._currentTask)return void this.hidePeoplePicker();this._currentTask=e,this.isPeoplePickerVisible=!0;var t=this.getPeoplePicker(e),n=this.getMgtPeople(e);t&&n&&(t.selectedPeople=n.people,setTimeout(function(){t.focus()},50))}},{key:"hidePeoplePicker",value:function(){var e=this.getPeoplePicker(this._currentTask),t=this.getMgtPeople(this._currentTask);e&&(t.people=e.selectedPeople,this.assignPeople(this._currentTask,e.selectedPeople)),this.isPeoplePickerVisible=!1,this._currentTask=null}},{key:"getPeoplePicker",value:function(e){var t=e?e.id:"newTask";return this.renderRoot.querySelector(".picker-".concat(t))}},{key:"getMgtPeople",value:function(e){var t=e?e.id:"newTask";return this.renderRoot.querySelector(".people-".concat(t))}},{key:"renderTask",value:function(e){var t=this,n=e.name,a=void 0===n?"Task":n,s=e.completed,r=void 0!==s&&s,o=e.dueDate,i=e.assignments,l=this._loadingTasks.includes(e.id),c={Complete:!l&&r,Loading:l,TaskCheck:!0,TaskIcon:!0},u=l?k(se()):r?k(ae()):null,d=k(ne(),g(c),u),p=this._currentGroup?null:this.getPlanTitle(e.topParentId),T=this._currentFolder?null:this.getFolderName(e.immediateParentId),h={task:Object.assign(Object.assign({},e),{groupTitle:p,folderTitle:T})},f=this.renderTemplate("task",h,e.id);if(f)return f;var m=this.renderTemplate("task-details",h,"task-details-".concat(e.id));if(!m){var v=this.dataSource===Pe.todo||this._currentGroup?null:k(te(),this.renderPlannerIcon(),this.getPlanTitle(e.topParentId)),C=this._currentFolder?null:k(ee(),this.renderBucketIcon(),this.getFolderName(e.immediateParentId)),D=o?k($(),this.renderCalendarIcon(),x(o)):null,b=null,y=null,I=Object.keys(i).map(function(e){return e}),_=k(Y());this.dataSource!==Pe.todo&&(y=k(Q(),e.id,I,this.isPeoplePickerVisible?w.none:w.hover,_),b=k(J(),function(n){t.showPeoplePicker(e),n.stopPropagation()},y,g({Picker:!0,Hidden:!this.showPeoplePicker||e!==this._currentTask}),e.id,function(e){return e.stopPropagation()})),m=k(X(),a,v,C,b,D)}var N=this.readOnly?null:k(q(),{"Delete Task":function(){return t.removeTask(e)}});return k(W(),g({Complete:r,Incomplete:!r,ReadOnly:this.readOnly,Task:!0}),function(){t.handleTaskClick(e)},g({Complete:r,Incomplete:!r,TaskCheckContainer:!0}),function(n){t.readOnly||(e.completed?t.uncompleteTask(e):t.completeTask(e),n.stopPropagation(),n.preventDefault())},d,m,N)}},{key:"handleTaskClick",value:function(e){e&&!this.isPeoplePickerVisible&&this.fireCustomEvent("taskClick",{task:e._raw})}},{key:"renderLoadingTask",value:function(){return k(K())}},{key:"renderPlannerIcon",value:function(){return k(Z())}},{key:"renderBucketIcon",value:function(){return k(z())}},{key:"renderCalendarIcon",value:function(){return k(j())}},{key:"getTaskSource",value:function(){var e=v.globalProvider;return e&&e.state===C.SignedIn?this.dataSource===Pe.planner?new H(e.graph):this.dataSource===Pe.todo?new P(e.graph):null:null}},{key:"getPlanTitle",value:function(e){return e?e===this.res.PLANS_SELF_ASSIGNED?this.res.PLANS_SELF_ASSIGNED:(this._groups.find(function(t){return t.id===e})||{title:this.res.PLAN_NOT_FOUND}).title:this.res.BASE_SELF_ASSIGNED}},{key:"getFolderName",value:function(e){return e?(this._folders.find(function(t){return t.id===e})||{name:this.res.BUCKET_NOT_FOUND}).name:this.res.BUCKETS_SELF_ASSIGNED}},{key:"isTaskInSelectedGroupFilter",value:function(e){return e.topParentId===this._currentGroup||!this._currentGroup&&this.getTaskSource().isAssignedToMe(e,this._me.id)}},{key:"isTaskInSelectedFolderFilter",value:function(e){return e.immediateParentId===this._currentFolder||!this._currentFolder}},{key:"dateToInputValue",value:function(e){return e?new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().split("T")[0]:null}},{key:"res",get:function(){switch(this.dataSource){case Pe.todo:return Ae;case Pe.planner:default:return Be}}},{key:"isNewTaskVisible",get:function(){return this._isNewTaskVisible},set:function(e){this._isNewTaskVisible=e,e||(this._newTaskDueDate=null,this._newTaskName="",this._newTaskGroupId="")}}],[{key:"styles",get:function(){return I}}]),t}();function Ve(){var e=t([" <mgt-mock-provider></mgt-mock-provider> <mgt-tasks></mgt-tasks> "]);return Ve=function(){return e},e}Se([h({attribute:"read-only",type:Boolean})],Me.prototype,"readOnly",void 0),Se([h({attribute:"data-source",converter:function(e,t){return e=e.toLowerCase(),Pe[e]||Pe.planner}})],Me.prototype,"dataSource",void 0),Se([h({attribute:"target-id",type:String})],Me.prototype,"targetId",void 0),Se([h({attribute:"target-bucket-id",type:String})],Me.prototype,"targetBucketId",void 0),Se([h({attribute:"initial-id",type:String})],Me.prototype,"initialId",void 0),Se([h({attribute:"initial-bucket-id",type:String})],Me.prototype,"initialBucketId",void 0),Se([h({attribute:"hide-header",type:Boolean})],Me.prototype,"hideHeader",void 0),Se([h({attribute:"group-id",type:String})],Me.prototype,"groupId",void 0),Se([h()],Me.prototype,"_isNewTaskVisible",void 0),Se([h()],Me.prototype,"_newTaskBeingAdded",void 0),Se([h()],Me.prototype,"_newTaskName",void 0),Se([h()],Me.prototype,"_newTaskDueDate",void 0),Se([h()],Me.prototype,"_newTaskGroupId",void 0),Se([h()],Me.prototype,"_newTaskFolderId",void 0),Se([h()],Me.prototype,"_groups",void 0),Se([h()],Me.prototype,"_folders",void 0),Se([h()],Me.prototype,"_tasks",void 0),Se([h()],Me.prototype,"_hiddenTasks",void 0),Se([h()],Me.prototype,"_loadingTasks",void 0),Se([h()],Me.prototype,"_inTaskLoad",void 0),Se([h()],Me.prototype,"_hasDoneInitialLoad",void 0),Se([h()],Me.prototype,"_todoDefaultSet",void 0),Se([h()],Me.prototype,"_currentGroup",void 0),Se([h()],Me.prototype,"_currentFolder",void 0),Se([h()],Me.prototype,"_currentTask",void 0),Se([h()],Me.prototype,"isPeoplePickerVisible",void 0),Me=Se([f("mgt-tasks")],Me);e("default",{title:"Mock Provider|mgt-tasks",component:"mgt-tasks",decorators:[d,p]}),e("tasks",function(){return k(Ve())})}}});
//# sourceMappingURL=tasks.stories-70d3627d.js.map
