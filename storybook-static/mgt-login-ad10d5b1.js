import{h as t}from"./lit-html-c7682711.js";import{c as o,p as e,a as n,f as i,P as r,b as s}from"./Graph-3b72116e.js";const a=[o`:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\E70E"}.ms-Icon--Contact::before{content:"\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\EB6D"}:host,mgt-login{--font-size:14px;--font-weight:600;--width:'100%';--height:'100%';--margin:0;--padding:12px 20px;--color:#201f1e;--background-color:transparent;--background-color--hover:#edebe9;--popup-content-background-color:white;--popup-command-font-size:12px;--popup-command-margin:16px 0 0;--popup-padding:24px 48px 16px 24px}:host .root,mgt-login .root{position:relative;display:inline-block}:host .login-button,mgt-login .login-button{display:flex;align-items:center;font-family:var(--default-font-family);font-size:var(--font-size);font-weight:var(--font-weight);width:var(--width);height:var(--height);margin:var(--margin);padding:var(--padding);color:var(--color);background-color:var(--background-color);border:none;cursor:pointer;transition:color .3s,background-color .3s}:host .login-button:hover,mgt-login .login-button:hover{color:var(--theme-primary-color);background-color:var(--background-color--hover)}:host .login-button:focus,mgt-login .login-button:focus{outline:0}:host .login-button:disabled,mgt-login .login-button:disabled{opacity:.4;pointer-events:none}:host .login-icon + span,mgt-login .login-icon + span{margin-left:6px}:host .popup,mgt-login .popup{display:none;position:absolute;animation-duration:.3s;font-family:var(--default-font-family);background:var(--popup-content-background-color);box-shadow:0 12px 40px 2px rgba(0,0,0,.08);min-width:240px;z-index:1}:host .popup.show-menu,mgt-login .popup.show-menu{display:inline-block;animation-name:fade-in}:host .popup.open-left,mgt-login .popup.open-left{right:0}:host .popup-content,mgt-login .popup-content{display:flex;flex-direction:column;padding:var(--popup-padding)}:host .popup-commands ul,mgt-login .popup-commands ul{list-style-type:none;margin:var(--popup-command-margin);padding:0}:host .popup-command,mgt-login .popup-command{font-family:var(--default-font-family);font-size:var(--popup-command-font-size);font-weight:var(--font-weight);color:var(--theme-primary-color);background-color:transparent;border:none;padding:0;cursor:pointer;transition:color .3s}:host .popup-command:hover,mgt-login .popup-command:hover{color:var(--theme-dark-color)}@keyframes fade-in{from{opacity:0}to{opacity:1}}`];var l=function(t,o,e,n){var i,r=arguments.length,s=r<3?o:null===n?n=Object.getOwnPropertyDescriptor(o,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,o,e,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(r<3?i(s):r>3?i(o,e,s):i(o,e))||s);return r>3&&s&&Object.defineProperty(o,e,s),s},p=function(t,o,e,n){return new(e||(e=Promise))(function(i,r){function s(t){try{l(n.next(t))}catch(t){r(t)}}function a(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var o;t.done?i(t.value):(o=t.value,o instanceof e?o:new e(function(t){t(o)})).then(s,a)}l((n=n.apply(t,o||[])).next())})};let u=class extends i{constructor(){super(),this._openLeft=!1,this._showMenu=!1,this._loading=!0,r.onProviderUpdated(()=>this.loadState()),this.loadState()}static get styles(){return a}login(){return p(this,void 0,void 0,function*(){if(this.userDetails)return;const t=r.globalProvider;t&&t.login&&(yield t.login(),t.state===s.SignedIn?this.fireCustomEvent("loginCompleted"):this.fireCustomEvent("loginFailed"),yield this.loadState())})}logout(){return p(this,void 0,void 0,function*(){if(!this.fireCustomEvent("logoutInitiated"))return;const t=r.globalProvider;t&&t.logout&&(yield t.logout(),this.fireCustomEvent("logoutCompleted")),this.userDetails=null,this._showMenu=!1})}updated(t){if(!1===t.get("_showMenu")){const t=this.renderRoot.querySelector(".popup");if(t&&t.animate){this._popupRect=t.getBoundingClientRect();const o=this._loginButtonRect.left-this._popupRect.left,e=this._loginButtonRect.top-this._popupRect.top,n=this._loginButtonRect.width/this._popupRect.width,i=this._loginButtonRect.height/this._popupRect.height;t.animate([{backgroundColor:"#eaeaea",transform:`\n              translate(${o}px, ${e}px)\n              scale(${n}, ${i})\n              `,transformOrigin:"top left"},{backgroundColor:"white",transform:"none",transformOrigin:"top left"}],{duration:100,easing:"ease-in-out",fill:"both"})}}}firstUpdated(){window.addEventListener("click",t=>{const o=this.renderRoot.querySelector(".popup");o&&(this._popupRect=o.getBoundingClientRect(),this._showMenu=!1)})}render(){const o=this.userDetails?this.renderLoggedIn():this.renderLogIn();return t` <div class="root"> <button ?disabled="${this._loading}" class="login-button" @click="${this.onClick}" role="button"> ${o} </button> ${this.renderMenu()} </div> `}renderLogIn(){return t` <i class="login-icon ms-Icon ms-Icon--Contact"></i> <span aria-label="Sign In"> Sign In </span> `}renderLoggedIn(){return this.userDetails?t` <mgt-person .personDetails="${this.userDetails}" .personImage="${this._image}" show-name> `:this.renderLogIn()}renderMenu(){if(!this.userDetails)return;const o=t` <mgt-person .personDetails="${this.userDetails}" .personImage="${this._image}" show-name show-email> `;return t` <div class="popup ${this._openLeft?"open-left":""} ${this._showMenu?"show-menu":""}"> <div class="popup-content"> <div> ${o} </div> <div class="popup-commands"> <ul> <li> <button class="popup-command" @click="${this.logout}" aria-label="Sign Out"> Sign Out </button> </li> </ul> </div> </div> </div> `}loadState(){return p(this,void 0,void 0,function*(){const t=r.globalProvider;if(t)if(this._loading=!0,t.state===s.SignedIn){const o=t.graph.createBatch();o.get("me","me",["user.read"]),o.get("photo","me/photo/$value",["user.read"]);const e=yield o.execute();this._image=e.photo,this.userDetails=e.me}else{if(t.state!==s.SignedOut)return void(this._showMenu=!1);this.userDetails=null}this._loading=!1})}onClick(t){if(t.stopPropagation(),this.userDetails){const t=this.renderRoot.querySelector(".login-button");if(t){this._loginButtonRect=t.getBoundingClientRect();const o=this._loginButtonRect.left,e=(window.innerWidth||document.documentElement.clientWidth)-this._loginButtonRect.right;this._openLeft=e<o,this._showMenu=!this._showMenu}}else this.fireCustomEvent("loginInitiated")&&this.login()}};l([e({attribute:"user-details",type:Object})],u.prototype,"userDetails",void 0),l([e({attribute:!1})],u.prototype,"_showMenu",void 0),l([e({attribute:!1})],u.prototype,"_loading",void 0),u=l([n("mgt-login")],u);
//# sourceMappingURL=mgt-login-ad10d5b1.js.map
