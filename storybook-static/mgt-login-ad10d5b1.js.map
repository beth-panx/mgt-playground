{"version":3,"file":"mgt-login-ad10d5b1.js","sources":["../dist/es6/components/mgt-login/mgt-login-css.js","../dist/es6/components/mgt-login/mgt-login.js"],"sourcesContent":["// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\nimport { css } from 'lit-element';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles = [\n    css `\n/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/*\r\n  Your use of the content in the files referenced here is subject to the terms of the license at http://aka.ms/fabric-assets-license\r\n*/\n/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n:host([hidden]) {\n  display: none; }\n\n:host {\n  display: block;\n  --default-font-family: \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\",\n    -apple-system, BlinkMacSystemFont, Roboto, \"Helvetica Neue\", sans-serif;\n  --theme-primary-color: #0078d7;\n  --theme-dark-color: #005a9e; }\n\n.ms-Icon {\n  display: inline-block;\n  font-family: \"FabricMDL2Icons\";\n  font-style: normal;\n  font-weight: normal;\n  font-size: 16px;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-font-smoothing: antialiased;\n  margin: 4px 0; }\n\n.ms-Icon--ChevronDown::before {\n  content: \"\\\\\\E70D\"; }\n\n.ms-Icon--ChevronUp::before {\n  content: \"\\\\\\E70E\"; }\n\n.ms-Icon--Contact::before {\n  content: \"\\\\\\E77B\"; }\n\n.ms-Icon--AddFriend::before {\n  content: \"\\\\\\E8FA\"; }\n\n.ms-Icon--OutlookLogoInverse::before {\n  content: \"\\\\\\EB6D\"; }\n\n:host,\nmgt-login {\n  --font-size: 14px;\n  --font-weight: 600;\n  --width: '100%';\n  --height: '100%';\n  --margin: 0;\n  --padding: 12px 20px;\n  --color: #201f1e;\n  --background-color: transparent;\n  --background-color--hover: #edebe9;\n  --popup-content-background-color: white;\n  --popup-command-font-size: 12px;\n  --popup-command-margin: 16px 0 0;\n  --popup-padding: 24px 48px 16px 24px; }\n\n:host .root,\nmgt-login .root {\n  position: relative;\n  display: inline-block; }\n\n:host .login-button,\nmgt-login .login-button {\n  display: flex;\n  align-items: center;\n  font-family: var(--default-font-family);\n  font-size: var(--font-size);\n  font-weight: var(--font-weight);\n  width: var(--width);\n  height: var(--height);\n  margin: var(--margin);\n  padding: var(--padding);\n  color: var(--color);\n  background-color: var(--background-color);\n  border: none;\n  cursor: pointer;\n  transition: color 0.3s, background-color 0.3s; }\n  :host .login-button:hover,\n  mgt-login .login-button:hover {\n    color: var(--theme-primary-color);\n    background-color: var(--background-color--hover); }\n  :host .login-button:focus,\n  mgt-login .login-button:focus {\n    outline: 0; }\n  :host .login-button:disabled,\n  mgt-login .login-button:disabled {\n    opacity: 0.4;\n    pointer-events: none; }\n\n:host .login-icon + span,\nmgt-login .login-icon + span {\n  margin-left: 6px; }\n\n:host .popup,\nmgt-login .popup {\n  display: none;\n  position: absolute;\n  animation-duration: 300ms;\n  font-family: var(--default-font-family);\n  background: var(--popup-content-background-color);\n  box-shadow: 0 12px 40px 2px rgba(0, 0, 0, 0.08);\n  min-width: 240px;\n  z-index: 1; }\n  :host .popup.show-menu,\n  mgt-login .popup.show-menu {\n    display: inline-block;\n    animation-name: fade-in; }\n  :host .popup.open-left,\n  mgt-login .popup.open-left {\n    right: 0; }\n\n:host .popup-content,\nmgt-login .popup-content {\n  display: flex;\n  flex-direction: column;\n  padding: var(--popup-padding); }\n\n:host .popup-commands ul,\nmgt-login .popup-commands ul {\n  list-style-type: none;\n  margin: var(--popup-command-margin);\n  padding: 0; }\n\n:host .popup-command,\nmgt-login .popup-command {\n  font-family: var(--default-font-family);\n  font-size: var(--popup-command-font-size);\n  font-weight: var(--font-weight);\n  color: var(--theme-primary-color);\n  background-color: transparent;\n  border: none;\n  padding: 0;\n  cursor: pointer;\n  transition: color 0.3s; }\n  :host .popup-command:hover,\n  mgt-login .popup-command:hover {\n    color: var(--theme-dark-color); }\n\n@keyframes fade-in {\n  from {\n    opacity: 0; }\n  to {\n    opacity: 1; } }\n\n`\n];\n//# sourceMappingURL=mgt-login-css.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { customElement, html, property } from 'lit-element';\nimport { Providers } from '../../Providers';\nimport { ProviderState } from '../../providers/IProvider';\nimport '../../styles/fabric-icon-font';\nimport { MgtBaseComponent } from '../baseComponent';\nimport '../mgt-person/mgt-person';\nimport { styles } from './mgt-login-css';\n/**\n * Web component button and flyout control to facilitate Microsoft identity platform authentication\n *\n * @export\n * @class MgtLogin\n * @extends {MgtBaseComponent}\n */\nlet MgtLogin = class MgtLogin extends MgtBaseComponent {\n    constructor() {\n        super();\n        this._openLeft = false;\n        /**\n         * determines if login menu popup should be showing\n         * @type {boolean}\n         */\n        this._showMenu = false;\n        /**\n         * determines if login component is in loading state\n         * @type {boolean}\n         */\n        this._loading = true;\n        Providers.onProviderUpdated(() => this.loadState());\n        this.loadState();\n    }\n    /**\n     * Array of styles to apply to the element. The styles should be defined\n     * using the `css` tag function.\n     */\n    static get styles() {\n        return styles;\n    }\n    /**\n     * Initiate login\n     *\n     * @returns {Promise<void>}\n     * @memberof MgtLogin\n     */\n    login() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.userDetails) {\n                return;\n            }\n            const provider = Providers.globalProvider;\n            if (provider && provider.login) {\n                yield provider.login();\n                if (provider.state === ProviderState.SignedIn) {\n                    this.fireCustomEvent('loginCompleted');\n                }\n                else {\n                    this.fireCustomEvent('loginFailed');\n                }\n                yield this.loadState();\n            }\n        });\n    }\n    /**\n     *\n     * Initiate logout\n     * @returns {Promise<void>}\n     * @memberof MgtLogin\n     */\n    logout() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.fireCustomEvent('logoutInitiated')) {\n                return;\n            }\n            const provider = Providers.globalProvider;\n            if (provider && provider.logout) {\n                yield provider.logout();\n                this.fireCustomEvent('logoutCompleted');\n            }\n            this.userDetails = null;\n            this._showMenu = false;\n        });\n    }\n    /**\n     * Invoked whenever the element is updated. Implement to perform\n     * post-updating tasks via DOM APIs, for example, focusing an element.\n     *\n     * Setting properties inside this method will trigger the element to update\n     * again after this update cycle completes.\n     *\n     * * @param _changedProperties Map of changed properties with old values\n     */\n    updated(changedProps) {\n        if (changedProps.get('_showMenu') === false) {\n            // get popup bounds\n            const popup = this.renderRoot.querySelector('.popup');\n            if (popup && popup.animate) {\n                this._popupRect = popup.getBoundingClientRect();\n                // invert variables\n                const deltaX = this._loginButtonRect.left - this._popupRect.left;\n                const deltaY = this._loginButtonRect.top - this._popupRect.top;\n                const deltaW = this._loginButtonRect.width / this._popupRect.width;\n                const deltaH = this._loginButtonRect.height / this._popupRect.height;\n                // play back\n                popup.animate([\n                    {\n                        backgroundColor: '#eaeaea',\n                        transform: `\n              translate(${deltaX}px, ${deltaY}px)\n              scale(${deltaW}, ${deltaH})\n              `,\n                        transformOrigin: 'top left'\n                    },\n                    {\n                        backgroundColor: 'white',\n                        transform: 'none',\n                        transformOrigin: 'top left'\n                    }\n                ], {\n                    duration: 100,\n                    easing: 'ease-in-out',\n                    fill: 'both'\n                });\n            }\n        }\n    }\n    /**\n     * Invoked when the element is first updated. Implement to perform one time\n     * work on the element after update.\n     *\n     * Setting properties inside this method will trigger the element to update\n     * again after this update cycle completes.\n     *\n     * * @param _changedProperties Map of changed properties with old values\n     */\n    firstUpdated() {\n        window.addEventListener('click', (event) => {\n            // get popup bounds\n            const popup = this.renderRoot.querySelector('.popup');\n            if (popup) {\n                this._popupRect = popup.getBoundingClientRect();\n                this._showMenu = false;\n            }\n        });\n    }\n    /**\n     * Invoked on each update to perform rendering tasks. This method must return\n     * a lit-html TemplateResult. Setting properties inside this method will *not*\n     * trigger the element to update.\n     */\n    render() {\n        const content = this.userDetails ? this.renderLoggedIn() : this.renderLogIn();\n        return html `\n      <div class=\"root\">\n        <button ?disabled=\"${this._loading}\" class=\"login-button\" @click=${this.onClick} role=\"button\">\n          ${content}\n        </button>\n        ${this.renderMenu()}\n      </div>\n    `;\n    }\n    renderLogIn() {\n        return html `\n      <i class=\"login-icon ms-Icon ms-Icon--Contact\"></i>\n      <span aria-label=\"Sign In\">\n        Sign In\n      </span>\n    `;\n    }\n    renderLoggedIn() {\n        if (this.userDetails) {\n            return html `\n        <mgt-person .personDetails=${this.userDetails} .personImage=${this._image} show-name />\n      `;\n        }\n        else {\n            return this.renderLogIn();\n        }\n    }\n    renderMenu() {\n        if (!this.userDetails) {\n            return;\n        }\n        const personComponent = html `\n      <mgt-person .personDetails=${this.userDetails} .personImage=${this._image} show-name show-email />\n    `;\n        return html `\n      <div class=\"popup ${this._openLeft ? 'open-left' : ''} ${this._showMenu ? 'show-menu' : ''}\">\n        <div class=\"popup-content\">\n          <div>\n            ${personComponent}\n          </div>\n          <div class=\"popup-commands\">\n            <ul>\n              <li>\n                <button class=\"popup-command\" @click=${this.logout} aria-label=\"Sign Out\">\n                  Sign Out\n                </button>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    `;\n    }\n    loadState() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const provider = Providers.globalProvider;\n            if (provider) {\n                this._loading = true;\n                if (provider.state === ProviderState.SignedIn) {\n                    const batch = provider.graph.createBatch();\n                    batch.get('me', 'me', ['user.read']);\n                    batch.get('photo', 'me/photo/$value', ['user.read']);\n                    const response = yield batch.execute();\n                    this._image = response.photo;\n                    this.userDetails = response.me;\n                }\n                else if (provider.state === ProviderState.SignedOut) {\n                    this.userDetails = null;\n                }\n                else {\n                    // Loading\n                    this._showMenu = false;\n                    return;\n                }\n            }\n            this._loading = false;\n        });\n    }\n    onClick(event) {\n        event.stopPropagation();\n        if (this.userDetails) {\n            // get login button bounds\n            const loginButton = this.renderRoot.querySelector('.login-button');\n            if (loginButton) {\n                this._loginButtonRect = loginButton.getBoundingClientRect();\n                const leftEdge = this._loginButtonRect.left;\n                const rightEdge = (window.innerWidth || document.documentElement.clientWidth) - this._loginButtonRect.right;\n                this._openLeft = rightEdge < leftEdge;\n                this._showMenu = !this._showMenu;\n            }\n        }\n        else {\n            if (this.fireCustomEvent('loginInitiated')) {\n                this.login();\n            }\n        }\n    }\n};\n__decorate([\n    property({\n        attribute: 'user-details',\n        type: Object\n    })\n], MgtLogin.prototype, \"userDetails\", void 0);\n__decorate([\n    property({ attribute: false })\n], MgtLogin.prototype, \"_showMenu\", void 0);\n__decorate([\n    property({ attribute: false })\n], MgtLogin.prototype, \"_loading\", void 0);\nMgtLogin = __decorate([\n    customElement('mgt-login')\n], MgtLogin);\nexport { MgtLogin };\n//# sourceMappingURL=mgt-login.js.map"],"names":["styles","css","MgtLogin","MgtBaseComponent","[object Object]","_openLeft","_showMenu","_loading","Providers","onProviderUpdated","this","loadState","userDetails","provider","globalProvider","login","state","ProviderState","SignedIn","fireCustomEvent","logout","changedProps","get","popup","renderRoot","querySelector","animate","_popupRect","getBoundingClientRect","deltaX","_loginButtonRect","left","deltaY","top","deltaW","width","deltaH","height","backgroundColor","transform","transformOrigin","duration","easing","fill","window","addEventListener","event","content","renderLoggedIn","renderLogIn","html","onClick","renderMenu","_image","personComponent","batch","graph","createBatch","response","execute","photo","me","SignedOut","stopPropagation","loginButton","leftEdge","rightEdge","innerWidth","document","documentElement","clientWidth","right","__decorate","property","attribute","type","Object","customElement"],"mappings":"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"}