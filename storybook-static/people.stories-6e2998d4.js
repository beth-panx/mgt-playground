import{e,f as t}from"./index-3a445c6b.js";import{h as o}from"./lit-html-c7682711.js";import{c as r,p as s,a as n,M as p,h as i,P as l,b as a}from"./Graph-3b72116e.js";import"./mgt-mock-provider-3678bf7a.js";const d=[r`:host([hidden]){display:none}:host{display:block;--default-font-family:"Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}.ms-Icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.ms-Icon--ChevronDown::before{content:"\\\E70D"}.ms-Icon--ChevronUp::before{content:"\\\E70E"}.ms-Icon--Contact::before{content:"\\\E77B"}.ms-Icon--AddFriend::before{content:"\\\E8FA"}.ms-Icon--OutlookLogoInverse::before{content:"\\\EB6D"}:host .people-list,mgt-people .people-list{list-style-type:none;margin:var(--list-margin,8px 4px 8px 8px);padding:0;font-family:var(--default-font-family, "Segoe UI");font-style:normal;font-weight:400;display:flex;align-items:center}:host .people-person,mgt-people .people-person{margin:var(--avatar-margin,0 4px 0 0);display:flex}:host .overflow span,mgt-people .overflow span{vertical-align:middle}`];var h=function(e,t,o,r){var s,n=arguments.length,p=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(e,t,o,r);else for(var i=e.length-1;i>=0;i--)(s=e[i])&&(p=(n<3?s(p):n>3?s(t,o,p):s(t,o))||p);return n>3&&p&&Object.defineProperty(t,o,p),p},c=function(e,t,o,r){return new(o||(o=Promise))(function(s,n){function p(e){try{l(r.next(e))}catch(e){n(e)}}function i(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(p,i)}l((r=r.apply(e,t||[])).next())})};let m=class extends p{constructor(){super(...arguments),this.people=null,this.showMax=3,this.personCardInteraction=i.hover,this._firstUpdated=!1}static get styles(){return d}firstUpdated(){this._firstUpdated=!0,l.onProviderUpdated(()=>this.loadPeople()),this.loadPeople()}render(){return this.people?this.people.length?this.renderTemplate("default",{people:this.people})||o` <ul class="people-list"> ${this.people.slice(0,this.showMax).map(e=>o` <li class="people-person"> ${this.renderTemplate("person",{person:e},e.displayName)||this.renderPerson(e)} </li> `)} ${this.people.length>this.showMax?this.renderTemplate("overflow",{extra:this.people.length-this.showMax,max:this.showMax,people:this.people})||o` <li class="overflow"><span>+${this.people.length-this.showMax}<span></span></span></li> `:null} </ul> `:this.renderTemplate("no-people",null)||o``:this.renderTemplate("no-data",null)||o``}loadPeople(){return c(this,void 0,void 0,function*(){if(this._firstUpdated&&!this.people){const e=l.globalProvider;if(e&&e.state===a.SignedIn){const e=l.globalProvider.graph;this.groupId?this.people=yield e.getPeopleFromGroup(this.groupId):this.userIds?this.people=yield Promise.all(this.userIds.map(t=>c(this,void 0,void 0,function*(){return yield e.getUser(t)}))):this.people=yield e.getPeople()}}})}renderPerson(e){return o` <mgt-person .personDetails="${e}" .personImage="${"@"}" .personCardInteraction="${this.personCardInteraction}"></mgt-person> `}};h([s({attribute:"people",type:Object})],m.prototype,"people",void 0),h([s({attribute:"show-max",type:Number})],m.prototype,"showMax",void 0),h([s({attribute:"group-id",type:String})],m.prototype,"groupId",void 0),h([s({attribute:"user-ids",converter:(e,t)=>e.split(",")})],m.prototype,"userIds",void 0),h([s({attribute:"person-card",converter:(e,t)=>(e=e.toLowerCase(),void 0===i[e]?i.hover:i[e])})],m.prototype,"personCardInteraction",void 0),m=h([n("mgt-people")],m);const f=()=>o` <mgt-mock-provider></mgt-mock-provider> <mgt-people show-max="5"></mgt-people> `;export default{title:"Mock Provider|mgt-people",component:"mgt-people",decorators:[e,t]};export{f as people};
//# sourceMappingURL=people.stories-6e2998d4.js.map
