{"version":3,"file":"peoplePicker.stories-0632de1f.js","sources":["../dist/es6/components/mgt-people-picker/mgt-people-picker-css.js","../dist/es6/components/mgt-people-picker/mgt-people-picker.js","../stories/mock-provider/peoplePicker.stories.js"],"sourcesContent":["// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\nimport { css } from 'lit-element';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles = [\n    css `\n/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n/*\r\n  Your use of the content in the files referenced here is subject to the terms of the license at http://aka.ms/fabric-assets-license\r\n*/\n/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n:host([hidden]) {\n  display: none; }\n\n:host {\n  display: block;\n  --default-font-family: \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\",\n    -apple-system, BlinkMacSystemFont, Roboto, \"Helvetica Neue\", sans-serif;\n  --theme-primary-color: #0078d7;\n  --theme-dark-color: #005a9e; }\n\n.ms-Icon {\n  display: inline-block;\n  font-family: \"FabricMDL2Icons\";\n  font-style: normal;\n  font-weight: normal;\n  font-size: 16px;\n  -moz-osx-font-smoothing: grayscale;\n  -webkit-font-smoothing: antialiased;\n  margin: 4px 0; }\n\n.ms-Icon--ChevronDown::before {\n  content: \"\\\\\\E70D\"; }\n\n.ms-Icon--ChevronUp::before {\n  content: \"\\\\\\E70E\"; }\n\n.ms-Icon--Contact::before {\n  content: \"\\\\\\E77B\"; }\n\n.ms-Icon--AddFriend::before {\n  content: \"\\\\\\E8FA\"; }\n\n.ms-Icon--OutlookLogoInverse::before {\n  content: \"\\\\\\EB6D\"; }\n\n:host {\n  border-radius: 2px; }\n\n:host .root,\nmgt-people-picker .root {\n  display: block; }\n\n:host .people-picker,\nmgt-people-picker .people-picker {\n  position: relative;\n  margin: 7px 0 0 0;\n  background-color: white;\n  padding-bottom: 8px; }\n\n:host .people-list,\nmgt-people-picker .people-list {\n  position: absolute;\n  margin: 7px 0px 0px 0px;\n  padding: 0;\n  box-shadow: 0px 1.3289px 2.65781px rgba(180, 180, 180, 0.182), 0px 1.3289px 2.65781px rgba(68, 68, 68, 0.3);\n  border-radius: 2px;\n  background-color: var(--people-list-background-color, white);\n  z-index: 1;\n  /* Sit on top */\n  width: 100%;\n  text-align: left;\n  list-style-type: none;\n  font-family: Segoe UI;\n  font-style: normal;\n  font-weight: normal; }\n  :host .people-list li,\n  mgt-people-picker .people-list li {\n    cursor: pointer; }\n\n:host .people-list-separator,\nmgt-people-picker .people-list-separator {\n  margin: var(--separator-margin, 0px 0px 0px 0px);\n  height: 2px;\n  background: var(--accent-color, #0078d4);\n  margin-top: 5px;\n  text-align: center; }\n\n:host .people-chosen-input,\nmgt-people-picker .people-chosen-input {\n  position: relative;\n  border: none;\n  line-height: normal;\n  outline: none;\n  font-family: Segoe UI;\n  font-style: normal;\n  font-weight: normal;\n  font-size: 14px;\n  line-height: 19px; }\n\n:host .people-chosen-list,\nmgt-people-picker .people-chosen-list {\n  display: flex;\n  flex-wrap: wrap;\n  vertical-align: middle;\n  margin: 0 0 0 0;\n  list-style-type: none;\n  padding-left: 10px;\n  font-family: Segoe UI;\n  font-style: normal;\n  font-weight: normal; }\n\n.CloseIcon,\nmgt-people-picker .CloseIcon {\n  line-height: normal;\n  font-family: 'FabricMDL2Icons';\n  padding-right: 8px;\n  padding-left: 4px;\n  margin-top: 0px;\n  cursor: pointer; }\n\n:host .SearchIcon,\nmgt-people-picker .SearchIcon {\n  font-family: 'FabricMDL2Icons';\n  color: var(--accent-color, #0078d4); }\n\n:host .people-person,\nmgt-people-picker .people-person {\n  display: flex;\n  margin: 4px 5px 0px 0;\n  align-items: center;\n  background-color: rgba(196, 196, 196, 0.24);\n  border-radius: 15px;\n  height: 24px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis; }\n\n:host .list-person,\nmgt-people-picker .list-person {\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  align-items: center;\n  padding: 12px;\n  font-family: Segoe UI;\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px; }\n  :host .list-person:hover,\n  mgt-people-picker .list-person:hover {\n    background-color: #f1f1f1dd; }\n\n:host .people-person-list-fill,\nmgt-people-picker .people-person-list-fill {\n  background-color: #f1f1f1; }\n\n:host .people-person-text,\nmgt-people-picker .people-person-text {\n  font-size: 14px;\n  font-weight: normal;\n  margin: 0;\n  padding: 0; }\n\n:host .input-search,\nmgt-people-picker .input-search {\n  margin: 7px 2px 0px 3px; }\n\n:host .input-search-start,\nmgt-people-picker .input-search-start {\n  margin: 7px 0px 0px 0px;\n  line-height: normal;\n  margin-inline-start: 0px;\n  margin-inline-end: 0px; }\n\n:host .people-picker-input,\nmgt-people-picker .people-picker-input {\n  display: flex;\n  order: 2;\n  background-color: white;\n  margin: var(--avatar-margin, 0 4px 0 0);\n  font-size: 14px;\n  line-height: 19px;\n  cursor: text; }\n\n:host .duplicate-person,\nmgt-people-picker .duplicate-person {\n  text-decoration: none;\n  border-bottom: 1px solid red; }\n\n:host .remove-person-button,\nmgt-people-picker .remove-person-button {\n  background: #767676;\n  transform: matrix(-0.71, -0.71, 0.71, -0.71, 0, 0); }\n\n:host .remove-person-button-secondary,\nmgt-people-picker .remove-person-button-secondary {\n  background: #767676;\n  transform: matrix(0.71, -0.71, 0.71, 0.71, 0, 0); }\n\n:host .person-display-name,\nmgt-people-picker .person-display-name {\n  max-width: 100px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  margin-left: 8px;\n  font-family: Segoe UI;\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  line-height: 19px;\n  text-align: center;\n  color: #000000; }\n\nmgt-person {\n  --avatar-size-s: 32px;\n  margin-left: 12px; }\n\n.chosen-person {\n  --avatar-size-s: 24px;\n  margin-left: 0px; }\n\n:host .search-error-text,\n:host .loading-text,\nmgt-people-picker .search-error-text,\nmgt-people-picker .loading-text {\n  font-family: Segoe UI;\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  line-height: 19px;\n  text-align: center;\n  color: #232222; }\n\n:host .SearchErrorIcon,\nmgt-people-picker .SearchErrorIcon {\n  display: inline-block;\n  font-family: 'FabricMDL2Icons';\n  color: #cf0000; }\n\n:host .message-parent,\nmgt-people-picker .message-parent {\n  margin-top: 30px;\n  margin-bottom: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  vertical-align: middle; }\n\n:host .highlight-search-text,\nmgt-people-picker .highlight-search-text {\n  font-weight: bold; }\n\n:host .people-person-job-title,\nmgt-people-picker .people-person-job-title {\n  flex: 100%;\n  order: 3;\n  font-weight: normal;\n  font-size: 12px;\n  text-transform: uppercase; }\n\n:host .people-person-text-area,\nmgt-people-picker .people-person-text-area {\n  margin-left: 13px;\n  flex: 1 1 0;\n  max-height: 40px; }\n\n`\n];\n//# sourceMappingURL=mgt-people-picker-css.js.map","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { customElement, html, property } from 'lit-element';\nimport { repeat } from 'lit-html/directives/repeat';\nimport { Providers } from '../../Providers';\nimport { ProviderState } from '../../providers/IProvider';\nimport '../../styles/fabric-icon-font';\nimport { debounce } from '../../utils/Utils';\nimport '../mgt-person/mgt-person';\nimport { MgtTemplatedComponent } from '../templatedComponent';\nimport { styles } from './mgt-people-picker-css';\n/**\n * Web component used to search for people from the Microsoft Graph\n *\n * @export\n * @class MgtPicker\n * @extends {MgtTemplatedComponent}\n */\nlet MgtPeoplePicker = class MgtPeoplePicker extends MgtTemplatedComponent {\n    constructor() {\n        super();\n        /**\n         * containing object of MgtPersonDetails.\n         * @type {MgtPersonDetails}\n         */\n        this.people = null;\n        /**\n         * determining how many people to show in list.\n         * @type {number}\n         */\n        this.showMax = 6;\n        /**\n         *  array of user picked people.\n         * @type {Array<any>}\n         */\n        this.selectedPeople = [];\n        // User input in search\n        this._userInput = '';\n        // tracking of user arrow key input for selection\n        this.arrowSelectionCount = 0;\n        // if search is still loading don't load \"people not found\" state\n        this.isLoading = false;\n    }\n    /**\n     * Array of styles to apply to the element. The styles should be defined\n     * user the `css` tag function.\n     */\n    static get styles() {\n        return styles;\n    }\n    /**\n     * Synchronizes property values when attributes change.\n     *\n     * @param {*} name\n     * @param {*} oldValue\n     * @param {*} newValue\n     * @memberof MgtPersonCard\n     */\n    attributeChangedCallback(att, oldval, newval) {\n        super.attributeChangedCallback(att, oldval, newval);\n        if (att === 'group-id' && oldval !== newval) {\n            this.findGroup();\n        }\n    }\n    /**\n     * Invoked when the element is first updated. Implement to perform one time work on the element after update.\n     * Checks if group-id is present\n     * @memberof MgtPeoplePicker\n     */\n    firstUpdated() {\n        if (this.groupId) {\n            Providers.onProviderUpdated(() => this.findGroup());\n            this.findGroup();\n        }\n    }\n    /**\n     * Invoked on each update to perform rendering tasks. This method must return a lit-html TemplateResult.\n     * Setting properties inside this method will not trigger the element to update.\n     * @returns\n     * @memberof MgtPeoplePicker\n     */\n    render() {\n        return (this.renderTemplate('default', { people: this.people }) ||\n            html `\n        <div class=\"people-picker\" @blur=${this.lostFocus}>\n          <div class=\"people-picker-input\" @click=${this.gainedFocus}>\n            ${this.renderChosenPeople()}\n          </div>\n          <div class=\"people-list-separator\"></div>\n          ${this.renderPeopleList()}\n        </div>\n      `);\n    }\n    /**\n     * Focuses the input element when focus is called\n     *\n     * @param {FocusOptions} [options]\n     * @memberof MgtPeoplePicker\n     */\n    focus(options) {\n        const peopleInput = this.renderRoot.querySelector('.people-chosen-input');\n        if (peopleInput) {\n            peopleInput.focus(options);\n        }\n    }\n    /**\n     * Queries the microsoft graph for a user based on the user id and adds them to the selectedPeople array\n     *\n     * @param {[string]} an array of user ids to add to selectedPeople\n     * @returns {Promise<void>}\n     * @memberof MgtPeoplePicker\n     */\n    selectUsersById(userIds) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const provider = Providers.globalProvider;\n            const client = Providers.globalProvider.graph;\n            if (provider && provider.state === ProviderState.SignedIn) {\n                // tslint:disable-next-line: forin\n                for (const id in userIds) {\n                    try {\n                        const personDetails = yield client.getUser(userIds[id]);\n                        this.addPerson(personDetails);\n                        // tslint:disable-next-line: no-empty\n                    }\n                    catch (e) { }\n                }\n            }\n        });\n    }\n    /**\n     * Adds debounce method for set delay on user input\n     */\n    onUserKeyUp(event) {\n        if (event.keyCode === 40 || event.keyCode === 38) {\n            // keyCodes capture: down arrow (40) and up arrow (38)\n            return;\n        }\n        const input = event.target;\n        if (event.code === 'Escape') {\n            input.value = '';\n            this._userInput = '';\n            this.people = [];\n            return;\n        }\n        if (event.code === 'Backspace' && this._userInput.length === 0 && this.selectedPeople.length > 0) {\n            input.value = '';\n            this._userInput = '';\n            // remove last person in selected list\n            this.selectedPeople = this.selectedPeople.splice(0, this.selectedPeople.length - 1);\n            // fire selected people changed event\n            this.fireCustomEvent('selectionChanged', this.selectedPeople);\n            return;\n        }\n        this.handleUserSearch(input);\n    }\n    /**\n     * Async query to Graph for members of group if determined by developer.\n     * set's `this.groupPeople` to those members.\n     */\n    findGroup() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const provider = Providers.globalProvider;\n            if (provider && provider.state === ProviderState.SignedIn) {\n                const client = Providers.globalProvider.graph;\n                this.groupPeople = yield client.getPeopleFromGroup(this.groupId);\n            }\n        });\n    }\n    /**\n     * Tracks event on user input in search\n     * @param input - input text\n     */\n    handleUserSearch(input) {\n        if (!this.debouncedSearch) {\n            this.debouncedSearch = debounce(() => {\n                if (this._userInput !== input.value) {\n                    this._userInput = input.value;\n                    this.loadPersonSearch(this._userInput);\n                    this.arrowSelectionCount = 0;\n                }\n            }, 200);\n        }\n        this.debouncedSearch();\n    }\n    /**\n     * Tracks event on user search (keydown)\n     * @param event - event tracked on user input (keydown)\n     */\n    onUserKeyDown(event) {\n        if (event.keyCode === 40 || event.keyCode === 38) {\n            // keyCodes capture: down arrow (40) and up arrow (38)\n            this.handleArrowSelection(event);\n            if (this._userInput.length > 0) {\n                event.preventDefault();\n            }\n        }\n        if (event.code === 'Tab' || event.code === 'Enter') {\n            if (this.people.length) {\n                event.preventDefault();\n            }\n            this.addPerson(this.people[this.arrowSelectionCount]);\n            event.target.value = '';\n        }\n    }\n    /**\n     * Tracks user key selection for arrow key selection of people\n     * @param event - tracks user key selection\n     */\n    handleArrowSelection(event) {\n        if (this.people.length) {\n            // update arrow count\n            if (event.keyCode === 38) {\n                // up arrow\n                if (this.arrowSelectionCount > 0) {\n                    this.arrowSelectionCount--;\n                }\n                else {\n                    this.arrowSelectionCount = 0;\n                }\n            }\n            if (event.keyCode === 40) {\n                // down arrow\n                if (this.arrowSelectionCount + 1 !== this.people.length && this.arrowSelectionCount + 1 < this.showMax) {\n                    this.arrowSelectionCount++;\n                }\n                else {\n                    this.arrowSelectionCount = 0;\n                }\n            }\n            const peopleList = this.renderRoot.querySelector('.people-list');\n            // reset background color\n            // tslint:disable-next-line: prefer-for-of\n            for (let i = 0; i < peopleList.children.length; i++) {\n                peopleList.children[i].setAttribute('class', 'list-person people-person-list');\n            }\n            // set selected background\n            peopleList.children[this.arrowSelectionCount].setAttribute('class', 'list-person people-person-list-fill');\n        }\n    }\n    /**\n     * Tracks when user selects person from picker\n     * @param person - contains details pertaining to selected user\n     * @param event - tracks user event\n     */\n    addPerson(person) {\n        if (person) {\n            this._userInput = '';\n            const duplicatePeople = this.selectedPeople.filter(p => {\n                return p.id === person.id;\n            });\n            if (duplicatePeople.length === 0) {\n                this.selectedPeople.push(person);\n                this.fireCustomEvent('selectionChanged', this.selectedPeople);\n                this.people = [];\n            }\n        }\n        this.gainedFocus();\n    }\n    /**\n     * Async method which query's the Graph with user input\n     * @param name - user input or name of person searched\n     */\n    loadPersonSearch(name) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (name.length) {\n                name = name.toLowerCase();\n                const provider = Providers.globalProvider;\n                let people;\n                if (provider && provider.state === ProviderState.SignedIn) {\n                    const that = this;\n                    let loading = true;\n                    setTimeout(() => {\n                        if (loading) {\n                            that.isLoading = true;\n                        }\n                    }, 400);\n                    const client = Providers.globalProvider.graph;\n                    // filtering groups\n                    if (this.groupId) {\n                        people = this.groupPeople;\n                    }\n                    else {\n                        people = yield client.findPerson(name);\n                    }\n                    if (people) {\n                        people = people.filter(person => {\n                            return person.displayName.toLowerCase().indexOf(name) !== -1;\n                        });\n                    }\n                    this.people = this.filterPeople(people);\n                    loading = false;\n                    this.isLoading = false;\n                }\n            }\n            else {\n                this.people = [];\n            }\n        });\n    }\n    /**\n     * Filters people searched from already selected people\n     * @param people - array of people returned from query to Graph\n     */\n    filterPeople(people) {\n        // check if people need to be updated\n        // ensuring people list is displayed\n        // find ids from selected people\n        if (people) {\n            const idFilter = this.selectedPeople.map(el => {\n                return el.id;\n            });\n            // filter id's\n            const filtered = people.filter(person => {\n                return idFilter.indexOf(person.id) === -1;\n            });\n            return filtered;\n        }\n    }\n    /**\n     * Removes person from selected people\n     * @param person - person and details pertaining to user selected\n     */\n    removePerson(person) {\n        const chosenPerson = person;\n        const filteredPersonArr = this.selectedPeople.filter(p => {\n            return p.id !== chosenPerson.id;\n        });\n        this.selectedPeople = filteredPersonArr;\n        this.fireCustomEvent('selectionChanged', this.selectedPeople);\n    }\n    renderErrorMessage() {\n        return html `\n      <div class=\"message-parent\">\n        <div label=\"search-error-text\" aria-label=\"We didn't find any matches.\" class=\"search-error-text\">\n          We didn't find any matches.\n        </div>\n      </div>\n    `;\n    }\n    renderLoadingMessage() {\n        return html `\n      <div class=\"message-parent\">\n        <div label=\"search-error-text\" aria-label=\"loading\" class=\"loading-text\">\n          ......\n        </div>\n      </div>\n    `;\n    }\n    renderChosenPeople() {\n        let peopleList;\n        let inputClass = 'input-search-start';\n        if (this.selectedPeople.length > 0) {\n            inputClass = 'input-search';\n            peopleList = html `\n        ${this.selectedPeople.slice(0, this.selectedPeople.length).map(person => html `\n              <li class=\"people-person\">\n                ${this.renderTemplate('person', { person }, person.displayName) || this.renderChosenPerson(person)}\n                <div class=\"CloseIcon\" @click=\"${() => this.removePerson(person)}\">\\uE711</div>\n              </li>\n            `)}\n      `;\n        }\n        else {\n            peopleList = null;\n        }\n        // tslint:disable\n        return html `\n      <div class=\"people-chosen-list\">\n        ${peopleList}\n        <div class=\"${inputClass}\">\n          <input\n            id=\"people-picker-input\"\n            class=\"people-chosen-input\"\n            type=\"text\"\n            placeholder=\"Start typing a name\"\n            label=\"people-picker-input\"\n            aria-label=\"people-picker-input\"\n            role=\"input\"\n            .value=\"${this._userInput}\"\n            @keydown=\"${this.onUserKeyDown}\"\n            @keyup=\"${this.onUserKeyUp}\"\n          />\n        </div>\n      </div>\n    `;\n    }\n    // tslint:enable\n    gainedFocus() {\n        const peopleList = this.renderRoot.querySelector('.people-list');\n        const peopleInput = this.renderRoot.querySelector('.people-chosen-input');\n        peopleInput.focus();\n        peopleInput.select();\n        if (peopleList) {\n            // Mouse is focused on input\n            peopleList.setAttribute('style', 'display:block');\n        }\n    }\n    lostFocus() {\n        const peopleList = this.renderRoot.querySelector('.people-list');\n        if (peopleList) {\n            peopleList.setAttribute('style', 'display:none');\n        }\n    }\n    renderHighlightText(person) {\n        const peoples = person;\n        const highlightLocation = peoples.displayName.toLowerCase().indexOf(this._userInput.toLowerCase());\n        if (highlightLocation !== -1) {\n            // no location\n            if (highlightLocation === 0) {\n                // highlight is at the beginning of sentence\n                peoples.first = '';\n                peoples.highlight = peoples.displayName.slice(0, this._userInput.length);\n                peoples.last = peoples.displayName.slice(this._userInput.length, peoples.displayName.length);\n            }\n            else if (highlightLocation === peoples.displayName.length) {\n                // highlight is at end of the sentence\n                peoples.first = peoples.displayName.slice(0, highlightLocation);\n                peoples.highlight = peoples.displayName.slice(highlightLocation, peoples.displayName.length);\n                peoples.last = '';\n            }\n            else {\n                // highlight is in middle of sentence\n                peoples.first = peoples.displayName.slice(0, highlightLocation);\n                peoples.highlight = peoples.displayName.slice(highlightLocation, highlightLocation + this._userInput.length);\n                peoples.last = peoples.displayName.slice(highlightLocation + this._userInput.length, peoples.displayName.length);\n            }\n        }\n        return html `\n      <div>\n        <span class=\"people-person-text\">${peoples.first}</span\n        ><span class=\"people-person-text highlight-search-text\">${peoples.highlight}</span\n        ><span class=\"people-person-text\">${peoples.last}</span>\n      </div>\n    `;\n    }\n    renderPeopleList() {\n        let people = this.people;\n        let content;\n        if (people) {\n            people = people.slice(0, this.showMax);\n            if (this.isLoading) {\n                content = this.renderTemplate('loading', null, 'loading') || this.renderLoadingMessage();\n            }\n            else if (people.length === 0 && this._userInput.length > 0) {\n                content = this.renderTemplate('error', null, 'error') || this.renderErrorMessage();\n            }\n            else {\n                if (people[0]) {\n                    people[0].isSelected = 'fill';\n                }\n                content = this.renderPeople(people);\n            }\n        }\n        return html `\n      <div class=\"people-list\">\n        ${content}\n      </div>\n    `;\n    }\n    renderPeople(people) {\n        return html `\n      ${repeat(people, person => person.id, person => html `\n          <li\n            class=\"list-person ${person.isSelected === 'fill' ? 'people-person-list-fill' : 'people-person-list'}\"\n            @click=\"${() => this.addPerson(person)}\"\n          >\n            ${this.renderTemplate('person', { person }, person.displayName) || this.renderPerson(person)}\n            <div class=\"people-person-text-area\" id=\"${person.displayName}\">\n              ${this.renderHighlightText(person)}\n              <span class=\"people-person-job-title\">${person.jobTitle}</span>\n            </div>\n          </li>\n        `)}\n    `;\n    }\n    renderPerson(person) {\n        return html `\n      <mgt-person .personDetails=${person} .personImage=${'@'}></mgt-person>\n    `;\n    }\n    renderChosenPerson(person) {\n        return html `\n      <mgt-person class=\"chosen-person\" .personDetails=${person} .personImage=${'@'} show-name></mgt-person>\n    `;\n    }\n};\n__decorate([\n    property({\n        attribute: 'people',\n        type: Object\n    })\n], MgtPeoplePicker.prototype, \"people\", void 0);\n__decorate([\n    property({\n        attribute: 'show-max',\n        type: Number\n    })\n], MgtPeoplePicker.prototype, \"showMax\", void 0);\n__decorate([\n    property({\n        attribute: 'group-id',\n        type: String\n    })\n], MgtPeoplePicker.prototype, \"groupId\", void 0);\n__decorate([\n    property({\n        attribute: 'selected-people',\n        type: Array\n    })\n], MgtPeoplePicker.prototype, \"selectedPeople\", void 0);\n__decorate([\n    property()\n], MgtPeoplePicker.prototype, \"_userInput\", void 0);\nMgtPeoplePicker = __decorate([\n    customElement('mgt-people-picker')\n], MgtPeoplePicker);\nexport { MgtPeoplePicker };\n//# sourceMappingURL=mgt-people-picker.js.map","import { html } from 'lit-element';\nimport { withKnobs, withWebComponentsKnobs } from '@open-wc/demoing-storybook';\nimport '../../dist/es6/components/mgt-people-picker/mgt-people-picker';\nimport '../../dist/es6/mock/mgt-mock-provider';\nimport '../../dist/es6/mock/MockProvider';\n\nexport default {\n  title: 'Mock Provider|mgt-people-picker',\n  component: 'mgt-people-picker',\n  decorators: [withKnobs, withWebComponentsKnobs]\n};\n\nexport const peoplePicker = () => html`\n  <mgt-mock-provider></mgt-mock-provider>\n  <mgt-people-picker></mgt-people-picker>\n`;\n"],"names":["styles","css","MgtPeoplePicker","MgtTemplatedComponent","[object Object]","people","showMax","selectedPeople","_userInput","arrowSelectionCount","isLoading","att","oldval","newval","attributeChangedCallback","findGroup","this","groupId","Providers","onProviderUpdated","renderTemplate","html","lostFocus","gainedFocus","renderChosenPeople","renderPeopleList","options","peopleInput","renderRoot","querySelector","focus","userIds","provider","globalProvider","client","graph","state","ProviderState","SignedIn","id","personDetails","getUser","addPerson","e","event","keyCode","input","target","code","value","length","splice","fireCustomEvent","handleUserSearch","groupPeople","getPeopleFromGroup","debouncedSearch","debounce","loadPersonSearch","handleArrowSelection","preventDefault","peopleList","i","children","setAttribute","person","filter","p","push","name","toLowerCase","that","loading","setTimeout","findPerson","displayName","indexOf","filterPeople","idFilter","map","el","chosenPerson","filteredPersonArr","inputClass","slice","renderChosenPerson","removePerson","onUserKeyDown","onUserKeyUp","select","peoples","highlightLocation","first","highlight","last","content","renderLoadingMessage","renderErrorMessage","isSelected","renderPeople","repeat","renderPerson","renderHighlightText","jobTitle","__decorate","property","attribute","type","Object","Number","String","Array","customElement","peoplePicker","title","component","decorators","withKnobs","withWebComponentsKnobs"],"mappings":"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"}